// Copyright 2021 The go-ethereum Authors
// This file is part of the go-ethereum library.
//
// The go-ethereum library is free software: you can redistribute it and/or modify
// it under the terms of the GNU Lesser General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// The go-ethereum library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public License
// along with the go-ethereum library. If not, see <http://www.gnu.org/licenses/>.

package types_test

import (
	"bytes"
	"fmt"
	"io"
	"math/big"
	mrand "math/rand"
	"testing"

	"github.com/theQRL/go-zond/common"
	"github.com/theQRL/go-zond/common/hexutil"
	"github.com/theQRL/go-zond/core/rawdb"
	"github.com/theQRL/go-zond/core/types"
	"github.com/theQRL/go-zond/crypto/pqcrypto"
	"github.com/theQRL/go-zond/rlp"
	"github.com/theQRL/go-zond/trie"
)

func TestDeriveSha(t *testing.T) {
	txs, err := genTxs(0)
	if err != nil {
		t.Fatal(err)
	}
	for len(txs) < 1000 {
		exp := types.DeriveSha(txs, trie.NewEmpty(trie.NewDatabase(rawdb.NewMemoryDatabase(), nil)))
		got := types.DeriveSha(txs, trie.NewStackTrie(nil))
		if !bytes.Equal(got[:], exp[:]) {
			t.Fatalf("%d txs: got %x exp %x", len(txs), got, exp)
		}
		newTxs, err := genTxs(uint64(len(txs) + 1))
		if err != nil {
			t.Fatal(err)
		}
		txs = append(txs, newTxs...)
	}
}

// TestEIP2718DeriveSha tests that the input to the DeriveSha function is correct.
func TestEIP2718DeriveSha(t *testing.T) {
	for _, tc := range []struct {
		rlpData string
		exp     string
	}{
		{
			rlpData: "b91c6202f91c5e010380018261a894b94f5374fce5edbc8e2a8697c15331677e6ebf0b0a825544c0b90a20962dc72d8449a00302579c50fe776c0120c06db08748b6d32f3d3510ec8046f0c6e64ebd1294b89576c8fa2f239ba8d3d1f1cb4d2b47ee27ceff56cedaa2ab9182f600839430a5ad99023fbba0fe976d4a3ffd1cfcc399433acdc74f78aa63691e5592ad5661c79a51d7a4d26c22868e80bd12b5412bc864480d64935a0e70d9600ec97d6fd65a2fdfa8f6110f43aaabf91fe3ace8a42a9cf87cbdcf05f4a525b066e113a5ec66e90c568b1e3fdad5a2a414b666d852de50a63d455cb16898bfbbef3b2911123919ae8e7b68c9bdc8ffcf9f1b2c61e9ae33984a57ed474f45dcbd53b3cec983ab0647a77158d0bc46ba377255cb086311aed42e0efb3b25d97564fac84092657782c36072c00bc8113c2c6c7d4a1091f020f889a1d6973002071ef81f753158836132ac0d91fdddf2446b671768088dea64c3b78b427cdd657fb74eeab808fc7791e73b3b358d00d71258f7a080a768796be59bcd78d1ed508640ab2b8bb90f006dd011655be43646747401152e939ef380eed20d0b42dede819eaf9b6775039247cacd033979886da0e0ed0a3d59f0b9d8d12b4df231adcaebfad3ee167119fda491c733718de36c4ed86f308ec424e6618881d374bd9c54cffb6766e878cf6799ce0f8c9adcff4abdd13f9bc52570e2c9c1e024fe07a41dd3cf50f3aa2f16c69f7b8451e57cd238f470bee1a4028f9b99ea57988b352699c7a33cade5cdda5018cdd1ea79f2f437370019869e572f2d967d2202ca657a171740b802412a1500c3445f835715592e97699a5faede87108455a0248b6443b307da4bd08eebbe86fbcbb0865278289880acf5ba80997466df5c1af1ce94f11244ac674cbeaf976e94f5669ed76ad19ca981a37f0fa99674c95940fa4153067de1877056575eef20dcd295aad61a5c3e4e19e931489f44670e2d14d35cffb2785fc1a508b751977f8db389954dd9b5e22e007b39fae6b14c2088c3056b577f725cad5d564a732afa077616d0029be12a1e07ccf891cc5157af8c76badb1fc0754737ac8e5f3ac046ceb982b94c778da0ae8113b0be51815a3eb5871baf8a82083410e94a94be576a79c2e085f2806875b01a11b40ccf4ae3ac13ed110daa8b79508b553d02466d62963482e3a4d4967f16b8eb8bdb243f30b89012544518e94120323ef28449feeac0c790a997a6de2eddbc1a2eac41d6c4c5b7a739492a5db66bedae664cae347bbacb9954beeefb134b39985c8db28a11121d7183ba7c97a446b9666b33a5609260b76fea7a0fd99fed8653117d641672b2f4ec01e02d471591788d44e37d86344c9596a3c5fa6b127b167b786c3fcb5cc535c0dc4320ba87315cab1e5f2a7d95a7387dbc5cf1375661fcbe1f557f32b5ff605d2fc26af73f8339485a706c7cc892ae12d259fbe4a137f93ef8fa48f218acf22634185ff4a42b2ac437514c9ca392ae6577f79e5c319a366b63097b0d4502ac72aa1d8ccd2f4f425b33dd502f946dab10a21d4910d893e35c3acf4035232f3b0c25b0dd495be0cb7bd582c987b913dbbdff4dd9f437f929bf40558c1dc03972e59835b08e99b529abb7bd6a62428b208338f931eb0b79ff228c19101fdf70960c3b3f2c61480cb384f2fa1c1ff0457d466b6561bdef5f95a903c7a062de24c22b67e2f8fd0ad66b16ad96e292a0f077ce192f1173cbd659839d4b4302da02fc1d464062ae59ddfe60699a3598fb6c781e3a41d39dba54334bc7ade5bf120beeb44945b8128a3d2b52701403658d6176b38d6946815f314297181ef7084516a37c053e0e093ba9f01f3bc92d05add7c2c0355ab3fbd00b8ac03aa23c3699441f607396ab8c410c12201baeb98f37174ae634e2140fb5a7461c3b11cc85d8b2c77aa5b4dc68aca96a752d0040ec53071925292c245af1b39a945c9b094b09bf9f90b2cff41c8c8f01137fe926fdf5cae4b3262b306c8171413814cc08f1af64286b10152b64a1dcf64d0907945e7c3199d75ecb4d3aa51969fcc895aaca441a48bbb5fda395da70fb22183d0acb7a2e59ee93b44d9287b09bbe0f6eb790c4cda4aa1d9f2559787fbf3406018148cc76d4c3e4a72f57fe2d0cbf9e93662c4a2772556334be6df2dab3265246d000f0817c7b41b12c7942fb4983e473f9a3a5716db381a793b5f16d7a52b83d3813a9e9d919f9c48ba0bc3f83daf97e073929e3e2389e7a351df0ad895055c91432c6ffb468e2923b49f71f8e44ac78136cc2827612fcac4b27bbd599a7852830c1eb943743aed03bb192e3351dee5334873717ef0cd5c496e1bf3830ab48d398f711638d1b446d15c631ffd2659c43cb71739b875b2f5586dadbf02b5cdc163141eccaff3d3f50b0a4cc9abedaa9adb0511f97161305bfbdd90e271e98b5dbd3d260c238d9e6dccd2bf3979c85fa6567742e21c97449a6c8be0cdc9ad057970385a7b15b5a2064c2f0300b5922a81e01a8f9348eba206f07d0d555c3685036e34c3db0e089a730d1facf67e75d0242f1bb08d1335051dfb72e89bf25b01da39387565096e7396f02076ca05708884d31c2bf8710e99badf20eacca17c2b5810dda81913c4942e134eb76dd536674ae2ba10eb0f68f8661a80ab25ecb0e3753a6085991df27e8939ff8a06e32dd488afc0a35ddc41192e439bfd96d5f0223c0ba0fadaf9df8704e2f2439b97233b9f5d9a064bbb747931a30ad8cc0a8a81d4715e6f26ea3ac493278ea0c68b9b1d38c016ef4767e3c0cfbca56c0e2c4b9d5c431c33411673a56cc558f7a51663e65b62cb8e0d4898226a9741cd653a700c6f4a6cbdfbc1cfd64dc6563737e7ba0e15f7452e77bf5ae4c4677a312c14a2123ad23355952a3446dd5dc168d39abc65190915d5fd05f3a02aeb8f9ce3a6b410dac95602482f0d45dc67bf57c45d43fd852c2bb6c063f893028023283cf93b1740f3dc3b2b099ebd6394f173e287fc3ca9799897c8a5ba69e8c49136bc9dcfb3a935e8e9133d577aa54d0864917c1a7dc8d8e94af78992997844843be38f202eec55888dcd0469bce8bc11760d607d650b596cca3d477e1bd27151924bf35b80c9753e4ca3ad03d7f90a2ac6af8f922a564744944363274a8980823ba5243f6c7dd414f65a3d4ce435ea3ebb7841f3e68a86c4133490dc9875bee1bb5f83da1fc464240757736e76fc09b7ec0e64d6136167ef3bc3a1a97aa1346e567d572594ab6a854b8f4f5ad00be46a397f155027aac69c7613057a7c0321c9a5bd6acf58396ea90701c66cf315be9ee76f25f5457c6c79b3529348d2492860247076e0f3f57ded9dbce99da46820457b11ecb26f61b460af42014f1da007ec079e619008ffe8715547532f4044b7d6778c9f243475dcc4088aa613e24d79f77eb0fcd8687825a1bd471b445d77cbbd4037384a5e58c711c3faf504e9b863343eb13de3816d788abc31086c941a1d9e1df479d8d2d171e37d1c717b916c00215de6c3df7a19459d8d21d28c0dc6972321055cf3dc8691fb8ef18681979c9e01b9d3acca666b189f31d8693444af7556769d64c2acd91a41c29392a1d69516f0495a884d96262a0f7247ee3e8f90cb1f19872357f62dc92eeca6ea50c641911e06897a8f3329b0702e79beaa3fe558348cb160b74e712cf795c11841256ca70b01913b91213827a943f27af01d7569ee785fe451717f3970f4658add27093b2bc018463acdd3851359de45c774a9cf38de15531003a07a42b2b36ec62a47d0c051e7cf7d7b74ce5915b8eac1dddcac5fc89efe812a0c9938569d78f309ded9a3191c72b390b6e12a8dda177caecd4a2134aa186ef65c96c40c64d135a004f6c341be91378ca1297c7f91e2ed090d17bac8a9cd051881d3159aeb2c88e8db35a084a7121cdb7a7fa21e16666e6270b8a3d87b4184c8f425d793fdfbd2b24fa97f59fdfed599af056fc46f2dd32b969d3d5228958a0226c57fbacc0b3ce0dadabde64f4f4fa59cd1ba6f1051b092d192e4d7cb4d2bdaeb6da9d21aa299d98e28d24f6606fd88bb7534dec668397ee2c442782640b991fde98ba64d28cc00403dda486b00582dcb7432bc8a26429608c55849b3b5b87a5bd3f4b1ab494e0167af94a4e96b65bf4817165a098847dc4c97665450b64b337948df6f9a25cf3d42b9221e2c90f6847b781ba1fbcd68873f0436b326c631687cd0341965857f981564e4beb1ae33ed654d21bd8695f0c50d7b1968b4fb0d3f22e6e12b33efe0c604aac43ab91984c7c6273c07de959d92ca591bb400f4eb0aee283b372ec9d9b0f609307298282afde6d22181bc8f2e0dfe97d3fe77643bba855db164c2d29092bb237d2aec3c7e5e2ef80c9dc91f78e97aff73faf2ac07abb8a458c18bd88326085305e0db6f52e2402f6939a7c94494831523a39a2ae440b5c1f86622c6096553f18bc28487403bb2543ddab1162682e7dada99cc6decdbe49f1806be60b2cfdd3b533ec93b2c9d5fd9dd28a882e1f8b5451688cdc503a4dc536c2c7aa8025e60ebe4782a60a2865fc504c6019310472c4f811cafc29777e3d14dd1d83f40098244b270170c5fde69d8b17261c625b581c729522ed3d3def66bbc696190886825bb46a6a8a6c0c034ca43d2b5de02fb88ab48275d97151574cc1cf6003ed2bf72ffe4db0d00f63c6ed7d50794c9f5729e86afa94430adea9460be639f56126a8a3fcabe7e7c2d56127f52f1811dbbb6776e2a27b699dec0dc219e9fcec447cec0dda1dd738d6845c0911deed8119ad85d84cf231d8dba227a44af69998a9f7f7a2924ac60d9d04b15686fe6c3ebd18af46b57512844c5129b6ccf425f3b1c27a6dda65e286b4026d3ea9bd1f5e68da149472eecbc7e95004193aa2d2c247995d73132d9979ce48fd5112f534bef84ef8d4160ead493885b84257b9e32f2fc635ab3fc1b99902748b47f0b7307491bf4ba049f0eb18be4c6c99933b149d06d37066fbe0fda6ef0161759011ebf6f62f1e8f5cdaad8481249faba100217b9d514865583da975b4e229b7a5464bb40ce11b6ce4af332e63f4559e3ddaf558138cf0181eb20acd72817ae57d3e99ffb25e3e82c0b165cbce79aa6f191236ab52b1d9878885bd32a560625e560de16c124503fbb28f699983f670d4cf45de87b26ea5e091702fe1ec2c5686a211d1187ce8bd8e8ce3eb808d8921267c9e0517fc4e24caf63a49863dd8f63799ba213cfa212b080f9d3272373e8719a68a36d13a7946c9698f095d8206ecc84345dcbcce64da78fb129c7a2168bd868368fb0c73f86ed96646a0c09d28bf47590f2b1c24498981a92ffe1d4962b590bd87031023f5f36a451e8c6bfd297b7f3484f8a3b4320e81b9bab844788bf7ff4060b0bffb50fce676665eff65a35fb162ba040f4aae75514e399d0424c45f81160fee943d9081a9c4e9bb54d4f52ef383b8c0718df5adb2da2467b294f88ee7c26af7474ce32e1c2ea23dc3bc3cd017bc70c28a398e1f27eada44a8cf7c5cefcbe6cffeb552557bb60412feaf5e06888fb3c11eab23fdddb956a853df20ee31c4db20c5ed8abab599cd6c96c7be6a870f898e6f362f7b58f6b08b597cb0d0910f8257482ddc3c8ce70783242cbcee7fa9f5511079db8d9fd4255a1f90ed4caf7a087d2ad608474bd27bb005b3ab276a4f4f111ff66b1e31a32e3dbe2870b3c3c4949762b31d74aeffb5bd7ed7353ff71bbb8fac36141d782b8b9156f40710d3ff55d038a457121a1dd14255b0932c9c2c02c7176c346e4ce1c16eb55261495b4617dc41023cc4c274b547d84094adbc0f6773be4d6ee741d8c334bc4ac95dc864a8d23d9c4aa867597bc16c195803b4803bcbfde85e0145d6a415fcc700113c6f88d71b32bd84a34e6a5860a9d7437785f5c8bf37fbbf044ebb4627e8ca300939c31a5d4b92c451da189ae14e87942969a11d0587999683660a1285511a1af90d97925a6d54c7aad26097abb0987534e711e1bb82140d7f0a031003c2b3eecaf547791a64316445b323ac79a6456b6874c573dfb07cad358a69cf3979910354a6ac9fce0546737406376901db021c078c83406741f9ba7c4111f72f006dc295a74cfa27c691ef533cca2c5b62a318b0938301d7f31db91cadd952091c6a3488c59eef4b693d895b3cfa3406d803f676afe69887ee1b5bcc4a99f8cc64ee43a896a2095c7caebf71fe88725c52f6ff40e7b43799903a29d7788ace056d8033f7336af0f63535c5d5bd1e1967f1786b9ba0ec195d3d71ae86c9d2a6e5e26e73d5a33b8a5adac7f68ef444673d6f738b11913666b369ae1899fe2fb9631e631400f496520309a1a6e1ca207d9239874ef97c4f888a4867c9dce179e6c6c172e3094f93cb3e9b4d3d4b344372333425927661b3c4968ec2ee9c9036b3de34ca2b544a8751c719ab41a3fa1f17104cc3a578cc16b73a13c209924129f2733ff5e4ee988180ad4f7d577f74783a4c982dceb3e3a82f8b0266df80c21689267ce582858e79517d94a7dc90d83c3f36204186cd1bf2720d15751ddfd8b7cea3c4251143e8123607776d5192b04e9106eb3ca6f15420ab8b8667e12191fbb737bcf8ba699364e692bd83964dd7fdc6f48cd7b30f99030cda1c2085feec23d9ac1266a305653ea880c3ae256eb0570f3fb648dad19797c497b435b0c3314ef0c2bd09ab61bf791e1c92a8fbfa76f56e73ac8a7f006d0f2b4587723ab3577007a74fd6ef724d020f6d20dca976078ad4056c98aeb1c8ac322c12e5eda4ad79d1e1003cda09cfb2ff6e3d6b371f91d170bb5778d6feb7da3a884f34ad765fef941f1471d34840c966feb9540b0dcb194c1288870630124add6d5946b43da5cd7332fefbed1dca1b35b0702a03c095aa3777a1c9a2ca580b8fe3b55c3b1a5949ae04d16807f3aaf47efef521078e0e183857e52bf43ce620a90d8a53df4f85523fd8395b34adb4234caa7bff06a509cdee62cd9bff2e78b228f05bdd83411dc0192e55cd2e8613bdcb3ee68542ba73b1565d66cf2fab87bcbf9ad26c9d01ab9ecb876041204035a0d426a34247af2059386bd4bea6117fbc75f771a9a90980ac0f83a4bb1841f9fa9dd96cd9c34ff4ddce4f5170d1b2b186abf911b65649d61486c44842321beb0a2befd01b94287f69b62c06aca016a5859a0995dd452d11b179ab62fbc618e058a3fb1db785f7db83294c882b7ed343054294a3a25da8ff4370f4c3e1d6eb76fa97830daa5d94221022859171b4a05c6b42d13e0321b9282216e02eb5b4ab60e7972994072b65dc2b4f656be6199eec345445b8f3e60e35eebf7a7f3b31e02e28bb816740fed5e7a87455a1b04ff62cc99cea9f0970886a1f13aff2ed82a4f867b60aec7229b25d7207221b0e9e5285ff5a36f96cdbc02abc6d92dfa3350cd1816feec30bc48eb7b85b558ac3a6ec94c3ba206ef6eb9bec5e3fd8228fb2ac6399cadfa6afd7bf9693056ee20d3c456083f8713260742c3fdfe43cd2fead5f9a7f8a8dd0700442407bc63b2265d1744582ad863bd4d7daf09777c6fc179ff51195409ec3f93186fc2e6a24b9c6ddd5f0de70d53682d9de5ebf2d7e592c6a4d93f56ac2ba4911c9fa9045d47b013f1603111a0df8f77e4ec68b47ea2adf0cf065a8de985f88f17d580f7e1eb7629c16446a4b16a96e7da44828167a3cef9bd7f5c35a7de0eb1f4654075ce893763c35f400fd8434adcc6250c999b691fd95165e474f1062ce2469d230ce3a5433971039ec3c3bfc58b3a5f538cc1ab7cdda24fc9ecf6127b56d819a05df226c72ec265fa0588bda6b7ebf15f91eaab0d51fa6173856ce08712bcf8fcb19bcc1187d3aeacd187816f644a0d0f038bf6ea205b527ba7a4f7f6439d7469e9ceaf42e3af0551e6fb094de92b86c0192a905238e26ad8ea6bf18244de145b21187927d343f2ae6bb577f0ba2d33aa278139b3cea5e47333d8b677aaf275bd0d7547bfbf8287c0ccbf76adac71427de2bc3becd93662211228ccd229d3dc486567cfe8219d77f5f56e7138f4ebf266329b0c6a524c6c7ebfe202e102ac83cdcc92fdfb293857c15b251cc48990eb73b99e0e9ff7d80eafcfada9c3521d7a869f4fc1d9494e59cb7ded8b42565b50a449b09e97fda4e2ab6807b8c1ff7356a425156b3ddb1d48ffe92c3106713911cce2a768b2133133fef5a1c79cc4408dbf62e0c0a7895559b821da0667c33e743f9f5e87259cfc8bf3b01ee78dad0c54deef2a6df1d128e082fe4d2090680b73acdf10427261333c77c803a30ad061cf203d3e565440cee785063812a316c1168a659f12680c8dd215c4f48f3c2c47e83dbf4793411813e4fba99f891fdba5ee65a351aaaa931bccc79aad4043de29c04e1f1f5ea884bd2ed550a2db82200f29ac814bae7b25f07d33519857c9354a48306bdac38434c2c74a361e366021d7903970d7abece0d282058dc204d12309efc639fbe3cecff5cdeb55058e7ed5cbd4d6fed6e0fc131efdf0fd752a9e47b6b7f0663a6bde302e05f4ebe7189d79a5cfae6f538bf208424913b7616f863ac87d8a855c68787b170a93be289238100535ec0f806438399ffd68052c7005b3c52fdc5357fbb8179d7298dc3e724ee5b1c490c7a77ada92df27e1e64b57bf7847d5bc55b5b38cf9df5aca0575b520c1cff4c413a73976555a5f28df47894703ef8498b4fa54fb44a4f05ac0b6a84159923d37b58f4828b1901e336e859e593439a10847470dde32f790188dbff92dd4609c1b7d36faf904072f3c578c392f580b6976ff1900d26cc6e1ddac7251e045ad24da11026844734d3fcfd4855a56933053bf8d8d6e43f02290a41d417ed0ed225d33abea7d9db2c21923d4776076888586c02935669c267d0f4f82f4f3251cd2fbb0cf85114f2c598607d9825fa6c81935ac3bb9b436ec258223d4a5aa895892afeeb2222cdffe38033bc3f9d5c46a56a84db0912ecf6b9510f28f2a079d5f04c7c0c2c8c82b2cbe39c6ca6ef77eb8235151652124c15312b807df182b33583d266d978498c740224b1b0b730378a7ec0871a0d0762d13664eeea1a1e3a0ae68088355e83d406ac052fa2fb713acb2b77f57861021dc0ecd9aa80ca38d359c8dc71cea2f80032b61ff6a21ef786a98251f5bc86e2c3c2a560662e0180befee598bf65a02ed80ceaf93e5dbaeebc3d03a89a344dcb25828ea841c0bca5876ec45ff7354145b48a242a707b8cec5b93276a0809b748ce4fc4997fd8e4df4cc792899c17f5224052da43f31301dfb89e7b0c43035d2b5e755597e27f0f8bfd598694f918f63262616f0d26dc5a34ca5aa61ffd2f2701765089192672f03c053bb930642dea5a392cbe1e6e9f06991f0dee5b1c2491105ff73d1387ec40126df128d451e7c3d1765e05c3693ace6d9d4223a38f93a22cd0702243376fe47d71cc5c971b9a3fe09e225ba50f5c15be08265d83af679f315ba5e192a7cf7579dd96fcbddcc4e0089af25d36b5543b78e363c71bb233ecd6e7cc00e75c55392df1998e9d7f1cedbe82dc502ce9350358a25c55f07dfa42b035624cb50c48222737634574e294c3aed98c41ea4d44cb24610bf6af73acf82674f6d53a620ffdffe81fbb1420b43dd3be50852f5fd86be60748de0aeee7c1619d6f2276c87ce33c21947eb2d5ced87cb1eeb2375a40f1de49e64d0cf4d9ab1d47481127d8ac0c5f9c79e55747b2dd9e72dbf9684a65b0f11b7fdbec8702b76c939509e8a25006e1e70ebb712d8e5a72f80bbd7281eef8777f66ddd10175cf0ebd51591479107d6d7d8ab0a3990a025a9b4107e18a753f6942a8a43ab57ed8b0948c296dea1f1e953ed52cf5eb95a42c45ef36e38cc8e9788f75c4da9fe5031c324a05185e8ae53b81c7f088fcd195aa11578a6bb571d21a0ebe1af22baf1fad34eddf9ccf975533049107868cb205e47366c53d268b27489d7113aaa377644a36bb7e72fbb4e64c0fba9be943bbfd3ee4932eeb84e3dbc9912a3e11d820a6b8c313d97bd85f589e18bc6efabc6410431896c5171095e1d3b9fbd099af8481dbd31827229681d99502ffafdb76678dfe7367202849befdd77c83cb17833764bc861a04012a407282aebfe2edf6040f2a3483c0cf1f2931506b6c7a7c99e0fe1b2b373c3e626e8690bb000611293f4e647dbaed595d94d503636c99c0fd0f435a7e9ba4abc4cbd6e7f000000000000a111c2630343a4683010000",
			exp:     "01 02f91c5e010380018261a894b94f5374fce5edbc8e2a8697c15331677e6ebf0b0a825544c0b90a20962dc72d8449a00302579c50fe776c0120c06db08748b6d32f3d3510ec8046f0c6e64ebd1294b89576c8fa2f239ba8d3d1f1cb4d2b47ee27ceff56cedaa2ab9182f600839430a5ad99023fbba0fe976d4a3ffd1cfcc399433acdc74f78aa63691e5592ad5661c79a51d7a4d26c22868e80bd12b5412bc864480d64935a0e70d9600ec97d6fd65a2fdfa8f6110f43aaabf91fe3ace8a42a9cf87cbdcf05f4a525b066e113a5ec66e90c568b1e3fdad5a2a414b666d852de50a63d455cb16898bfbbef3b2911123919ae8e7b68c9bdc8ffcf9f1b2c61e9ae33984a57ed474f45dcbd53b3cec983ab0647a77158d0bc46ba377255cb086311aed42e0efb3b25d97564fac84092657782c36072c00bc8113c2c6c7d4a1091f020f889a1d6973002071ef81f753158836132ac0d91fdddf2446b671768088dea64c3b78b427cdd657fb74eeab808fc7791e73b3b358d00d71258f7a080a768796be59bcd78d1ed508640ab2b8bb90f006dd011655be43646747401152e939ef380eed20d0b42dede819eaf9b6775039247cacd033979886da0e0ed0a3d59f0b9d8d12b4df231adcaebfad3ee167119fda491c733718de36c4ed86f308ec424e6618881d374bd9c54cffb6766e878cf6799ce0f8c9adcff4abdd13f9bc52570e2c9c1e024fe07a41dd3cf50f3aa2f16c69f7b8451e57cd238f470bee1a4028f9b99ea57988b352699c7a33cade5cdda5018cdd1ea79f2f437370019869e572f2d967d2202ca657a171740b802412a1500c3445f835715592e97699a5faede87108455a0248b6443b307da4bd08eebbe86fbcbb0865278289880acf5ba80997466df5c1af1ce94f11244ac674cbeaf976e94f5669ed76ad19ca981a37f0fa99674c95940fa4153067de1877056575eef20dcd295aad61a5c3e4e19e931489f44670e2d14d35cffb2785fc1a508b751977f8db389954dd9b5e22e007b39fae6b14c2088c3056b577f725cad5d564a732afa077616d0029be12a1e07ccf891cc5157af8c76badb1fc0754737ac8e5f3ac046ceb982b94c778da0ae8113b0be51815a3eb5871baf8a82083410e94a94be576a79c2e085f2806875b01a11b40ccf4ae3ac13ed110daa8b79508b553d02466d62963482e3a4d4967f16b8eb8bdb243f30b89012544518e94120323ef28449feeac0c790a997a6de2eddbc1a2eac41d6c4c5b7a739492a5db66bedae664cae347bbacb9954beeefb134b39985c8db28a11121d7183ba7c97a446b9666b33a5609260b76fea7a0fd99fed8653117d641672b2f4ec01e02d471591788d44e37d86344c9596a3c5fa6b127b167b786c3fcb5cc535c0dc4320ba87315cab1e5f2a7d95a7387dbc5cf1375661fcbe1f557f32b5ff605d2fc26af73f8339485a706c7cc892ae12d259fbe4a137f93ef8fa48f218acf22634185ff4a42b2ac437514c9ca392ae6577f79e5c319a366b63097b0d4502ac72aa1d8ccd2f4f425b33dd502f946dab10a21d4910d893e35c3acf4035232f3b0c25b0dd495be0cb7bd582c987b913dbbdff4dd9f437f929bf40558c1dc03972e59835b08e99b529abb7bd6a62428b208338f931eb0b79ff228c19101fdf70960c3b3f2c61480cb384f2fa1c1ff0457d466b6561bdef5f95a903c7a062de24c22b67e2f8fd0ad66b16ad96e292a0f077ce192f1173cbd659839d4b4302da02fc1d464062ae59ddfe60699a3598fb6c781e3a41d39dba54334bc7ade5bf120beeb44945b8128a3d2b52701403658d6176b38d6946815f314297181ef7084516a37c053e0e093ba9f01f3bc92d05add7c2c0355ab3fbd00b8ac03aa23c3699441f607396ab8c410c12201baeb98f37174ae634e2140fb5a7461c3b11cc85d8b2c77aa5b4dc68aca96a752d0040ec53071925292c245af1b39a945c9b094b09bf9f90b2cff41c8c8f01137fe926fdf5cae4b3262b306c8171413814cc08f1af64286b10152b64a1dcf64d0907945e7c3199d75ecb4d3aa51969fcc895aaca441a48bbb5fda395da70fb22183d0acb7a2e59ee93b44d9287b09bbe0f6eb790c4cda4aa1d9f2559787fbf3406018148cc76d4c3e4a72f57fe2d0cbf9e93662c4a2772556334be6df2dab3265246d000f0817c7b41b12c7942fb4983e473f9a3a5716db381a793b5f16d7a52b83d3813a9e9d919f9c48ba0bc3f83daf97e073929e3e2389e7a351df0ad895055c91432c6ffb468e2923b49f71f8e44ac78136cc2827612fcac4b27bbd599a7852830c1eb943743aed03bb192e3351dee5334873717ef0cd5c496e1bf3830ab48d398f711638d1b446d15c631ffd2659c43cb71739b875b2f5586dadbf02b5cdc163141eccaff3d3f50b0a4cc9abedaa9adb0511f97161305bfbdd90e271e98b5dbd3d260c238d9e6dccd2bf3979c85fa6567742e21c97449a6c8be0cdc9ad057970385a7b15b5a2064c2f0300b5922a81e01a8f9348eba206f07d0d555c3685036e34c3db0e089a730d1facf67e75d0242f1bb08d1335051dfb72e89bf25b01da39387565096e7396f02076ca05708884d31c2bf8710e99badf20eacca17c2b5810dda81913c4942e134eb76dd536674ae2ba10eb0f68f8661a80ab25ecb0e3753a6085991df27e8939ff8a06e32dd488afc0a35ddc41192e439bfd96d5f0223c0ba0fadaf9df8704e2f2439b97233b9f5d9a064bbb747931a30ad8cc0a8a81d4715e6f26ea3ac493278ea0c68b9b1d38c016ef4767e3c0cfbca56c0e2c4b9d5c431c33411673a56cc558f7a51663e65b62cb8e0d4898226a9741cd653a700c6f4a6cbdfbc1cfd64dc6563737e7ba0e15f7452e77bf5ae4c4677a312c14a2123ad23355952a3446dd5dc168d39abc65190915d5fd05f3a02aeb8f9ce3a6b410dac95602482f0d45dc67bf57c45d43fd852c2bb6c063f893028023283cf93b1740f3dc3b2b099ebd6394f173e287fc3ca9799897c8a5ba69e8c49136bc9dcfb3a935e8e9133d577aa54d0864917c1a7dc8d8e94af78992997844843be38f202eec55888dcd0469bce8bc11760d607d650b596cca3d477e1bd27151924bf35b80c9753e4ca3ad03d7f90a2ac6af8f922a564744944363274a8980823ba5243f6c7dd414f65a3d4ce435ea3ebb7841f3e68a86c4133490dc9875bee1bb5f83da1fc464240757736e76fc09b7ec0e64d6136167ef3bc3a1a97aa1346e567d572594ab6a854b8f4f5ad00be46a397f155027aac69c7613057a7c0321c9a5bd6acf58396ea90701c66cf315be9ee76f25f5457c6c79b3529348d2492860247076e0f3f57ded9dbce99da46820457b11ecb26f61b460af42014f1da007ec079e619008ffe8715547532f4044b7d6778c9f243475dcc4088aa613e24d79f77eb0fcd8687825a1bd471b445d77cbbd4037384a5e58c711c3faf504e9b863343eb13de3816d788abc31086c941a1d9e1df479d8d2d171e37d1c717b916c00215de6c3df7a19459d8d21d28c0dc6972321055cf3dc8691fb8ef18681979c9e01b9d3acca666b189f31d8693444af7556769d64c2acd91a41c29392a1d69516f0495a884d96262a0f7247ee3e8f90cb1f19872357f62dc92eeca6ea50c641911e06897a8f3329b0702e79beaa3fe558348cb160b74e712cf795c11841256ca70b01913b91213827a943f27af01d7569ee785fe451717f3970f4658add27093b2bc018463acdd3851359de45c774a9cf38de15531003a07a42b2b36ec62a47d0c051e7cf7d7b74ce5915b8eac1dddcac5fc89efe812a0c9938569d78f309ded9a3191c72b390b6e12a8dda177caecd4a2134aa186ef65c96c40c64d135a004f6c341be91378ca1297c7f91e2ed090d17bac8a9cd051881d3159aeb2c88e8db35a084a7121cdb7a7fa21e16666e6270b8a3d87b4184c8f425d793fdfbd2b24fa97f59fdfed599af056fc46f2dd32b969d3d5228958a0226c57fbacc0b3ce0dadabde64f4f4fa59cd1ba6f1051b092d192e4d7cb4d2bdaeb6da9d21aa299d98e28d24f6606fd88bb7534dec668397ee2c442782640b991fde98ba64d28cc00403dda486b00582dcb7432bc8a26429608c55849b3b5b87a5bd3f4b1ab494e0167af94a4e96b65bf4817165a098847dc4c97665450b64b337948df6f9a25cf3d42b9221e2c90f6847b781ba1fbcd68873f0436b326c631687cd0341965857f981564e4beb1ae33ed654d21bd8695f0c50d7b1968b4fb0d3f22e6e12b33efe0c604aac43ab91984c7c6273c07de959d92ca591bb400f4eb0aee283b372ec9d9b0f609307298282afde6d22181bc8f2e0dfe97d3fe77643bba855db164c2d29092bb237d2aec3c7e5e2ef80c9dc91f78e97aff73faf2ac07abb8a458c18bd88326085305e0db6f52e2402f6939a7c94494831523a39a2ae440b5c1f86622c6096553f18bc28487403bb2543ddab1162682e7dada99cc6decdbe49f1806be60b2cfdd3b533ec93b2c9d5fd9dd28a882e1f8b5451688cdc503a4dc536c2c7aa8025e60ebe4782a60a2865fc504c6019310472c4f811cafc29777e3d14dd1d83f40098244b270170c5fde69d8b17261c625b581c729522ed3d3def66bbc696190886825bb46a6a8a6c0c034ca43d2b5de02fb88ab48275d97151574cc1cf6003ed2bf72ffe4db0d00f63c6ed7d50794c9f5729e86afa94430adea9460be639f56126a8a3fcabe7e7c2d56127f52f1811dbbb6776e2a27b699dec0dc219e9fcec447cec0dda1dd738d6845c0911deed8119ad85d84cf231d8dba227a44af69998a9f7f7a2924ac60d9d04b15686fe6c3ebd18af46b57512844c5129b6ccf425f3b1c27a6dda65e286b4026d3ea9bd1f5e68da149472eecbc7e95004193aa2d2c247995d73132d9979ce48fd5112f534bef84ef8d4160ead493885b84257b9e32f2fc635ab3fc1b99902748b47f0b7307491bf4ba049f0eb18be4c6c99933b149d06d37066fbe0fda6ef0161759011ebf6f62f1e8f5cdaad8481249faba100217b9d514865583da975b4e229b7a5464bb40ce11b6ce4af332e63f4559e3ddaf558138cf0181eb20acd72817ae57d3e99ffb25e3e82c0b165cbce79aa6f191236ab52b1d9878885bd32a560625e560de16c124503fbb28f699983f670d4cf45de87b26ea5e091702fe1ec2c5686a211d1187ce8bd8e8ce3eb808d8921267c9e0517fc4e24caf63a49863dd8f63799ba213cfa212b080f9d3272373e8719a68a36d13a7946c9698f095d8206ecc84345dcbcce64da78fb129c7a2168bd868368fb0c73f86ed96646a0c09d28bf47590f2b1c24498981a92ffe1d4962b590bd87031023f5f36a451e8c6bfd297b7f3484f8a3b4320e81b9bab844788bf7ff4060b0bffb50fce676665eff65a35fb162ba040f4aae75514e399d0424c45f81160fee943d9081a9c4e9bb54d4f52ef383b8c0718df5adb2da2467b294f88ee7c26af7474ce32e1c2ea23dc3bc3cd017bc70c28a398e1f27eada44a8cf7c5cefcbe6cffeb552557bb60412feaf5e06888fb3c11eab23fdddb956a853df20ee31c4db20c5ed8abab599cd6c96c7be6a870f898e6f362f7b58f6b08b597cb0d0910f8257482ddc3c8ce70783242cbcee7fa9f5511079db8d9fd4255a1f90ed4caf7a087d2ad608474bd27bb005b3ab276a4f4f111ff66b1e31a32e3dbe2870b3c3c4949762b31d74aeffb5bd7ed7353ff71bbb8fac36141d782b8b9156f40710d3ff55d038a457121a1dd14255b0932c9c2c02c7176c346e4ce1c16eb55261495b4617dc41023cc4c274b547d84094adbc0f6773be4d6ee741d8c334bc4ac95dc864a8d23d9c4aa867597bc16c195803b4803bcbfde85e0145d6a415fcc700113c6f88d71b32bd84a34e6a5860a9d7437785f5c8bf37fbbf044ebb4627e8ca300939c31a5d4b92c451da189ae14e87942969a11d0587999683660a1285511a1af90d97925a6d54c7aad26097abb0987534e711e1bb82140d7f0a031003c2b3eecaf547791a64316445b323ac79a6456b6874c573dfb07cad358a69cf3979910354a6ac9fce0546737406376901db021c078c83406741f9ba7c4111f72f006dc295a74cfa27c691ef533cca2c5b62a318b0938301d7f31db91cadd952091c6a3488c59eef4b693d895b3cfa3406d803f676afe69887ee1b5bcc4a99f8cc64ee43a896a2095c7caebf71fe88725c52f6ff40e7b43799903a29d7788ace056d8033f7336af0f63535c5d5bd1e1967f1786b9ba0ec195d3d71ae86c9d2a6e5e26e73d5a33b8a5adac7f68ef444673d6f738b11913666b369ae1899fe2fb9631e631400f496520309a1a6e1ca207d9239874ef97c4f888a4867c9dce179e6c6c172e3094f93cb3e9b4d3d4b344372333425927661b3c4968ec2ee9c9036b3de34ca2b544a8751c719ab41a3fa1f17104cc3a578cc16b73a13c209924129f2733ff5e4ee988180ad4f7d577f74783a4c982dceb3e3a82f8b0266df80c21689267ce582858e79517d94a7dc90d83c3f36204186cd1bf2720d15751ddfd8b7cea3c4251143e8123607776d5192b04e9106eb3ca6f15420ab8b8667e12191fbb737bcf8ba699364e692bd83964dd7fdc6f48cd7b30f99030cda1c2085feec23d9ac1266a305653ea880c3ae256eb0570f3fb648dad19797c497b435b0c3314ef0c2bd09ab61bf791e1c92a8fbfa76f56e73ac8a7f006d0f2b4587723ab3577007a74fd6ef724d020f6d20dca976078ad4056c98aeb1c8ac322c12e5eda4ad79d1e1003cda09cfb2ff6e3d6b371f91d170bb5778d6feb7da3a884f34ad765fef941f1471d34840c966feb9540b0dcb194c1288870630124add6d5946b43da5cd7332fefbed1dca1b35b0702a03c095aa3777a1c9a2ca580b8fe3b55c3b1a5949ae04d16807f3aaf47efef521078e0e183857e52bf43ce620a90d8a53df4f85523fd8395b34adb4234caa7bff06a509cdee62cd9bff2e78b228f05bdd83411dc0192e55cd2e8613bdcb3ee68542ba73b1565d66cf2fab87bcbf9ad26c9d01ab9ecb876041204035a0d426a34247af2059386bd4bea6117fbc75f771a9a90980ac0f83a4bb1841f9fa9dd96cd9c34ff4ddce4f5170d1b2b186abf911b65649d61486c44842321beb0a2befd01b94287f69b62c06aca016a5859a0995dd452d11b179ab62fbc618e058a3fb1db785f7db83294c882b7ed343054294a3a25da8ff4370f4c3e1d6eb76fa97830daa5d94221022859171b4a05c6b42d13e0321b9282216e02eb5b4ab60e7972994072b65dc2b4f656be6199eec345445b8f3e60e35eebf7a7f3b31e02e28bb816740fed5e7a87455a1b04ff62cc99cea9f0970886a1f13aff2ed82a4f867b60aec7229b25d7207221b0e9e5285ff5a36f96cdbc02abc6d92dfa3350cd1816feec30bc48eb7b85b558ac3a6ec94c3ba206ef6eb9bec5e3fd8228fb2ac6399cadfa6afd7bf9693056ee20d3c456083f8713260742c3fdfe43cd2fead5f9a7f8a8dd0700442407bc63b2265d1744582ad863bd4d7daf09777c6fc179ff51195409ec3f93186fc2e6a24b9c6ddd5f0de70d53682d9de5ebf2d7e592c6a4d93f56ac2ba4911c9fa9045d47b013f1603111a0df8f77e4ec68b47ea2adf0cf065a8de985f88f17d580f7e1eb7629c16446a4b16a96e7da44828167a3cef9bd7f5c35a7de0eb1f4654075ce893763c35f400fd8434adcc6250c999b691fd95165e474f1062ce2469d230ce3a5433971039ec3c3bfc58b3a5f538cc1ab7cdda24fc9ecf6127b56d819a05df226c72ec265fa0588bda6b7ebf15f91eaab0d51fa6173856ce08712bcf8fcb19bcc1187d3aeacd187816f644a0d0f038bf6ea205b527ba7a4f7f6439d7469e9ceaf42e3af0551e6fb094de92b86c0192a905238e26ad8ea6bf18244de145b21187927d343f2ae6bb577f0ba2d33aa278139b3cea5e47333d8b677aaf275bd0d7547bfbf8287c0ccbf76adac71427de2bc3becd93662211228ccd229d3dc486567cfe8219d77f5f56e7138f4ebf266329b0c6a524c6c7ebfe202e102ac83cdcc92fdfb293857c15b251cc48990eb73b99e0e9ff7d80eafcfada9c3521d7a869f4fc1d9494e59cb7ded8b42565b50a449b09e97fda4e2ab6807b8c1ff7356a425156b3ddb1d48ffe92c3106713911cce2a768b2133133fef5a1c79cc4408dbf62e0c0a7895559b821da0667c33e743f9f5e87259cfc8bf3b01ee78dad0c54deef2a6df1d128e082fe4d2090680b73acdf10427261333c77c803a30ad061cf203d3e565440cee785063812a316c1168a659f12680c8dd215c4f48f3c2c47e83dbf4793411813e4fba99f891fdba5ee65a351aaaa931bccc79aad4043de29c04e1f1f5ea884bd2ed550a2db82200f29ac814bae7b25f07d33519857c9354a48306bdac38434c2c74a361e366021d7903970d7abece0d282058dc204d12309efc639fbe3cecff5cdeb55058e7ed5cbd4d6fed6e0fc131efdf0fd752a9e47b6b7f0663a6bde302e05f4ebe7189d79a5cfae6f538bf208424913b7616f863ac87d8a855c68787b170a93be289238100535ec0f806438399ffd68052c7005b3c52fdc5357fbb8179d7298dc3e724ee5b1c490c7a77ada92df27e1e64b57bf7847d5bc55b5b38cf9df5aca0575b520c1cff4c413a73976555a5f28df47894703ef8498b4fa54fb44a4f05ac0b6a84159923d37b58f4828b1901e336e859e593439a10847470dde32f790188dbff92dd4609c1b7d36faf904072f3c578c392f580b6976ff1900d26cc6e1ddac7251e045ad24da11026844734d3fcfd4855a56933053bf8d8d6e43f02290a41d417ed0ed225d33abea7d9db2c21923d4776076888586c02935669c267d0f4f82f4f3251cd2fbb0cf85114f2c598607d9825fa6c81935ac3bb9b436ec258223d4a5aa895892afeeb2222cdffe38033bc3f9d5c46a56a84db0912ecf6b9510f28f2a079d5f04c7c0c2c8c82b2cbe39c6ca6ef77eb8235151652124c15312b807df182b33583d266d978498c740224b1b0b730378a7ec0871a0d0762d13664eeea1a1e3a0ae68088355e83d406ac052fa2fb713acb2b77f57861021dc0ecd9aa80ca38d359c8dc71cea2f80032b61ff6a21ef786a98251f5bc86e2c3c2a560662e0180befee598bf65a02ed80ceaf93e5dbaeebc3d03a89a344dcb25828ea841c0bca5876ec45ff7354145b48a242a707b8cec5b93276a0809b748ce4fc4997fd8e4df4cc792899c17f5224052da43f31301dfb89e7b0c43035d2b5e755597e27f0f8bfd598694f918f63262616f0d26dc5a34ca5aa61ffd2f2701765089192672f03c053bb930642dea5a392cbe1e6e9f06991f0dee5b1c2491105ff73d1387ec40126df128d451e7c3d1765e05c3693ace6d9d4223a38f93a22cd0702243376fe47d71cc5c971b9a3fe09e225ba50f5c15be08265d83af679f315ba5e192a7cf7579dd96fcbddcc4e0089af25d36b5543b78e363c71bb233ecd6e7cc00e75c55392df1998e9d7f1cedbe82dc502ce9350358a25c55f07dfa42b035624cb50c48222737634574e294c3aed98c41ea4d44cb24610bf6af73acf82674f6d53a620ffdffe81fbb1420b43dd3be50852f5fd86be60748de0aeee7c1619d6f2276c87ce33c21947eb2d5ced87cb1eeb2375a40f1de49e64d0cf4d9ab1d47481127d8ac0c5f9c79e55747b2dd9e72dbf9684a65b0f11b7fdbec8702b76c939509e8a25006e1e70ebb712d8e5a72f80bbd7281eef8777f66ddd10175cf0ebd51591479107d6d7d8ab0a3990a025a9b4107e18a753f6942a8a43ab57ed8b0948c296dea1f1e953ed52cf5eb95a42c45ef36e38cc8e9788f75c4da9fe5031c324a05185e8ae53b81c7f088fcd195aa11578a6bb571d21a0ebe1af22baf1fad34eddf9ccf975533049107868cb205e47366c53d268b27489d7113aaa377644a36bb7e72fbb4e64c0fba9be943bbfd3ee4932eeb84e3dbc9912a3e11d820a6b8c313d97bd85f589e18bc6efabc6410431896c5171095e1d3b9fbd099af8481dbd31827229681d99502ffafdb76678dfe7367202849befdd77c83cb17833764bc861a04012a407282aebfe2edf6040f2a3483c0cf1f2931506b6c7a7c99e0fe1b2b373c3e626e8690bb000611293f4e647dbaed595d94d503636c99c0fd0f435a7e9ba4abc4cbd6e7f000000000000a111c2630343a4683010000\n80 02f91c5e010380018261a894b94f5374fce5edbc8e2a8697c15331677e6ebf0b0a825544c0b90a20962dc72d8449a00302579c50fe776c0120c06db08748b6d32f3d3510ec8046f0c6e64ebd1294b89576c8fa2f239ba8d3d1f1cb4d2b47ee27ceff56cedaa2ab9182f600839430a5ad99023fbba0fe976d4a3ffd1cfcc399433acdc74f78aa63691e5592ad5661c79a51d7a4d26c22868e80bd12b5412bc864480d64935a0e70d9600ec97d6fd65a2fdfa8f6110f43aaabf91fe3ace8a42a9cf87cbdcf05f4a525b066e113a5ec66e90c568b1e3fdad5a2a414b666d852de50a63d455cb16898bfbbef3b2911123919ae8e7b68c9bdc8ffcf9f1b2c61e9ae33984a57ed474f45dcbd53b3cec983ab0647a77158d0bc46ba377255cb086311aed42e0efb3b25d97564fac84092657782c36072c00bc8113c2c6c7d4a1091f020f889a1d6973002071ef81f753158836132ac0d91fdddf2446b671768088dea64c3b78b427cdd657fb74eeab808fc7791e73b3b358d00d71258f7a080a768796be59bcd78d1ed508640ab2b8bb90f006dd011655be43646747401152e939ef380eed20d0b42dede819eaf9b6775039247cacd033979886da0e0ed0a3d59f0b9d8d12b4df231adcaebfad3ee167119fda491c733718de36c4ed86f308ec424e6618881d374bd9c54cffb6766e878cf6799ce0f8c9adcff4abdd13f9bc52570e2c9c1e024fe07a41dd3cf50f3aa2f16c69f7b8451e57cd238f470bee1a4028f9b99ea57988b352699c7a33cade5cdda5018cdd1ea79f2f437370019869e572f2d967d2202ca657a171740b802412a1500c3445f835715592e97699a5faede87108455a0248b6443b307da4bd08eebbe86fbcbb0865278289880acf5ba80997466df5c1af1ce94f11244ac674cbeaf976e94f5669ed76ad19ca981a37f0fa99674c95940fa4153067de1877056575eef20dcd295aad61a5c3e4e19e931489f44670e2d14d35cffb2785fc1a508b751977f8db389954dd9b5e22e007b39fae6b14c2088c3056b577f725cad5d564a732afa077616d0029be12a1e07ccf891cc5157af8c76badb1fc0754737ac8e5f3ac046ceb982b94c778da0ae8113b0be51815a3eb5871baf8a82083410e94a94be576a79c2e085f2806875b01a11b40ccf4ae3ac13ed110daa8b79508b553d02466d62963482e3a4d4967f16b8eb8bdb243f30b89012544518e94120323ef28449feeac0c790a997a6de2eddbc1a2eac41d6c4c5b7a739492a5db66bedae664cae347bbacb9954beeefb134b39985c8db28a11121d7183ba7c97a446b9666b33a5609260b76fea7a0fd99fed8653117d641672b2f4ec01e02d471591788d44e37d86344c9596a3c5fa6b127b167b786c3fcb5cc535c0dc4320ba87315cab1e5f2a7d95a7387dbc5cf1375661fcbe1f557f32b5ff605d2fc26af73f8339485a706c7cc892ae12d259fbe4a137f93ef8fa48f218acf22634185ff4a42b2ac437514c9ca392ae6577f79e5c319a366b63097b0d4502ac72aa1d8ccd2f4f425b33dd502f946dab10a21d4910d893e35c3acf4035232f3b0c25b0dd495be0cb7bd582c987b913dbbdff4dd9f437f929bf40558c1dc03972e59835b08e99b529abb7bd6a62428b208338f931eb0b79ff228c19101fdf70960c3b3f2c61480cb384f2fa1c1ff0457d466b6561bdef5f95a903c7a062de24c22b67e2f8fd0ad66b16ad96e292a0f077ce192f1173cbd659839d4b4302da02fc1d464062ae59ddfe60699a3598fb6c781e3a41d39dba54334bc7ade5bf120beeb44945b8128a3d2b52701403658d6176b38d6946815f314297181ef7084516a37c053e0e093ba9f01f3bc92d05add7c2c0355ab3fbd00b8ac03aa23c3699441f607396ab8c410c12201baeb98f37174ae634e2140fb5a7461c3b11cc85d8b2c77aa5b4dc68aca96a752d0040ec53071925292c245af1b39a945c9b094b09bf9f90b2cff41c8c8f01137fe926fdf5cae4b3262b306c8171413814cc08f1af64286b10152b64a1dcf64d0907945e7c3199d75ecb4d3aa51969fcc895aaca441a48bbb5fda395da70fb22183d0acb7a2e59ee93b44d9287b09bbe0f6eb790c4cda4aa1d9f2559787fbf3406018148cc76d4c3e4a72f57fe2d0cbf9e93662c4a2772556334be6df2dab3265246d000f0817c7b41b12c7942fb4983e473f9a3a5716db381a793b5f16d7a52b83d3813a9e9d919f9c48ba0bc3f83daf97e073929e3e2389e7a351df0ad895055c91432c6ffb468e2923b49f71f8e44ac78136cc2827612fcac4b27bbd599a7852830c1eb943743aed03bb192e3351dee5334873717ef0cd5c496e1bf3830ab48d398f711638d1b446d15c631ffd2659c43cb71739b875b2f5586dadbf02b5cdc163141eccaff3d3f50b0a4cc9abedaa9adb0511f97161305bfbdd90e271e98b5dbd3d260c238d9e6dccd2bf3979c85fa6567742e21c97449a6c8be0cdc9ad057970385a7b15b5a2064c2f0300b5922a81e01a8f9348eba206f07d0d555c3685036e34c3db0e089a730d1facf67e75d0242f1bb08d1335051dfb72e89bf25b01da39387565096e7396f02076ca05708884d31c2bf8710e99badf20eacca17c2b5810dda81913c4942e134eb76dd536674ae2ba10eb0f68f8661a80ab25ecb0e3753a6085991df27e8939ff8a06e32dd488afc0a35ddc41192e439bfd96d5f0223c0ba0fadaf9df8704e2f2439b97233b9f5d9a064bbb747931a30ad8cc0a8a81d4715e6f26ea3ac493278ea0c68b9b1d38c016ef4767e3c0cfbca56c0e2c4b9d5c431c33411673a56cc558f7a51663e65b62cb8e0d4898226a9741cd653a700c6f4a6cbdfbc1cfd64dc6563737e7ba0e15f7452e77bf5ae4c4677a312c14a2123ad23355952a3446dd5dc168d39abc65190915d5fd05f3a02aeb8f9ce3a6b410dac95602482f0d45dc67bf57c45d43fd852c2bb6c063f893028023283cf93b1740f3dc3b2b099ebd6394f173e287fc3ca9799897c8a5ba69e8c49136bc9dcfb3a935e8e9133d577aa54d0864917c1a7dc8d8e94af78992997844843be38f202eec55888dcd0469bce8bc11760d607d650b596cca3d477e1bd27151924bf35b80c9753e4ca3ad03d7f90a2ac6af8f922a564744944363274a8980823ba5243f6c7dd414f65a3d4ce435ea3ebb7841f3e68a86c4133490dc9875bee1bb5f83da1fc464240757736e76fc09b7ec0e64d6136167ef3bc3a1a97aa1346e567d572594ab6a854b8f4f5ad00be46a397f155027aac69c7613057a7c0321c9a5bd6acf58396ea90701c66cf315be9ee76f25f5457c6c79b3529348d2492860247076e0f3f57ded9dbce99da46820457b11ecb26f61b460af42014f1da007ec079e619008ffe8715547532f4044b7d6778c9f243475dcc4088aa613e24d79f77eb0fcd8687825a1bd471b445d77cbbd4037384a5e58c711c3faf504e9b863343eb13de3816d788abc31086c941a1d9e1df479d8d2d171e37d1c717b916c00215de6c3df7a19459d8d21d28c0dc6972321055cf3dc8691fb8ef18681979c9e01b9d3acca666b189f31d8693444af7556769d64c2acd91a41c29392a1d69516f0495a884d96262a0f7247ee3e8f90cb1f19872357f62dc92eeca6ea50c641911e06897a8f3329b0702e79beaa3fe558348cb160b74e712cf795c11841256ca70b01913b91213827a943f27af01d7569ee785fe451717f3970f4658add27093b2bc018463acdd3851359de45c774a9cf38de15531003a07a42b2b36ec62a47d0c051e7cf7d7b74ce5915b8eac1dddcac5fc89efe812a0c9938569d78f309ded9a3191c72b390b6e12a8dda177caecd4a2134aa186ef65c96c40c64d135a004f6c341be91378ca1297c7f91e2ed090d17bac8a9cd051881d3159aeb2c88e8db35a084a7121cdb7a7fa21e16666e6270b8a3d87b4184c8f425d793fdfbd2b24fa97f59fdfed599af056fc46f2dd32b969d3d5228958a0226c57fbacc0b3ce0dadabde64f4f4fa59cd1ba6f1051b092d192e4d7cb4d2bdaeb6da9d21aa299d98e28d24f6606fd88bb7534dec668397ee2c442782640b991fde98ba64d28cc00403dda486b00582dcb7432bc8a26429608c55849b3b5b87a5bd3f4b1ab494e0167af94a4e96b65bf4817165a098847dc4c97665450b64b337948df6f9a25cf3d42b9221e2c90f6847b781ba1fbcd68873f0436b326c631687cd0341965857f981564e4beb1ae33ed654d21bd8695f0c50d7b1968b4fb0d3f22e6e12b33efe0c604aac43ab91984c7c6273c07de959d92ca591bb400f4eb0aee283b372ec9d9b0f609307298282afde6d22181bc8f2e0dfe97d3fe77643bba855db164c2d29092bb237d2aec3c7e5e2ef80c9dc91f78e97aff73faf2ac07abb8a458c18bd88326085305e0db6f52e2402f6939a7c94494831523a39a2ae440b5c1f86622c6096553f18bc28487403bb2543ddab1162682e7dada99cc6decdbe49f1806be60b2cfdd3b533ec93b2c9d5fd9dd28a882e1f8b5451688cdc503a4dc536c2c7aa8025e60ebe4782a60a2865fc504c6019310472c4f811cafc29777e3d14dd1d83f40098244b270170c5fde69d8b17261c625b581c729522ed3d3def66bbc696190886825bb46a6a8a6c0c034ca43d2b5de02fb88ab48275d97151574cc1cf6003ed2bf72ffe4db0d00f63c6ed7d50794c9f5729e86afa94430adea9460be639f56126a8a3fcabe7e7c2d56127f52f1811dbbb6776e2a27b699dec0dc219e9fcec447cec0dda1dd738d6845c0911deed8119ad85d84cf231d8dba227a44af69998a9f7f7a2924ac60d9d04b15686fe6c3ebd18af46b57512844c5129b6ccf425f3b1c27a6dda65e286b4026d3ea9bd1f5e68da149472eecbc7e95004193aa2d2c247995d73132d9979ce48fd5112f534bef84ef8d4160ead493885b84257b9e32f2fc635ab3fc1b99902748b47f0b7307491bf4ba049f0eb18be4c6c99933b149d06d37066fbe0fda6ef0161759011ebf6f62f1e8f5cdaad8481249faba100217b9d514865583da975b4e229b7a5464bb40ce11b6ce4af332e63f4559e3ddaf558138cf0181eb20acd72817ae57d3e99ffb25e3e82c0b165cbce79aa6f191236ab52b1d9878885bd32a560625e560de16c124503fbb28f699983f670d4cf45de87b26ea5e091702fe1ec2c5686a211d1187ce8bd8e8ce3eb808d8921267c9e0517fc4e24caf63a49863dd8f63799ba213cfa212b080f9d3272373e8719a68a36d13a7946c9698f095d8206ecc84345dcbcce64da78fb129c7a2168bd868368fb0c73f86ed96646a0c09d28bf47590f2b1c24498981a92ffe1d4962b590bd87031023f5f36a451e8c6bfd297b7f3484f8a3b4320e81b9bab844788bf7ff4060b0bffb50fce676665eff65a35fb162ba040f4aae75514e399d0424c45f81160fee943d9081a9c4e9bb54d4f52ef383b8c0718df5adb2da2467b294f88ee7c26af7474ce32e1c2ea23dc3bc3cd017bc70c28a398e1f27eada44a8cf7c5cefcbe6cffeb552557bb60412feaf5e06888fb3c11eab23fdddb956a853df20ee31c4db20c5ed8abab599cd6c96c7be6a870f898e6f362f7b58f6b08b597cb0d0910f8257482ddc3c8ce70783242cbcee7fa9f5511079db8d9fd4255a1f90ed4caf7a087d2ad608474bd27bb005b3ab276a4f4f111ff66b1e31a32e3dbe2870b3c3c4949762b31d74aeffb5bd7ed7353ff71bbb8fac36141d782b8b9156f40710d3ff55d038a457121a1dd14255b0932c9c2c02c7176c346e4ce1c16eb55261495b4617dc41023cc4c274b547d84094adbc0f6773be4d6ee741d8c334bc4ac95dc864a8d23d9c4aa867597bc16c195803b4803bcbfde85e0145d6a415fcc700113c6f88d71b32bd84a34e6a5860a9d7437785f5c8bf37fbbf044ebb4627e8ca300939c31a5d4b92c451da189ae14e87942969a11d0587999683660a1285511a1af90d97925a6d54c7aad26097abb0987534e711e1bb82140d7f0a031003c2b3eecaf547791a64316445b323ac79a6456b6874c573dfb07cad358a69cf3979910354a6ac9fce0546737406376901db021c078c83406741f9ba7c4111f72f006dc295a74cfa27c691ef533cca2c5b62a318b0938301d7f31db91cadd952091c6a3488c59eef4b693d895b3cfa3406d803f676afe69887ee1b5bcc4a99f8cc64ee43a896a2095c7caebf71fe88725c52f6ff40e7b43799903a29d7788ace056d8033f7336af0f63535c5d5bd1e1967f1786b9ba0ec195d3d71ae86c9d2a6e5e26e73d5a33b8a5adac7f68ef444673d6f738b11913666b369ae1899fe2fb9631e631400f496520309a1a6e1ca207d9239874ef97c4f888a4867c9dce179e6c6c172e3094f93cb3e9b4d3d4b344372333425927661b3c4968ec2ee9c9036b3de34ca2b544a8751c719ab41a3fa1f17104cc3a578cc16b73a13c209924129f2733ff5e4ee988180ad4f7d577f74783a4c982dceb3e3a82f8b0266df80c21689267ce582858e79517d94a7dc90d83c3f36204186cd1bf2720d15751ddfd8b7cea3c4251143e8123607776d5192b04e9106eb3ca6f15420ab8b8667e12191fbb737bcf8ba699364e692bd83964dd7fdc6f48cd7b30f99030cda1c2085feec23d9ac1266a305653ea880c3ae256eb0570f3fb648dad19797c497b435b0c3314ef0c2bd09ab61bf791e1c92a8fbfa76f56e73ac8a7f006d0f2b4587723ab3577007a74fd6ef724d020f6d20dca976078ad4056c98aeb1c8ac322c12e5eda4ad79d1e1003cda09cfb2ff6e3d6b371f91d170bb5778d6feb7da3a884f34ad765fef941f1471d34840c966feb9540b0dcb194c1288870630124add6d5946b43da5cd7332fefbed1dca1b35b0702a03c095aa3777a1c9a2ca580b8fe3b55c3b1a5949ae04d16807f3aaf47efef521078e0e183857e52bf43ce620a90d8a53df4f85523fd8395b34adb4234caa7bff06a509cdee62cd9bff2e78b228f05bdd83411dc0192e55cd2e8613bdcb3ee68542ba73b1565d66cf2fab87bcbf9ad26c9d01ab9ecb876041204035a0d426a34247af2059386bd4bea6117fbc75f771a9a90980ac0f83a4bb1841f9fa9dd96cd9c34ff4ddce4f5170d1b2b186abf911b65649d61486c44842321beb0a2befd01b94287f69b62c06aca016a5859a0995dd452d11b179ab62fbc618e058a3fb1db785f7db83294c882b7ed343054294a3a25da8ff4370f4c3e1d6eb76fa97830daa5d94221022859171b4a05c6b42d13e0321b9282216e02eb5b4ab60e7972994072b65dc2b4f656be6199eec345445b8f3e60e35eebf7a7f3b31e02e28bb816740fed5e7a87455a1b04ff62cc99cea9f0970886a1f13aff2ed82a4f867b60aec7229b25d7207221b0e9e5285ff5a36f96cdbc02abc6d92dfa3350cd1816feec30bc48eb7b85b558ac3a6ec94c3ba206ef6eb9bec5e3fd8228fb2ac6399cadfa6afd7bf9693056ee20d3c456083f8713260742c3fdfe43cd2fead5f9a7f8a8dd0700442407bc63b2265d1744582ad863bd4d7daf09777c6fc179ff51195409ec3f93186fc2e6a24b9c6ddd5f0de70d53682d9de5ebf2d7e592c6a4d93f56ac2ba4911c9fa9045d47b013f1603111a0df8f77e4ec68b47ea2adf0cf065a8de985f88f17d580f7e1eb7629c16446a4b16a96e7da44828167a3cef9bd7f5c35a7de0eb1f4654075ce893763c35f400fd8434adcc6250c999b691fd95165e474f1062ce2469d230ce3a5433971039ec3c3bfc58b3a5f538cc1ab7cdda24fc9ecf6127b56d819a05df226c72ec265fa0588bda6b7ebf15f91eaab0d51fa6173856ce08712bcf8fcb19bcc1187d3aeacd187816f644a0d0f038bf6ea205b527ba7a4f7f6439d7469e9ceaf42e3af0551e6fb094de92b86c0192a905238e26ad8ea6bf18244de145b21187927d343f2ae6bb577f0ba2d33aa278139b3cea5e47333d8b677aaf275bd0d7547bfbf8287c0ccbf76adac71427de2bc3becd93662211228ccd229d3dc486567cfe8219d77f5f56e7138f4ebf266329b0c6a524c6c7ebfe202e102ac83cdcc92fdfb293857c15b251cc48990eb73b99e0e9ff7d80eafcfada9c3521d7a869f4fc1d9494e59cb7ded8b42565b50a449b09e97fda4e2ab6807b8c1ff7356a425156b3ddb1d48ffe92c3106713911cce2a768b2133133fef5a1c79cc4408dbf62e0c0a7895559b821da0667c33e743f9f5e87259cfc8bf3b01ee78dad0c54deef2a6df1d128e082fe4d2090680b73acdf10427261333c77c803a30ad061cf203d3e565440cee785063812a316c1168a659f12680c8dd215c4f48f3c2c47e83dbf4793411813e4fba99f891fdba5ee65a351aaaa931bccc79aad4043de29c04e1f1f5ea884bd2ed550a2db82200f29ac814bae7b25f07d33519857c9354a48306bdac38434c2c74a361e366021d7903970d7abece0d282058dc204d12309efc639fbe3cecff5cdeb55058e7ed5cbd4d6fed6e0fc131efdf0fd752a9e47b6b7f0663a6bde302e05f4ebe7189d79a5cfae6f538bf208424913b7616f863ac87d8a855c68787b170a93be289238100535ec0f806438399ffd68052c7005b3c52fdc5357fbb8179d7298dc3e724ee5b1c490c7a77ada92df27e1e64b57bf7847d5bc55b5b38cf9df5aca0575b520c1cff4c413a73976555a5f28df47894703ef8498b4fa54fb44a4f05ac0b6a84159923d37b58f4828b1901e336e859e593439a10847470dde32f790188dbff92dd4609c1b7d36faf904072f3c578c392f580b6976ff1900d26cc6e1ddac7251e045ad24da11026844734d3fcfd4855a56933053bf8d8d6e43f02290a41d417ed0ed225d33abea7d9db2c21923d4776076888586c02935669c267d0f4f82f4f3251cd2fbb0cf85114f2c598607d9825fa6c81935ac3bb9b436ec258223d4a5aa895892afeeb2222cdffe38033bc3f9d5c46a56a84db0912ecf6b9510f28f2a079d5f04c7c0c2c8c82b2cbe39c6ca6ef77eb8235151652124c15312b807df182b33583d266d978498c740224b1b0b730378a7ec0871a0d0762d13664eeea1a1e3a0ae68088355e83d406ac052fa2fb713acb2b77f57861021dc0ecd9aa80ca38d359c8dc71cea2f80032b61ff6a21ef786a98251f5bc86e2c3c2a560662e0180befee598bf65a02ed80ceaf93e5dbaeebc3d03a89a344dcb25828ea841c0bca5876ec45ff7354145b48a242a707b8cec5b93276a0809b748ce4fc4997fd8e4df4cc792899c17f5224052da43f31301dfb89e7b0c43035d2b5e755597e27f0f8bfd598694f918f63262616f0d26dc5a34ca5aa61ffd2f2701765089192672f03c053bb930642dea5a392cbe1e6e9f06991f0dee5b1c2491105ff73d1387ec40126df128d451e7c3d1765e05c3693ace6d9d4223a38f93a22cd0702243376fe47d71cc5c971b9a3fe09e225ba50f5c15be08265d83af679f315ba5e192a7cf7579dd96fcbddcc4e0089af25d36b5543b78e363c71bb233ecd6e7cc00e75c55392df1998e9d7f1cedbe82dc502ce9350358a25c55f07dfa42b035624cb50c48222737634574e294c3aed98c41ea4d44cb24610bf6af73acf82674f6d53a620ffdffe81fbb1420b43dd3be50852f5fd86be60748de0aeee7c1619d6f2276c87ce33c21947eb2d5ced87cb1eeb2375a40f1de49e64d0cf4d9ab1d47481127d8ac0c5f9c79e55747b2dd9e72dbf9684a65b0f11b7fdbec8702b76c939509e8a25006e1e70ebb712d8e5a72f80bbd7281eef8777f66ddd10175cf0ebd51591479107d6d7d8ab0a3990a025a9b4107e18a753f6942a8a43ab57ed8b0948c296dea1f1e953ed52cf5eb95a42c45ef36e38cc8e9788f75c4da9fe5031c324a05185e8ae53b81c7f088fcd195aa11578a6bb571d21a0ebe1af22baf1fad34eddf9ccf975533049107868cb205e47366c53d268b27489d7113aaa377644a36bb7e72fbb4e64c0fba9be943bbfd3ee4932eeb84e3dbc9912a3e11d820a6b8c313d97bd85f589e18bc6efabc6410431896c5171095e1d3b9fbd099af8481dbd31827229681d99502ffafdb76678dfe7367202849befdd77c83cb17833764bc861a04012a407282aebfe2edf6040f2a3483c0cf1f2931506b6c7a7c99e0fe1b2b373c3e626e8690bb000611293f4e647dbaed595d94d503636c99c0fd0f435a7e9ba4abc4cbd6e7f000000000000a111c2630343a4683010000\n",
		},
	} {
		d := &hashToHumanReadable{}
		var t1, t2 types.Transaction
		rlp.DecodeBytes(common.FromHex(tc.rlpData), &t1)
		rlp.DecodeBytes(common.FromHex(tc.rlpData), &t2)
		txs := types.Transactions{&t1, &t2}
		types.DeriveSha(txs, d)
		if tc.exp != string(d.data) {
			t.Fatalf("Want\n%v\nhave:\n%v", tc.exp, string(d.data))
		}
	}
}

func BenchmarkDeriveSha200(b *testing.B) {
	txs, err := genTxs(200)
	if err != nil {
		b.Fatal(err)
	}
	var exp common.Hash
	var got common.Hash
	b.Run("std_trie", func(b *testing.B) {
		b.ResetTimer()
		b.ReportAllocs()
		for i := 0; i < b.N; i++ {
			exp = types.DeriveSha(txs, trie.NewEmpty(trie.NewDatabase(rawdb.NewMemoryDatabase(), nil)))
		}
	})

	b.Run("stack_trie", func(b *testing.B) {
		b.ResetTimer()
		b.ReportAllocs()
		for i := 0; i < b.N; i++ {
			got = types.DeriveSha(txs, trie.NewStackTrie(nil))
		}
	})
	if got != exp {
		b.Errorf("got %x exp %x", got, exp)
	}
}

func TestFuzzDeriveSha(t *testing.T) {
	// increase this for longer runs -- it's set to quite low for travis
	rndSeed := mrand.Int()
	for i := 0; i < 10; i++ {
		seed := rndSeed + i
		exp := types.DeriveSha(newDummy(i), trie.NewEmpty(trie.NewDatabase(rawdb.NewMemoryDatabase(), nil)))
		got := types.DeriveSha(newDummy(i), trie.NewStackTrie(nil))
		if !bytes.Equal(got[:], exp[:]) {
			printList(newDummy(seed))
			t.Fatalf("seed %d: got %x exp %x", seed, got, exp)
		}
	}
}

// TestDerivableList contains testcases found via fuzzing
func TestDerivableList(t *testing.T) {
	type tcase []string
	tcs := []tcase{
		{
			"0xc041",
		},
		{
			"0xf04cf757812428b0763112efb33b6f4fad7deb445e",
			"0xf04cf757812428b0763112efb33b6f4fad7deb445e",
		},
		{
			"0xca410605310cdc3bb8d4977ae4f0143df54a724ed873457e2272f39d66e0460e971d9d",
			"0x6cd850eca0a7ac46bb1748d7b9cb88aa3bd21c57d852c28198ad8fa422c4595032e88a4494b4778b36b944fe47a52b8c5cd312910139dfcb4147ab8e972cc456bcb063f25dd78f54c4d34679e03142c42c662af52947d45bdb6e555751334ace76a5080ab5a0256a1d259855dfc5c0b8023b25befbb13fd3684f9f755cbd3d63544c78ee2001452dd54633a7593ade0b183891a0a4e9c7844e1254005fbe592b1b89149a502c24b6e1dca44c158aebedf01beae9c30cabe16a",
			"0x14abd5c47c0be87b0454596baad2",
			"0xca410605310cdc3bb8d4977ae4f0143df54a724ed873457e2272f39d66e0460e971d9d",
		},
	}
	for i, tc := range tcs[1:] {
		exp := types.DeriveSha(flatList(tc), trie.NewEmpty(trie.NewDatabase(rawdb.NewMemoryDatabase(), nil)))
		got := types.DeriveSha(flatList(tc), trie.NewStackTrie(nil))
		if !bytes.Equal(got[:], exp[:]) {
			t.Fatalf("case %d: got %x exp %x", i, got, exp)
		}
	}
}

func genTxs(num uint64) (types.Transactions, error) {
	key, err := pqcrypto.HexToWallet("deadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef")
	if err != nil {
		return nil, err
	}
	var addr = common.Address(key.GetAddress())
	newTx := func(i uint64) (*types.Transaction, error) {
		signer := types.NewShanghaiSigner(big.NewInt(18))
		utx := types.NewTx(&types.DynamicFeeTx{
			Nonce:     i,
			To:        &addr,
			Value:     new(big.Int),
			Gas:       0,
			GasFeeCap: new(big.Int).SetUint64(10000000),
			Data:      nil,
		})
		tx, err := types.SignTx(utx, signer, key)
		return tx, err
	}
	var txs types.Transactions
	for i := uint64(0); i < num; i++ {
		tx, err := newTx(i)
		if err != nil {
			return nil, err
		}
		txs = append(txs, tx)
	}
	return txs, nil
}

type dummyDerivableList struct {
	len  int
	seed int
}

func newDummy(seed int) *dummyDerivableList {
	d := &dummyDerivableList{}
	src := mrand.NewSource(int64(seed))
	// don't use lists longer than 4K items
	d.len = int(src.Int63() & 0x0FFF)
	d.seed = seed
	return d
}

func (d *dummyDerivableList) Len() int {
	return d.len
}

func (d *dummyDerivableList) EncodeIndex(i int, w *bytes.Buffer) {
	src := mrand.NewSource(int64(d.seed + i))
	// max item size 256, at least 1 byte per item
	size := 1 + src.Int63()&0x00FF
	io.CopyN(w, mrand.New(src), size)
}

func printList(l types.DerivableList) {
	fmt.Printf("list length: %d\n", l.Len())
	fmt.Printf("{\n")
	for i := 0; i < l.Len(); i++ {
		var buf bytes.Buffer
		l.EncodeIndex(i, &buf)
		fmt.Printf("\"%#x\",\n", buf.Bytes())
	}
	fmt.Printf("},\n")
}

type flatList []string

func (f flatList) Len() int {
	return len(f)
}
func (f flatList) EncodeIndex(i int, w *bytes.Buffer) {
	w.Write(hexutil.MustDecode(f[i]))
}

type hashToHumanReadable struct {
	data []byte
}

func (d *hashToHumanReadable) Reset() {
	d.data = make([]byte, 0)
}

func (d *hashToHumanReadable) Update(i []byte, i2 []byte) error {
	l := fmt.Sprintf("%x %x\n", i, i2)
	d.data = append(d.data, []byte(l)...)
	return nil
}

func (d *hashToHumanReadable) Hash() common.Hash {
	return common.Hash{}
}
