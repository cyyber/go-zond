// Copyright 2023 The go-ethereum Authors
// This file is part of the go-ethereum library.
//
// The go-ethereum library is free software: you can redistribute it and/or modify
// it under the terms of the GNU Lesser General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// The go-ethereum library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public License
// along with the go-ethereum library. If not, see <http://www.gnu.org/licenses/>.

package zondapi

import (
	"context"
	"encoding/json"
	"errors"
	"fmt"
	"math/big"
	"os"
	"path/filepath"
	"reflect"
	"slices"
	"testing"
	"time"

	"github.com/stretchr/testify/require"
	"github.com/theQRL/go-qrllib/dilithium"
	"github.com/theQRL/go-zond"
	"github.com/theQRL/go-zond/accounts"
	"github.com/theQRL/go-zond/common"
	"github.com/theQRL/go-zond/common/hexutil"
	"github.com/theQRL/go-zond/consensus"
	"github.com/theQRL/go-zond/consensus/beacon"
	"github.com/theQRL/go-zond/core"
	"github.com/theQRL/go-zond/core/bloombits"
	"github.com/theQRL/go-zond/core/rawdb"
	"github.com/theQRL/go-zond/core/state"
	"github.com/theQRL/go-zond/core/types"
	"github.com/theQRL/go-zond/core/vm"
	"github.com/theQRL/go-zond/crypto"
	"github.com/theQRL/go-zond/crypto/pqcrypto"
	"github.com/theQRL/go-zond/event"
	"github.com/theQRL/go-zond/internal/blocktest"
	"github.com/theQRL/go-zond/params"
	"github.com/theQRL/go-zond/rpc"
	"github.com/theQRL/go-zond/zonddb"
)

func testTransactionMarshal(t *testing.T, tests []txData, config *params.ChainConfig) {
	t.Parallel()
	var (
		signer = types.LatestSigner(config)
		key, _ = pqcrypto.HexToDilithium("b71c71a67e1177ad4e901695e1b4b9ee17ae16c6668d313eac2f96dbcda3f291")
	)

	for i, tt := range tests {
		var tx2 types.Transaction
		tx, err := types.SignNewTx(key, signer, tt.Tx)
		if err != nil {
			t.Fatalf("test %d: signing failed: %v", i, err)
		}
		// Regular transaction
		if data, err := json.Marshal(tx); err != nil {
			t.Fatalf("test %d: marshalling failed; %v", i, err)
		} else if err = tx2.UnmarshalJSON(data); err != nil {
			t.Fatalf("test %d: sunmarshal failed: %v", i, err)
		} else if want, have := tx.Hash(), tx2.Hash(); want != have {
			t.Fatalf("test %d: stx changed, want %x have %x", i, want, have)
		}

		// rpcTransaction
		rpcTx := newRPCTransaction(tx, common.Hash{}, 0, 0, nil, config)
		if data, err := json.Marshal(rpcTx); err != nil {
			t.Fatalf("test %d: marshalling failed; %v", i, err)
		} else if err = tx2.UnmarshalJSON(data); err != nil {
			t.Fatalf("test %d: unmarshal failed: %v", i, err)
		} else if want, have := tx.Hash(), tx2.Hash(); want != have {
			t.Fatalf("test %d: tx changed, want %x have %x", i, want, have)
		} else {
			want, have := tt.Want, string(data)
			require.JSONEqf(t, want, have, "test %d: rpc json not match, want %s have %s", i, want, have)
		}
	}
}

func TestTransaction_RoundTripRpcJSON(t *testing.T) {
	var (
		config = params.AllBeaconProtocolChanges
		tests  = allTransactionTypes(common.Address{0xde, 0xad}, config)
	)
	testTransactionMarshal(t, tests, config)
}

type txData struct {
	Tx   types.TxData
	Want string
}

func allTransactionTypes(addr common.Address, config *params.ChainConfig) []txData {
	return []txData{
		// TODO(rgeraldes24): legacy txs
		/*
			{
				Tx: &types.LegacyTx{
					Nonce:    5,
					GasPrice: big.NewInt(6),
					Gas:      7,
					To:       &addr,
					Value:    big.NewInt(8),
					Data:     []byte{0, 1, 2, 3, 4},
					Signature: []byte{},
					PublicKey: []byte{},
				},
				Want: `{
					"blockHash": null,
					"blockNumber": null,
					"from": "0x20a1a68e6818a1142f85671db01ef7226debf822",
					"gas": "0x7",
					"gasPrice": "0x6",
					"hash": "0x5f3240454cd09a5d8b1c5d651eefae7a339262875bcd2d0e6676f3d989967008",
					"input": "0x0001020304",
					"nonce": "0x5",
					"to": "0xdead000000000000000000000000000000000000",
					"transactionIndex": null,
					"value": "0x8",
					"type": "0x0",
					"chainId": "0x539",
					"signature": "0xbc85e96592b95f7160825d837abb407f009df9ebe8f1b9158a4b8dd093377f75",
					"publicKey": "0x1b55ea3af5574c536967b039ba6999ef6c89cf22fc04bcb296e0e8b0b9b576f5"
				}`,
			}, {
				Tx: &types.LegacyTx{
					Nonce:    5,
					GasPrice: big.NewInt(6),
					Gas:      7,
					To:       nil,
					Value:    big.NewInt(8),
					Data:     []byte{0, 1, 2, 3, 4},
					Signature: []byte{},
					PublicKey: []byte{},
				},
				Want: `{
					"blockHash": null,
					"blockNumber": null,
					"from": "0x20a1a68e6818a1142f85671db01ef7226debf822",
					"gas": "0x7",
					"gasPrice": "0x6",
					"hash": "0x806e97f9d712b6cb7e781122001380a2837531b0fc1e5f5d78174ad4cb699873",
					"input": "0x0001020304",
					"nonce": "0x5",
					"to": null,
					"transactionIndex": null,
					"value": "0x8",
					"type": "0x0",
					"chainId": "0x539",
					"v": "0xa96",
					"r": "0x9dc28b267b6ad4e4af6fe9289668f9305c2eb7a3241567860699e478af06835a",
					"s": "0xa0b51a071aa9bed2cd70aedea859779dff039e3630ea38497d95202e9b1fec7"
				}`,
			},
		*/
		// TODO(rgeraldes24)
		/*
			{
				Tx: &types.AccessListTx{
					ChainID:  config.ChainID,
					Nonce:    5,
					GasPrice: big.NewInt(6),
					Gas:      7,
					To:       &addr,
					Value:    big.NewInt(8),
					Data:     []byte{0, 1, 2, 3, 4},
					AccessList: types.AccessList{
						types.AccessTuple{
							Address:     common.Address{0x2},
							StorageKeys: []common.Hash{types.EmptyRootHash},
						},
					},
					Signature: []byte{},
					PublicKey: []byte{},
				},
				Want: `{
						"blockHash": null,
						"blockNumber": null,
						"from": "0x20a1a68e6818a1142f85671db01ef7226debf822",
						"gas": "0x7",
						"gasPrice": "0x6",
						"hash": "0x29de99297e0b91ad1d46a641ce8b49e610c974916b5b29ea02944cbd7fecbf46",
						"input": "0x0001020304",
						"nonce": "0x5",
						"to": "0xdead000000000000000000000000000000000000",
						"transactionIndex": null,
						"value": "0x8",
						"type": "0x1",
						"accessList": [
							{
								"address": "0x0200000000000000000000000000000000000000",
								"storageKeys": [
									"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421"
								]
							}
						],
						"chainId": "0x539",
						"signature": "0xb2d230a5ce983eb1cd8cfa69970dee9994d592931909ecc0fa7968ca0ec601166dd36a5a4f7cf113efce2c49e7a703f5e8479cdeb3f807db5938b5afbe3b5e93b0840a324f610f14c2059d0e8254ef886359909034c5ddb1df73fbdcc0c7afcf86268645f139ee2d595ccd4de149769f5dad6a4b8583220e9af575a2e8dd094083c6dd3834ad75383ffa6a9c724cdf34e16b45d15ad2a7c0e4155bd06fd2178d8596a8517e39e1fe5b4634a7489d85cef44253eed97367868d181b216602c2368fd8424586a27d746f6fdbcf77d3143e0931f537dc407e7d188d5d598d3e5aafbe1e97504df8c8a84775058fa6e2996401f55da672c7885cd984ca6c43feff5d320c9bcc2e15f3545ac71f4dbc9f39ffc91d10dfc0b9aa728a96447a6b864e430fa9c7798fad335655c1a992a1b61e146f8274aa359b9df1c10866e1a3b26ff592a32fccd05a742730eb36a643c3d8bdc1046204eb79cd5a87f857ced675ecb8aa42748cd33796398697812d4e5af6975f3bf10bff180ba8ecec65744f1a7240c6f345ed31e287b989e76fc8debc842aa681758b00baad754a09439515df4d8fb910cbc2f45012628ce97b0c178e3e86298a8cb05bedbbfb5f5c52f5b60d1837232c72a0bc39a890811caadfe240b881b08ed4df2ad2b234123d27d9189eeddb2d8ac7ec14e3ad5fb3d16059572f289a072f88a79e2da121a88de6c1e26ffc4015d97a60f8bcd2e5e99870f935cb6927bd3f831a940c59e4293d4824f51178fa444be72db135a383bfc16eebeffd0731782f18bb2cce2b855519af630bc42ee1c278ae492328695ea297696071e440a0da6f032219b2fb5791c7fd72574eaddab657959512d14b383ff4f7e3b179b60d310481884ffb05668ac9a1c454911f373ac70bc998bedc870bda73bf841ac24d4f3cc719371e04bb634230be1df3dead7b8569db1d52afcddccb6f4151238cbe8eb8640b8faf6995c925b840589e781786fd02f314f0dc4d0e9b09166581155e506695a2cf16dff42debb299c7ea0564b1ba0f89188ca74c0c5dabc5ea2feff85439dacca843d7a8f21173dbd2b579cb55e3c587c12b156efb3835396e3f14f53b61a0a796017506d7690e86d89c76e511244bb30c68ee9ad40d5a57122093f879ae68bbb51c03d34d2cfef057b6704ad9360205d671c3ca1d18b151db1df481cf5c0287a4115bfdae3e616519bdfcba10d9d234a71127a08e7b67e917f6bfff03ea1354a0c5247b60ccef770107106d07dc2fd1ca33b6b41faa01cf9391684be2e23143266a3ff36f56601c3911d43eed9f8493efa6225648aa5782b9cdb1ab2e4bf2d1a94812a1d00c5836f8bc211718dd6578dee843b648c6bcbfa7a9df098b797e614fe80b007449797f40faa3f8b67dac84851036e2e75d72a68ad4d28ddb1dcfdd48992ce4b961a41b9de3b6706a79a34096cac82b9238bc7bfb5e7cb946380cb87df30c028d9907aa1551796ca7c315e042e50e38892c88091f66e0877be5df9059e7c9a49f23cffa0b9582a8ccb1d73a44c80ada20c1319b71cfd3117af3ddb64820162d4def6627ad5e527e52608d177f43c0e420bc6319207cc0231a5a7d42a1562a3b537209db5e508aceab978dada87d833edf8ac40f02ca2317949fefe2f515d49c1230f21f0545b5e0ea0bb02219f08e7bbddef5628c2c739ded2bc778ee3f80e06a667b16a4f442f96cd217c41c77d0e1070c13ca0ae22b01efbc461acb83603ec156bdf159bf5abdec4069d8d23d5e1b236a19a680d94ae978bf859fa27b71c0b4e08be7c25ee33a771388c1f56bce398f67a61e6d1f7ea8e889e88f7608e4e2b9133fac66181f5aae30668b76e5758d7b344593d51a9836430cc0657593cc6ca3f0abef18b30dfa1c4be8f77ac39c11e782c3d57157263d9d64d6dd4872c8da5d9e1179e1ca62fdef0121329426a9ef9ea29066a895ece7aa38bb1565b023ededcfce87e01200aab36e3db5509f9fdd39ea5383e2ce946cb126f6d9fe5053280bc4c685737888f13e962655ff8a03eedd04e29d67d5459b94283460a7f9efde7d6cfd13e3e45318420f4d75d0bb439d37a474217fa20d497e331010f8b44917773c86b048ede5b48397840ef29ef76f8c60e46b02e20554ff67bf1397d3a57709b3ab1b11a56f777d4c3dc4df98d185d92b89430c40fb0f4b084c3632db048c8d9da3e9e9241b5818e888b8ec0e4cf47f06888a748be1e750e0be419fe724402111d70cb0366c2f7bd7f7bd4f1074bd0caf617b37b47179ad0d890f442fd5d6342e5c5ede096ef1ad6a1b3897c40793d89538addaa75125025f6bf9e03913d9e443a7ffacd0eb1b342e56273017abe39a5008fd4903c86110e93ca0735a288681908801117a4222ae847b676653012cfe6281ebe85a905254eef738f427ed8ccb587816867316a5490356f943bcf4c2b94a731751d6215269caba2ef2ec12a9ccd15b6fa966c8e93931c32b5b42ca7b9ec0670d1f0e22ea251d185ef63157c35a26ab285c72850711c7c92457459f671f7ce7250b7fdfd15e617193aeb33d5fe0115990034df9e488ff008ad5701cc64a949db6d0a4b98aeeca0d5cb0ae09a44d93d6b13a5df8bf4f0ed9ae0139806fd87a0ebfc4aae5268fb1a80348498027cc4f179f0543c471dd682482c0dcf8b5b765a1f0ab65bac3104923a0d418016f4491dc8c2cc95a02fd8ba7c36ec2e6a1bec12014d79454184d39d1acf6b110bf446f50d42e05ee4336f2f06b5e8351df94e81b50390596fb81a9589426dd089baecd5e025e5b599d16172eab39776335acdccc232b0513f52f39eb18d962915b424b8e372488b0f080955d0eef959a525e5467c7bf85a8bcfc4ca30a8ce2d3dcaa70a6c164d097371c11e32b2a8acd733562a96f44464a3714058dcb7515b5677a343a90f1628d5b4f2f8dae4649d518093679d62f09d23c657286eeb6ba82145d76c548e2c299d44838040baec5f3232c703b9f7625d00a5412c4341908958460b457551a5c35acfe9baddb84183918c5792a531fd836af818ba9afb554c5c2053ae8c431aece302c9cffb4a6ce6f3d75ea06c5f8faa8b40a833cb2f122b6f812f84f4499d28975520d9d9bf46c613b8438ca2cac20a33b76e30cb7ef7cef78b447330dcc4aabbfe6a3ba830523b8988563a913818203e2965c5a9fe1d4bcce6e853d46ac298604030e3ce84e1217b3ff8a368f9876eee84f70ceb1a52105fe391b88d2681af528c9adfd6622410f8ef21e1d89693b316dde77303b11d9b88827267b73f11ae72ed25f9c9a04c67eb3d3c100c79e48d045a56d96e04a8aaca1fb76a5bbd3ba203fa4aa623af156ad764f8cd36b4cb08c7f256c0cf36212295de341eb4e258c54bd2bb5849748d40e4c032827df813c16dce4925f4a9fd391768b6aa69a85ccc7702656c4d8863f4d4cf43b6060cdbdcf6b5d09195a2b0bd4eb1c58ce35796dc67beb06c9ac8d4a3d3611a025429e4456ad28ad765ee6a2a6237742ce9a1d749986dd23f338e7ea2703bcaecc08c73995de9ec3334d84ef0dbedb83181a112e483b8c963f14f8a205935b52c8fb03840547dcde4e3d4c1668ee468b341c1e9608b5faca141b99f9b1513fb2baacb71137b5706d4c3c812200eb20053f9fe8944585bbe1cb4e1b884d0caad9dab284dfa62551e589387ef9fc9562f0b35960d1714c2c0544f6d97380a66627a13c48daad4dd37325ac577363357e1a1d38a139d0faba64bac2b0c5be9f04e019de3ea498f9fb513e412018fa0540e3bdd70a95d3f13a0be8babb96e107f6c2d32d533903ce3b1be3d4a796921a4ba0b87dda09e8a654c8f395add2dfb97ed4d2c5aa10672ac4c630fa9a454f1467b1c7421990a8dcc3ff9c1b70812210f443e6a3aed50d283c01ee8b17918c619ad218984c4aa9338e53da0031cb6b5b1e11942b30dc61c1515d9cda388e1445c6e346b37d87e828b4fec009bd9117d397feaf71749c7e5ab218978222db308181ae3341455fc1e19d671babce12807ecf26b0424c5738a8339a2f8fe1bc7108c2b1487778c1773140fd8a615071a099d2a3a6aeca5845bc8a97745ff3aa5b94353dc42aabfe4eaa721fed8fe6e176b73ce165e745d501a9db1c6dbf8af94113ec81bd0e54adc908d3770cfe1c22a9ea961541538b03f69892097ed0e8da5565e20efe3ec2fd0d80fb57ddd2e08cfa7a2c97fd24ce08c016ed7da5007ff33879cb861554c3813f5f11dd185146913b5957d29da3c6ee000f64d067c9f9b589bee085d83796b6036f4e9b062b6f17a1a96b535063a684fd32dd8f1c0c426414f3cd97cea65f91306da05d1b6dc6dc5d17df4c64a5fdc328e1c138c13c0e55272fd827793c9bd6de5c43fe41c9154ce510e833b8f4907519b18d7de91a728202612f00c8a8fcf1965da4e80eeff47de32fec3e73743be92b1a98dabe2d9f177c2cdd1668b108c040f99cfec98a6bca63d767e1e0743f611ab748c4d5fec2800f6bea7c5a21e7872b28282f42e3c19d94ad1f10b7d215fe827970dc8b666a9b794b59daa1831b97cd278c0bade0dd6123b6beb80dc010da2d119526ddf6d18abc6693c030ad037b9f425918d03bc5256cfc3d3bc2fde2973dcd5a9ca59f9a1b86d0665219fb0b3336e1c4d7b797892031be2859c6b496b50cee8e03f6154121b9f33fcf77007b89353e088c83a6eb68f46c6974cfdfc74acbacc10c13b4ab8d4ce4d56df58786d2d0b5988cc0cbab8fc7f8d6b4f174b1fba0a0dd0f86bf40e7883428b35192c6ff76a42b1da9258e33f714e7bdd8208e24eb1c22c1986faf537f0832a64f1d846b0271849449ccdd125fc5b25297897408ced5c46bf9d81476fbd3bd4c8ba6d1428b7ed09c18ea6e9eb3c2ac9d448ac7cd1fc48c4151a4a9d645155101caf39e7179b3ed78f10df3f7165c0d5405f76398a39c75700be6afb00920558b37601ab6d3a887973acf2e9e889f2b95ae31cbbeccf112f75a43334212abcd13cc2bd212f49a4db36a89762533982954b23ecb94f975e0ec097620c1955c9689b0f5b875179ef6a8254a2c07982a5be86291a1d466f4021313e879e73063eaa1ab9b0ffb1c595b6bb0d313c68ae7c340b70ae68f221ed72aed89e62f1a8f8c91c94d9cb535fafbb09131ae7a1090f410c6d66d24e3fcfc47e3d3078b3a76d709e792b87d6f2e855f8819007642a4d7c1a6522c9d332be3ad3a58e59960897faef6bf40d9a59ab4f38e9af440bd2c8ca5a98f419f0dbe6c91c81315c361ef087b5bec9c7a164f3b61e778adbb30dac3341d63186f34a82afe48a0986cee1f075d47fb2333d5c6030133b7fe1e4f371a1b2608e7cfc5b2c50f1a58253f47c0e978b09da77f7f18d54838f9f5eae4cd4750eee9174104cac2d7d3bcf0a739febb7755cc1ba7c8c143c52fd80258655a398b845414683566fca8523aac0c216455e4b48172b48e41863b0b292e6c4e8beb96f4ae209f95ed24da82d5a6498aa5fe1774753e198b9f834e03381c86e093ed3674f204841e1f357dab1e240e01ecbc77bc08f9e3b6a4343772f3b469b35ca3a295675fc5afb279dbb9b1e5c07cd1e2353772d01f9f8cd5ac4d84b55527b503acb294ecba9e8872d92f93096675265fd8f04885e0898b8298f548e7438f8635dd10c8ace87304a0faa9a6124d73dc2fa65392254e681a8a06b4a7628ad53160b0db13482aafa5a89c4e44a9c1d7166270f6bd74866a1a2f75b3805802907e344c777520ee278bc29e96b3acc42d322e85489fb40080c106500d81a943e0d0b348c5504c241c52e9beab6b511a2beab9a11884611470a6016852d3f7d4aa56088a7f3ce94f11ef4ae06893715955a59bfbf16147823ac01ac209d4d6d17f7d7fa6f87f565d6a4229a6a86cb3d3ae90a21142f43b65298767b9a8bd70725e2de655e161ff6338c26c147598e09b3dd04488a1306b967a0c23e2edf11f7ed5bd5b3d9f1606c5a8e274e899efec2cfe30b556b21a1b4d3b7f508ff75e39dadf720a8f510be9d2934f56d575db9800ba0fff89c21341889bf4a8ad564272fc34d88f77e0db79a534603e6751364573d3b151cdc02c820d5e03678e493931814cb8eefb84d79ecd3edc19dfe1813498ed5a196706f4227686be6257e86960541ade2e587a01d06470cff2cc48ffe71e274d110e93c5d6150d716d2e76ba3309f7ba9f2500633dadba2af9d8717a92ff1290cda6850d8a776d54a7e50c2a49158347f29c96366a3ce3029ed20018e0781a0bd4e659dc2e9e38871891117be243e6386b9de5f380cea44dba8e902dd35f59479e0616aa8f8299d3faa521f21d41639a63b34fb82b6404572a10f35640b125d3af0cee7f4f8772dc1152617a84cbcef3fa494a4e58e0f002242a3b4e505a6a7fa4ade2e451545f8198b6def3ff000c10153f56add82529377ba3a4d847595c7285bac51518959c000000000000000000000000090f1c252d343b3f",
						"publicKey": "0x01727d783cc48b50060e8d3cf86eb8f37a5fe0dd49beb6c79e77aa4243aed4acdc5bed459f9ce1aaee191558c4791a698778f22ae0b670dbc963f9dff974c5c4c7bdf86504364cd48ecbd37c990758e92abc82f9ab42eefac09b5c307064540751421eff33e436f05f59c0a43a3c1b93442fb8b75bc4ca7156310162c935c50dfea28b8f8cb3409edb3a3b8242ddc9320f97e2e9f3d50f4428d791d7969e412ba10a2b22c6229395dd86f86261104f3cf37617d370d28f484b2605828f03b017d898baf4b4631212baef96e81c017dab349d8189a70f07bfe86240d5f5a33802ca794072aef09b4171b153af2b33a8b375a113438d271cb0fe625d76e8fcca390dcbb924abf7ac9bc5e6ea6ec38cc7b4fb38ac22ded5d9280260c53f87186e8a1f44eeca54fd915015daeaa57fa3493130dbc0e3b664df05bce6cfbe8c10c1a7b7963ec5d9f6e044995050bc169b62de61e37e91eb83e0f21aa11018edd4f2587b2c907e1f99fc93a30935a9a16c828e778acb8d04e70e6a4cf248a1f23088fcde603ae156e538c1f2cc07e959f1a0d5d8771ee207284edc9e5f34785f708a9f1395cdbbd17fdfaa0792d9ffa1af4dec2907b603698bc71621df7e34c6adf001951252b97d69590d7cbf7a102734aca33b3a337ce3deec222f2b8b61c45ad189a75dd30746ec7c9700fccf361b94b23564c974bd024b89a52d3f225d0b562e4500b51e0c447caeff5eb760d781c416aabf702c079baad87fdb18c61d50cc8827e407fe088a8da4575a92e13093d24c63ff37ac70bb2a6be9631891b0dd570a7fbb73bb66d489058ac89c46db31576a38dbe2a206a31f48751b45e1bf7934fd8fc2d242273aa1261ca679a6ce693a458a5a33d47d8b7a8aa61f62060424bcf911f147206c475842c16dd801e4ac32a8223215ad3a4e59deb4df0597a612c330af5a787f05327cc5cac9e8a9d151adfb0413b5a68f124d9f1cbe753137061f5beb8ec2b9be66ea23076f2d6da6624a983f76ad92235315a3883c2a321b013586c055941514d3a6d448ff1d6cef057e4ca26b944d44086f4df7970371464c56151221cb808f0e00818cd0ffa916b78e696132ccc71a795949a39f2a5a6acff20998c085e640c901f251998d15d6cb7092dc48e69284e4836e634db47664f926697055252be841a5a79603f8a2a419650a6f1ad7c6bdb11a391bdea76f4f68be08922f5ef08bff8c0d02d5aded7907642cc6cca4fd594f0fe4700efd15827ae2f4a9c7f8f629498f1992e4cb575ed9bedb1927bd57bde751624a34c8438892ac114cbe1aac962cf4fe199d2ff2a23cb1f8c3a3e6d78a8b44b66d8f25c3702bebbfb1974698ac701d263561a32cec56574e1eb9f289fac40fa441296d79ae4f0f51c8e9a50d7acc1779b5a47a806c692a1c49e99fafb63d2149eeb175aa7ef584cbb5504211fbe6585e30ba0edbb717decc3494ee984d5f3e56089f14ce7222c6573833377881a861fd763e4fb667c9e76c860ffdee0771465f5a37aad543e3fa5f024996dba344f6a1c24b245a45adc6a18ac4dd08bb0307910724007e344ad302b534dcf7dd2ac3966bd3668486ba361ac1390155c0e1334d3a79c631f889bb26dda72449129d4441e795f2c124cde229d4daf79bc9f15c562fc0f6faa47f6b757cf4c7d0d6271c1e47f3d01ac02938eef495ca61e051617f32693a17abacf604722025f72660979716407f15d56a71b1427019b2b8897a7991f6d9bead653b537670bf4c5e7bc54b8745b533ab4bb96b588bdeb2b4f713f25477688737dde64107d82feabc00a2689f27b1b58161b6281d9edd647b8d23e9442f2123c93365f6805cf903b8a802a2de6d5622407cb9d88512fcc9ba9f18c90cfaa80e1e9f985e9849c8b91d9cdc1f862135f6583aed4f5471124408a89081c0e14789ce8f2444dee55f789387e6e48e6212fd271a1e3a55de0c1e122c8772dc32d1ca77284eb4649e86ae6e5569a4cf840166970a21d79c50a8fc9b2d1c144ee79885ffdbc22737b03a110b3522ea5c26ae99f950aec20411cd1c2466df4d90c3ffe2ed9116b6c23a63299f6d7bbcf2a37368765d170297d900ca346fa60f0e6a3fccf2a01548219982c5e49444771e64619089da4c6263df7ac2693d9037800f68607a34d7eeb489b1a93030488d7cd407f4f2ab561701d884d7eeea39f79cf2f25c4da089f34ea3f3dc15da1bc43da8e7c12d1e0c05b107f10da1ea5a684331f2ecb696734b47407dc51a15ab9c9b98f31a42cb2e771696ab39378bbcfec21021bc42ffb1488920229589505bb6fc771edddb1818a081a5b8fc90eefba70091ea3fed3fe81f95f721570662eed03cfd759fb064e2401e634072557f025cce8affff8c062381b5e0291fb016292b5403848b419037d9bb6190045eb19454c2ea2debec95eb9d7f76f9546c922f96d1a04c537594ef5d26b226821a3527cebd56ac950c54e7fa0557e017e9a5974ae7defbe1fb3ba3037f89d12ea7f85253ef885af0da7b1e60a8637d1197b795a9d663723b94f1806b2938b5da325877d7b85ec544bbf311f75cb7e17999518cb473a5cb7875ba4e59a904cc09992313ee3f44890498af5443d983a4ad2669fee3c47d592e788c56419b1e93bdaa5434ce895506adde41e75f89dce82e6fc78cf0b85850808037c172d5a44848525d1f06cc7f3610adf434ae21c1313c438eaf9b0cd4d18d4f402279a7db469080ee807630b0388046551ca3476914e3a2a2abc0b7fc211fc17a48c0b42800406738dce93b19a64dcc3cb93435ec117462ddcfd396daf99acd0bf2037a21fce0a46dbbfd974121669287f409a778b538f862eade58da183e9bd37c763a16f56b15d8d0c8ab6326189ca7116c587b87659ae82be17639362ecaa78f7ad346ae82a8f85bdf0ddc38054b9239ce975ee723ffc854ae4d028c20dae5d7cbd1b110dd749049c89878f797a20fc15ea9f6839c130253d4fa6d506fecd3605a8dfa35b13ff61e2f9d865224df588cf8d51d00341b8c607b64158903c171d76e7b303d0d1349374f6f06f080db74f55ecbbf8a038cc209bc4d86d63d9c8b7309a423b29048abdfb8849196bdea7a2a55a9b6f3c4e8019cc80bde6e6ddff2bac293c50f4f739a21331495b960a242d2d126832283f09a9d0ef145ca9cd5b513c7d72e2670717709e169e03d4d618ba6c319ac03a4c65cf7cdd050745f0ce0f7872fff4640741284ee26f1585e05978e53e1fff5a89322e9b770bc29c697e9843157f9f797f37ed45f9992e333d780fb71ea992624c195d0e8dc008877a5adaa89d8aef5b6533c2481208a946a5b32f3c95e4e518fc1c2e76bbceee2ce18703ce38e86cc09bdfda8b90c0beb6a7ce0321f9f8acd27f93800cc79dfd671825974516554e68ed1953a80d9e1a51717f06e2392612843eb73783eb74d1db18ee8c56929ac41bec655957cccf68ab3810cfb099aea1a1d7e064afe0b248d60d8aca916bc5529555ad94af922481f535f60a060ec63b887b183378355a827dc0da8a87fef209dd79ad207c482423f2d45fd4e4e8019122afe9bf5e4fac379567c13f44c35061fbdab4939f429354f4841cb1f15ec30fd69b361596e1259edb9f506a80dcd5a17786f4eb8e35fc1556fc9fbdf18d9"
					}`,
			},
		*/
		// TODO(rgeraldes24)
		/*
			{
				Tx: &types.AccessListTx{
					ChainID:  config.ChainID,
					Nonce:    5,
					GasPrice: big.NewInt(6),
					Gas:      7,
					To:       nil,
					Value:    big.NewInt(8),
					Data:     []byte{0, 1, 2, 3, 4},
					AccessList: types.AccessList{
						types.AccessTuple{
							Address:     common.Address{0x2},
							StorageKeys: []common.Hash{types.EmptyRootHash},
						},
					},
					PublicKey: []byte{},
					Signature: []byte{},
				},
				Want: `{
						"blockHash": null,
						"blockNumber": null,
						"from": "0x20a1a68e6818a1142f85671db01ef7226debf822",
						"gas": "0x7",
						"gasPrice": "0x6",
						"hash": "0x6d525131c30e62acaeb10a835d12bca36fe9cc52d8b7a7421149fb9b86d07a44",
						"input": "0x0001020304",
						"nonce": "0x5",
						"to": null,
						"transactionIndex": null,
						"value": "0x8",
						"type": "0x1",
						"accessList": [
							{
								"address": "0x0200000000000000000000000000000000000000",
								"storageKeys": [
									"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421"
								]
							}
						],
						"chainId": "0x539",
						"signature": "0xed572e5976877b56cfc6f84f9b3a4154e68dbcaef54a5730d62a400dcb7f6ced46920291b7e83b5944f3800981feccd1c3114c34d3ebd7ff5d66315161b2d16c9f82678682bf9d02e0ce660150ad9fc9839831c973cd70b35ae0e316d48f5d4bd5ee93ae9794d6ffd591c01807904cb2c1fe32008e810ee4937899f4e51b07947c611a9a078ef9e733076323eaf0ba9447d18619f702e63880bfd10cccc6472105a504e02c0499b7bc3bf7e2da9d7db96fb8b44e819aeb778eafab1f8b80d993f446846942fe7845d13aaf5e3de6f38868c3ecb29d22ae4e5660989d3ce456df42fa8a18a9c7c16546d841aff8408c4066614605e39b959a67d4317bde7300ad86c7b828b78c0a1b0378ff74837dc71448bb6fe85d38bb06d5563b6d59ece1fee3fcfaac9e9e2c2e9bc2e3e0f89f2f040a9728fd1caa9399dd51b5d7c3f1a0b7d52f5aa90682fac2d41bbfa176e05f9f08a26c3f3abb43a69b3f1c31bb5dcfd64f257fd24b5475799ceae9d0a062951937817852c466f6b7f6f3ddf85360752a086e5686ac6d33f755389b0d6ad0c7862ad6ff7403aa6f0603ce7c427d4d7b4e15b895a2d4e859d04a8e5bcf8467adac1ec5b76247678a7499a747bed541e8eeb1564230028481bfa663f1fc260f4d7aa028fb52af595ef6dd26819a8299eb2137cb78d3cc9616dc1573aeceb6cf517689b2dba0297105f16bb7f91d6735ad877a266ed85e059846a1fe8440322c92e0d7e6c049d930b02f2e5b4b0bc1ca7eeb85bca5760a5e192f3aa0008f65bae0e2b93dbc4cbb31e9247964c45aaf2da767866bd4cfb187ff8d0d8827839c1d19baa86e004181124b6fcdf1a8831a9867b441244dc8d5aab40e5a4919cd5f05687ba3a3bde035b7fbcefa12a7b2a513cc44c1d0637b288961f8e9241ccfedbb24f90ed9eb350ec380ac325e60dcab6436c0e4abb21b4b23090a63deb8596b98ec1369a594d047ca280b0829db794f07984c89466d24182834d1aad6a1185e4dd06a5a0278cfa14f6a53b7d9d4af582296a10c0e39e6e17a47f3f2df081c86c07d4aa8a8594b795734364bfff1a72ace05979a9cb3e6753b0994102572452ae1dc92a8189e80afd7f4bd3bfaf48b315d2565af6823f34282b9ed0eafa856986ea8d0df9885c22f2f29d5f1f3539e8238ba645c717c165cca425c764242a24ce8b65238d04a684bd5c4ef483b2132242d666b35f15bc2458fa7f38438f66a3527fab930a9b7521d546a9f7e56aab2165797399790b2b9b3edaee9be83f911cbc3a602a9a26154c746d44b2235cbd620236ea6a5d57588461ea05af01a4e0dbc8bf51e8c224a0aadbb822bac2738f9054e687e9ac40e753039ccdcd822111079475649316b42cdb78807a740e7c08ef5a6e3024325467b577c9fa50f12e81a2b3b490f93098a7297db299b18208cecdeb461c93fed310ab64e6739d85855bb81f2913069ba32b1339c9b8e5e4bc107a459b6db609793dc3533027e7835ff6da5cda73d02ed6ce5c8c6e2ac47f7230529c976b80e83eae083e68edaf1a7aa54fb86757f02cfad22ac69ee9c6a1ac523b93e47d1f59e4614776fa13980c750305b9c4a5991667ce10df5b49336a96ed7937f19a5614fb77dfea912e70649c7b1d31dafced64f82e56e1b7bc98f49f09912cdaeb1319d8464a94a7b70a6670768c33bf44d9d1ab89719972300d2397c3ca6fb2e327318fcb6d7bd876af81976ed9d036b8a3cf68a47a5c970d7784c5beb10aeb7c2340c3e69ea744ad951250e4070b626084bcd26fbe7609730a452d70d3ea8f81374ff6ac5e899eda7862fe04b2815335a86169a8c0510ea4aefc04e6ebeb9de8a4df792389f60f06a71b4f61164cee2e8402966ce96b20d79e159b4eae5dcef2fd7a18274238808dc371fe3daf289e62b2c6f59ceb304525e0defd825f611d1852c9eda08ebff6e068d9b16a4ff2e55e7856ec3ff17c81e3ec394f3e1e171d8e596f9076255509fb06f45d8829f982e134bc3759a2d26dfe10990a934a8ce00f64be1cb83db437368512b42a555e84fe746c1c2aae77732aae1082d205e98c5b7fa11e22d4c622a02fa1390aff1cc759210cb3833dc8546dced138e5aed8ebdc8edded7d53fe2762d006c4eadf5ee2d4a6efc8f0e34bcbd08df0d021deda058a0f862fbc1aa131bdcad9bf9e5eb822104b13fdd017e0a8a09774e0cf7e605c26ac7e8451bc0024492d40795f15f930a1bac0800842a3ae603ca132bea360d7f1947cede7ca67e0f6d5d422aa3a9ed5e447eda3d8c1da77ef7fc8b2e565a4f8c678f74e2c3e8cc9ee8e914ab9b0eafb7f1e5b2b54bf42e177190162a5cdc8f4e0ab79bfda3994b07c9c8b572fd1357e16dbd1dee6e437d01c99b523a4d9acfe34b5271e8ada3fe6ccdb0ac7a55cf85e610db50da563744315899fdcdf526ceaeac34d586023d9f444699f46dd732a602836f104b0096be5844a7f79ed35e14c193d8c1b6e7677e03ac3ef77d5437c5e8fd37f8686230141905959efe55f86896d3da4c4cc00ff8461a3ac3f6ff881bcf479264331ec96f5856aa14eb62f9d6d4cb0ca7992d7244201f78e8934da0cabb402d4470eeaeba7380e731bfa38fa07b856310175d4b815a69f1c2bee98c14ee1745efbdf2a0a409045f3f3f034168ed13603af41932b8082d72229a0c377d454b4ebd22debd92bc1e3fb16795e2ddad43462aec85c3a83e714dda0bb862fc3a07b4ca467a9c2f0a3fcd79341d19225e973e2b759d9e72a97204498838265d603d8b6799b03a422ba19cf3208e5f66b1f373515b0ea1808562ac1140b531df169de0de5d69967e542be1f313a1a382c80c37750886769fa8d3cfe6519d0a974d1d41fa9637a4ff789e4d487bdc97dd1161c10f44731d6c02ef3e14155f4006daca172151c5a5387798151e05f4fe73a14cbd290fdaaaf0309a4f168736bb76abd19ba726a0f0207f64b9e7b24d54cd85abb7dbbccafb322b038b3db00405f7bf05466b33b8f8c570cd35040af6496cfcd70c366b8027669f1b16e056d54b29be1abc98796c681bcc6409fc8c45b0a2e690d82e07378e79c29b748af3d58ebab0351cd1b2af8841b8408f4d123788e0f1565ca64d30a4d9ca240357fe1f32c0e32a65f32c8f4fb579491d009547ecedfe8ac443fe828effc6c81ce7eed49e909e8e536e7d7608e894cbda536ac7b87b2748df9ced8ded3808073b3754e9d99463af8156b694cfd86d718855ed89b5d3959bd6e721abcd3b887a402dfc3088ec960b1a74ce31bcca2f4703a8d739fd1f5f5e03fc1325d57354bdc9266ed328fbaeac5e3662f18c86751995af056cb6b254824d9ceb466d5a6d0b1c19698c4c13328c81667e8d6a2da3661eefb48e7aba348ce1cb7fd420690dd560f710fedbfca5fe8b46c0f1d7c043ca526741ae9c018e60bc9f62399e2c6b3d71df3cf6abc02f79b9da8a8004f6dddfa4681766bb82f7046e95432b58aa5954f3f2fb7734a3bfe78da3b82aeaa569c7e3c0e2c0602427cf6a911b1d9084ef1905a711a2ad5bd09f7a8957b34a21b2373bf1044324567977ac53157505d68c35ce0b30d68c8adf5e49b95b6b4d19d50914ae8414c18fe1686d1b1015eec4f97ed55aa243ccb67a549528f1c3f41546a03270dfbc7779b2ba39a85a8c98a2e5fed63d271e0693de74d7af1cd0b5c5076ac10487277f54599c834deb2699c85ca9857090735f8ba46dd2166ce072b8f000ddaefd29a0c2d0e46c9364de8229967a2c9f682c6dd54c74f724a60a9a2ba38a99b7103e725c626b1ddee2ea7454f445bc21e0d1f21c7278669882ac718373687e69745b05f51eb591d598a3c828e94ef42a3768d6771c7f0683002904624ebc606fbec9f7ecc67cc0214a51b50bdb29a53dd30b1bd55a6670dc01a99ac6c3eee568dd6f4d8647a984226fde074516f53fbcdf6806c744461ef9229b65ef0f88b0b023cdbd6eeb3b8332bbbd9373bb607904bd2e6bd39fad1771a8747789d5929c2682c2714a2194000ad9426ec09930d3d5284e639e5126d31f7e4bcc87608c40b3700cb6c499df17a89175f5139728fc795beca4001cf3dde10f237265c3d09a06cf0b0b7e8f8f8a8fb304a8e39145e8eb7766043c3ff2a8d8f403c666d766586bc8a6e4ac39d9a2117fdbc5729406531572deee72cf4393990bc65e0aa5c4c243002c4e6e96cb0b8e41d3a801d79f56f708d2ee02dbd4e16b2dd9b4ed6f37436e4993f57b2cb1cfe95d156e1dff98b465fe1aa1e3149a24cb13b1faf7784e678fac716df6b98b5baf695beb3ca52c9a679687eab4f768313b04259d163dfccff271ab35365a8e399ccffb2e572a113ce3a422197a4432bc5258a883cf740fa2a09641f600fd26abb679abf7ca178281cd1d1237d13ff2295ff20795f5aa016df17f5e423ba2de97ade5e3e26326e20de401a2561e0cf79dea6d35b000926132dad2fe47a84be87e5f3b1c01e1d882a49e7407130de7d1b1e2ee0e9d01660cf49bdaa716d0a99bff19dad13ca47555ecf147913de374af7d0f544767908391ce9694af1510594db7ff661c903c13f4571ce46faed1fc2070074fc1f78c48f5f2885821cc7d4e1ab9573ce0cc01a89d1610b6c5168323b1d97083d16cf021d7b6eaf18855a28853ce4c57a96cc14f1726d4a3d00621763e3be5cec7a0aa8a164c15034cd562f1094679928c65488c5bcba44e88dd590031a336c2698a79c63a10da5eeecb7fc6e45f903ae226d4a9e76f802fa8548d678f00800900faa3d0db052396f238703c5447fd6df2a935539e5d940bdf1ea36bcf92d53a8c4c434996dd6546593caddf90aaef0488fb8ebad2617eff9daa2839bf02d46d1dd73552e07ccdb2a5fe28020847d9ef77a41ddd58a716c4e5a1755c29c25f0dbe98b84c77ef0b41e7f8435c7133fb4e026ccf03f62ca099d1444a2afef162594177c1ed6af24c0ce38df3cb0d92d2fb54a680103d0c723fc2e4a51d05db3a4bb7dc01da69f3b35169686925aa73454bfd2f878694f6599f20df522cb9fe8e3c5c00b719c4bebd3ca96914b12cb5367310361ee2398ea0a20745af6aefbb09983f2aee67b87436b3ace748804cac66a483585405c57add7ed50a8e039d18dcab4658769b8700b2188523c918c23e90235162812042ff50bcda65b98ee5db7b6a75871b85ab40dcff2ae493d04c7e6bdcd970b3d08a145e515ce4e16a8224c772abdf16fdf8ef540a887db320f3d203ce9227d000232f33a4c7b5c342daa79af7fba2779f049d43ba1b4b35427a9a0a5bf52d807cd627560e0a21335b0aa5222d84ef4fea3ff112f21fd91d38192c8958addda690dea26f74f5e3a4ee0821620b0a6fef80332043e4a4a355bb3956dea39b2a1afc937e18476682699abccc41b613a6fdd2722582c84d709938927a684a259c91c6cefae52e8a96a7d750bab191ff96857c238d694c5239ea756287797809dc1d150b256e2af0027c777cce25aa6d56cbbeb4f17227cfe324628b22f7d294b7a54b231ba6427472072b1d2030ca7aef639efdbc42dec980a4c5ab22957d0d824b919bd7f2efd45369f245f51281867691956f1659b4db670ea1f01144125e3bf006218bc5ab695eae57ca663c32ce826a665f07df953066d925f9f76c6906cab20f5d79fb46390271842a0c6601c3cdefe6d4605c02986ce7bcb105756265b240bde48cc600d4b2ce46ac2fc1ff1d7706a81b881c8a390a1476204154287046337440feef8af6ab8d8c60d146a32fd9e203921cbbd1066ed4eee62167bf6ccbd6c39c75d95c57968615871be7edc51caa9de4878544ac45b5893806c363402df72d2fc117c4ccb7a93d5c16cc6b4915557ad59a4b80cf66e53e05583888ad5788355ee6987fbce4457d822a31dcd5b185e0d605f70eb04448fcba58c79e3579c6fe4bb4cd7e58c056f50a288117e23180df0093e8260b0cceaf2407985735edc02278d51b0d453dca21467c82fbaf401291690ca01d7513e346742ddd5dc32899e09aa7f2d9f1a111ade4e6fba6fbc8373890a1e1b92e1cfeaa3b1bcad971a8b949299b439a69b2d06536220d715692755c015e489d86982225c507ed8433ea582978dd265e4e437ca17f86dde9041a985822f221f7db9f355d182f453f5ebe530bfafc24ff2c17bf6ef298daf8d21de65961f11c74b049c1cdb7f2a3505aa584e076a1e95cfd85cdb7d5991a0d0a66a31f0f1f0bcd4aeabd86ca1e449cce5dad7bce55ee5a439fd19c620cb3378988f47fc7e25706419636b50fbe449c3fa5319727c121e77001b3548996a56a67d6272c09f32b8641a25de64e632dd7161c0b7f99efc51106440d5b0b3d351b3658442d58ffb3914f6b5b6575106a7d9ca0dcf5fb0f1b3c6b6c7baed70e14316591b3cbd1d9edf8154f55c6d0d4dcf12f3e9bb03b525878eaf94a6d7e8eea0729595b6d799ca3000000000000000000000000000000000008101b23272d323a",
						"publicKey": "0x01727d783cc48b50060e8d3cf86eb8f37a5fe0dd49beb6c79e77aa4243aed4acdc5bed459f9ce1aaee191558c4791a698778f22ae0b670dbc963f9dff974c5c4c7bdf86504364cd48ecbd37c990758e92abc82f9ab42eefac09b5c307064540751421eff33e436f05f59c0a43a3c1b93442fb8b75bc4ca7156310162c935c50dfea28b8f8cb3409edb3a3b8242ddc9320f97e2e9f3d50f4428d791d7969e412ba10a2b22c6229395dd86f86261104f3cf37617d370d28f484b2605828f03b017d898baf4b4631212baef96e81c017dab349d8189a70f07bfe86240d5f5a33802ca794072aef09b4171b153af2b33a8b375a113438d271cb0fe625d76e8fcca390dcbb924abf7ac9bc5e6ea6ec38cc7b4fb38ac22ded5d9280260c53f87186e8a1f44eeca54fd915015daeaa57fa3493130dbc0e3b664df05bce6cfbe8c10c1a7b7963ec5d9f6e044995050bc169b62de61e37e91eb83e0f21aa11018edd4f2587b2c907e1f99fc93a30935a9a16c828e778acb8d04e70e6a4cf248a1f23088fcde603ae156e538c1f2cc07e959f1a0d5d8771ee207284edc9e5f34785f708a9f1395cdbbd17fdfaa0792d9ffa1af4dec2907b603698bc71621df7e34c6adf001951252b97d69590d7cbf7a102734aca33b3a337ce3deec222f2b8b61c45ad189a75dd30746ec7c9700fccf361b94b23564c974bd024b89a52d3f225d0b562e4500b51e0c447caeff5eb760d781c416aabf702c079baad87fdb18c61d50cc8827e407fe088a8da4575a92e13093d24c63ff37ac70bb2a6be9631891b0dd570a7fbb73bb66d489058ac89c46db31576a38dbe2a206a31f48751b45e1bf7934fd8fc2d242273aa1261ca679a6ce693a458a5a33d47d8b7a8aa61f62060424bcf911f147206c475842c16dd801e4ac32a8223215ad3a4e59deb4df0597a612c330af5a787f05327cc5cac9e8a9d151adfb0413b5a68f124d9f1cbe753137061f5beb8ec2b9be66ea23076f2d6da6624a983f76ad92235315a3883c2a321b013586c055941514d3a6d448ff1d6cef057e4ca26b944d44086f4df7970371464c56151221cb808f0e00818cd0ffa916b78e696132ccc71a795949a39f2a5a6acff20998c085e640c901f251998d15d6cb7092dc48e69284e4836e634db47664f926697055252be841a5a79603f8a2a419650a6f1ad7c6bdb11a391bdea76f4f68be08922f5ef08bff8c0d02d5aded7907642cc6cca4fd594f0fe4700efd15827ae2f4a9c7f8f629498f1992e4cb575ed9bedb1927bd57bde751624a34c8438892ac114cbe1aac962cf4fe199d2ff2a23cb1f8c3a3e6d78a8b44b66d8f25c3702bebbfb1974698ac701d263561a32cec56574e1eb9f289fac40fa441296d79ae4f0f51c8e9a50d7acc1779b5a47a806c692a1c49e99fafb63d2149eeb175aa7ef584cbb5504211fbe6585e30ba0edbb717decc3494ee984d5f3e56089f14ce7222c6573833377881a861fd763e4fb667c9e76c860ffdee0771465f5a37aad543e3fa5f024996dba344f6a1c24b245a45adc6a18ac4dd08bb0307910724007e344ad302b534dcf7dd2ac3966bd3668486ba361ac1390155c0e1334d3a79c631f889bb26dda72449129d4441e795f2c124cde229d4daf79bc9f15c562fc0f6faa47f6b757cf4c7d0d6271c1e47f3d01ac02938eef495ca61e051617f32693a17abacf604722025f72660979716407f15d56a71b1427019b2b8897a7991f6d9bead653b537670bf4c5e7bc54b8745b533ab4bb96b588bdeb2b4f713f25477688737dde64107d82feabc00a2689f27b1b58161b6281d9edd647b8d23e9442f2123c93365f6805cf903b8a802a2de6d5622407cb9d88512fcc9ba9f18c90cfaa80e1e9f985e9849c8b91d9cdc1f862135f6583aed4f5471124408a89081c0e14789ce8f2444dee55f789387e6e48e6212fd271a1e3a55de0c1e122c8772dc32d1ca77284eb4649e86ae6e5569a4cf840166970a21d79c50a8fc9b2d1c144ee79885ffdbc22737b03a110b3522ea5c26ae99f950aec20411cd1c2466df4d90c3ffe2ed9116b6c23a63299f6d7bbcf2a37368765d170297d900ca346fa60f0e6a3fccf2a01548219982c5e49444771e64619089da4c6263df7ac2693d9037800f68607a34d7eeb489b1a93030488d7cd407f4f2ab561701d884d7eeea39f79cf2f25c4da089f34ea3f3dc15da1bc43da8e7c12d1e0c05b107f10da1ea5a684331f2ecb696734b47407dc51a15ab9c9b98f31a42cb2e771696ab39378bbcfec21021bc42ffb1488920229589505bb6fc771edddb1818a081a5b8fc90eefba70091ea3fed3fe81f95f721570662eed03cfd759fb064e2401e634072557f025cce8affff8c062381b5e0291fb016292b5403848b419037d9bb6190045eb19454c2ea2debec95eb9d7f76f9546c922f96d1a04c537594ef5d26b226821a3527cebd56ac950c54e7fa0557e017e9a5974ae7defbe1fb3ba3037f89d12ea7f85253ef885af0da7b1e60a8637d1197b795a9d663723b94f1806b2938b5da325877d7b85ec544bbf311f75cb7e17999518cb473a5cb7875ba4e59a904cc09992313ee3f44890498af5443d983a4ad2669fee3c47d592e788c56419b1e93bdaa5434ce895506adde41e75f89dce82e6fc78cf0b85850808037c172d5a44848525d1f06cc7f3610adf434ae21c1313c438eaf9b0cd4d18d4f402279a7db469080ee807630b0388046551ca3476914e3a2a2abc0b7fc211fc17a48c0b42800406738dce93b19a64dcc3cb93435ec117462ddcfd396daf99acd0bf2037a21fce0a46dbbfd974121669287f409a778b538f862eade58da183e9bd37c763a16f56b15d8d0c8ab6326189ca7116c587b87659ae82be17639362ecaa78f7ad346ae82a8f85bdf0ddc38054b9239ce975ee723ffc854ae4d028c20dae5d7cbd1b110dd749049c89878f797a20fc15ea9f6839c130253d4fa6d506fecd3605a8dfa35b13ff61e2f9d865224df588cf8d51d00341b8c607b64158903c171d76e7b303d0d1349374f6f06f080db74f55ecbbf8a038cc209bc4d86d63d9c8b7309a423b29048abdfb8849196bdea7a2a55a9b6f3c4e8019cc80bde6e6ddff2bac293c50f4f739a21331495b960a242d2d126832283f09a9d0ef145ca9cd5b513c7d72e2670717709e169e03d4d618ba6c319ac03a4c65cf7cdd050745f0ce0f7872fff4640741284ee26f1585e05978e53e1fff5a89322e9b770bc29c697e9843157f9f797f37ed45f9992e333d780fb71ea992624c195d0e8dc008877a5adaa89d8aef5b6533c2481208a946a5b32f3c95e4e518fc1c2e76bbceee2ce18703ce38e86cc09bdfda8b90c0beb6a7ce0321f9f8acd27f93800cc79dfd671825974516554e68ed1953a80d9e1a51717f06e2392612843eb73783eb74d1db18ee8c56929ac41bec655957cccf68ab3810cfb099aea1a1d7e064afe0b248d60d8aca916bc5529555ad94af922481f535f60a060ec63b887b183378355a827dc0da8a87fef209dd79ad207c482423f2d45fd4e4e8019122afe9bf5e4fac379567c13f44c35061fbdab4939f429354f4841cb1f15ec30fd69b361596e1259edb9f506a80dcd5a17786f4eb8e35fc1556fc9fbdf18d9"
					}`,
			},
		*/
		{
			Tx: &types.DynamicFeeTx{
				ChainID:   config.ChainID,
				Nonce:     5,
				GasTipCap: big.NewInt(6),
				GasFeeCap: big.NewInt(9),
				Gas:       7,
				To:        &addr,
				Value:     big.NewInt(8),
				Data:      []byte{0, 1, 2, 3, 4},
				AccessList: types.AccessList{
					types.AccessTuple{
						Address:     common.Address{0x2},
						StorageKeys: []common.Hash{types.EmptyRootHash},
					},
				},
				Signature: []byte{},
				PublicKey: []byte{},
			},
			Want: `{
				"blockHash": null,
				"blockNumber": null,
				"from": "0x20a1a68e6818a1142f85671db01ef7226debf822",
				"gas": "0x7",
				"gasPrice": "0x9",
				"maxFeePerGas": "0x9",
				"maxPriorityFeePerGas": "0x6",
				"hash": "0x88232264d509b4bfd84f5f1f9efc73ef8f1c4b478e5c7a945ff6296b6bd154e4",
				"input": "0x0001020304",
				"nonce": "0x5",
				"to": "0xdead000000000000000000000000000000000000",
				"transactionIndex": null,
				"value": "0x8",
				"type": "0x2",
				"accessList": [
					{
						"address": "0x0200000000000000000000000000000000000000",
						"storageKeys": [
							"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421"
						]
					}
				],
				"chainId": "0x539",
				"signature": "0xf08aa986c92439e6d3b59509a890afbb78dc9016f6a673b0c0f2280a41908620182b4ba792aa45b32973da0f16dc6d916f200491f1b0ebe041b648365989a5c3e13a6e50d107c02509dd17dee333834d1e18ae422d1821c37e206c85e10cb02b53a176b4e4b323b2216d4df00cd1b0d687bc30dcfaf9cd7c63c5847af2a4df8dcfd2e07ec9e637f4dbe03d1727a33b9d71c5cf8afd731fdcf0fc32bace95593d137fc3c3a0d896587d5fe0e3fee6d90a71df11153ccef4f92d93d78bf88747a601e556e43b6a4ca6868355b559f170a6c198fa89e0d86ab1ebff2f2bb8b96edab9ddffc355274f5bdd7440734e019b92f28083884a1765ceb548088b3fffa0ffe5fed1aabc33e4f6db5fba64b716be8ee2544f80fe56e5d5286d0f4f558212095a6399e6ee34ee92ad43472690cb25fb9b3dd97c086d40b09e49af04af233230b4ea8cf8d7fb89976b1aaf9aa342cb36d595433446d2972bb8532833a36b74673b365b00ff6c06a20eae6dd9f004f0db61ab4ebe7b920795689652ec4c2851baec9745b1e76b3bb410b93ea9b6d834722156dd24be30f6a4d137eaddbab0eac47f0caf2093b9c4e86bb3d334611403f76fd8235262d7d29d52502791b50b822503b7e877bd5783f2763b7cad2be21370e2b09e580495f27e54d85e32b13208b695c1007e8731f7d705ced1050156a8b1d932815a61c38ac58665d1b6cfa23f6f25ef74c13c8e96f67e841730eb5b05b1908a6b0241a659aed89705a5c16994927b9b03ab01bee88b70cf63cd04134c2b7fd37a3537702aff84481d4615873dbdcaba0d6e9153c2f4f57ece9b96af16bed74fcac8c9baf50026b135270fcb38b5edfdda067c6f79e9ccbc38e7bf4b29d287ac673b55f0edb9aa23a7bf3b1b62e5849232a6c1b2476035178ac45359c658cb0f6854e7a35690fe915f47deb908b842e60459618f4af9ce2cd8d4a0e72095e6db632798b294df99156e057618d7d7c9e320213fc7bd60dc3fddd753d1d9962f39cccd50a9134255ef12962c9e12e94e763cf1cddc819654075ee9eb666cf82d7453437824897755bfc581b3160933f04def69a953410fe73eb4aa6ead5701fce352dcba497d76424ed2a780d93338ead51996253da3f130cc8fdde6f86ec33d8e3bee4d5b007e4d5aac9060247e2419c3a9ce86240ca2b85f3614b11d0c9ec32132b519e2903f95f53dc0195f329b1ae707a0ccfd2f815807e553b43da841c6c3c5d87f862e1d986d7b854d0e900fd0ef0929bb0edeb6b8a5f56df8ffb0e5addfb72b52155b70202697c58a08901619f17d583e3155cefd5d4ef3262cf7761b5e6c0bbe9bc73e546a60f7314333fc8a45e4f070e3692982ad568388858dbb56648ac79ef5809854af12db4562138f96259ec3c89e4ff41f640282eb4261b3f321573c8136278a75177e4f749ac40b0e5bb170fe31220e2cb3a1e1a302d617919cffe4bc748c8bf8a4f23a2b27f22d99634e8bdc74510c462a6ee7a38338d07702c69470033fb54945c9078fe447571e7155a9a190011c2d07cb809bd0de8d6f4b61c5dca559fad44bb9e22ec8c87579688b6a77796f3c41b98147252e7e5ecc38d91f996534169812fa076913e835fee6bd3c61e214f6e515a120b48f58bbe245f891de4fe33ac5d767d383fab70c920e723b4f3e9ae2a1759cdd65f89e17fd7442758105d90e20958a9bc91f8baaf1b45c12515b5257dec258220e47a11eef449255ff3665a989c323dcc2c03a44526950c32006a0cc4c1ba6780bd8f2d82d4a3afd0cd9e9556857f68f5f093a2e9f3647f8bfa4f1d499894f323a47e9c37d951370fd87c90240404d9567dd4dea0870d61a732b761a119c7c46620be1c36d01222a786e6eb2e4c4fe227f51b82171b96e74a3a7c81b15919e44ae8ef88948389e84c0ca7d3fc3cf326ab87e9386e8e4e8799f2acfff2976f23a084c8669fb2527ef4f9599d60d9ba4a6f0bfb3e3da126886d323d370a95b322826164b5519e0cdf085df01f05d05702136b5eef01db0ca1f6c333d610d4ec5243362a544abe95b2de65b1243b80a5163c5516dd36c97074afaaefc1ad66d6bdf11f5602a4cdfb3c00b03f102598215f03bb28872b7872ba7ea0f6c554935ca13e8ddcbef2e81489759d511562df1771bc9a1f881cb76432596d5b9b25b1068c63c619aaef8cc7599c0467645bdc08afcb194c73726a200e21389e0226a0e06a436fe891161e58a20ec68dfc76e32031907232ef650d848e98d7be26ea6dfb6cbbd1bae65279c31f2063a9d838f3d5eb19a38bca6a55aff10edb0509dc3c4393852b9ca5749304c472e56b0e773fac527e6b7dee21f818812bc20088ae8a6da7a66f84af4bbf59810dcfb55df4e071ca8b2e9581c99f5b7d9dc89b8251cece24bc20fa57df410cca62ce59bffbf450abd0531898e38df4881d1424f87c054b60e8fbaf05cc8c98d87f9fbd6fdac5a99d24777c4d1cd61d8ae38589eed65e30c6e0e554915cd4ed022347e16bf1514e46b444b52ab1c9dc27255e7886ce24d5cef6942273992381889646bb900d17e232f063cfd6141b8e324ea8ea6b49abdd9554f1a46a1cc170e6efdcb13f8183c1d257b2231ae80729584655c0bfe140eb650cf54faf9eabd2a27896a6fbb515ae04f1ba04cc1e3f6007ce6f5c711b84b32a5baa810227cc7b78c09a6b202f278c85cbb100ce0d500594e0807ae515e75a5ea5020aa6bee53975ab92d4108eb1be31df99980bd71eaaaca8cc625b527de0ba3b7f44d07f1e3f0d7263819d761db925b3e1a7f2fe4fe625128f38e9ff442fc5a679ffad397ea6557d5802ea5a423c883d36dc07c2c47d3f523335257d0be63cb8452b23b171bc9f6dd9d327b96eb69845e3edb09fe4cf82cc519e3a9d9028f52c45dc95b7d577e8ef0eac8512bed17361b06772d20ea63f71f11856641534de1618f26a41903f3cfba391a0ef8248858eebe2425f333e8bceded3f7f9c9a9435aacae45178f3aa255335dc785e75df629a7580bb3ebad84f3c94b2b705804a06ce9c55da6623370e37dc7bb4bca034a2b6b7cfe7c39fe6601d94cf549c2981d4010c70720b8c70396d8cae148c3937694d6c8c15d09aa71b83eed44e1a789f0eade7881511d26f8accc6d5faeb7ae88d956ac6922c9d0d5722cda93e30e80b4324345c5498f9547fc8d059ea4af779bbd9f683ff5b787819c2c6da64051014a17395e452f8f9460a738ed77cd41a1941dcc13e1b19417ac3bca2c7b8c76cef77ca1d1881da88a28b1354e3eb62040103a51d94f70ec6fae01fd5349df0e3355f954b0bcef6be1adb6b933e2f2f5e72fd643bdce4eb0ff5a37044c322161319f2b2c3e538ba71942e4facfea90af9a1d4ce282840bd41d64fb055767ce6896b6dd41d4b99615e7b4070c22065e035cc51406ac4ef0ac879b2ce2ca5dd7180b31caed48c26748d0108297ff866f9c05a37f7c090e03dcb0d4fafaa73997b02f80142fcf387d614f6848aa9e0dae132249e73d438eedab7be12e89fcdb17b77948b4ad032a043b92d242e8cd9c1150b99f73301d633b0da8c584ca5700ef4b4e94a51f9846886a75778cfb8f221246c0c617617bba7a993e2cc887448adac5beb6bc1fa26a17680d72e8c16134f20464b4dea8948c2565a48d3ff76c31bb6d74c0b64ddfafc693dd51002adedd6373dfef7f545c7a94370e599d47633603b6257cd412799ebff77e912f86cc36967d1085c4b8d955a91996d998b3e41c1cb7b5d9ca39f54571d7f91e2e46ee46ff157f4bcbacaf3ec61c55842610a90dcde88e21a3cc71b46a92327c2893980833ef6b02eff68d3bcf8651c70ef0726c0c8c1d9c86eda487853e397aab11c6b8faf94be5c3fa839cdae187758b78e7f264f4d69d0fb09dc732527f02b1f1a7c94288d51ccdbb4efc2f7573916ba52859537e508e947acb2b8d556b53a85c19de18eebe6029b545c33615135edfc34bb36501bec66a4693d73824776005648744a3864aaf21649220726b80396001d60d6ff46a3e7ae391e36e3ddc7fbaaadafb36c827769dcd2021f0de0264c1b52b55eccee0d679a3a12df7edc86e9547a0d3a01616d2414ab500536507b3870148f72d0783d96dda98f85e7f785fad9803910a7a6dc5392f81de6093fb1335ae1c3e260b47a8a10badcbed7a478e8f95da8b0aafe9a42ab17273ebe9e60becd414ac8155123c908775819c53d60cc2539b5b69453e5f34ab1c3ebed686ea4961586cdba65ca17f92d461a785b4d4183171db509d8ad014379a6283208a04e7238f48ce5eb65c9dfc17553e485b54d50980dc8178254bdbdb6266f2e0c7e42fafa08c9d619b5aca15aaeb720355d19a7da191cd88570114376a6155d43804ca66d3e9a6f82b3b2baf11db2f1626d801e85eafe9bd1a19199171c38f985a78316df5757506873f48abaa918bf262e5eed3dd1ecc22aea64f6d9661a5230f693235f88a6cb74d6780347f84e7c60d26a09aacb3743eef109818333ca1f8a89b80e310da50727374da9b257476b77b30e1f17f3f79a08397ef308bcc73bf1909a072274f96455d8c74f7364ffeaa8342e5968eb46ce811b980a4bb1124e4a7df36d11fdbe72f5851d52d3721b1752273984e57baf64509fb4e59521ec33a14e65e24999dcde5a44d19a82502e4374bcd6d7becc2391cd8c3a96fb44ee549c9c203090381008f70ebcfe02c7f5ae2db5bd0c1f286e7045008b6d2afe77a21416ff5ff37437bdc0ebcd44f4dde35aecf248520fcdab2d09c89c40970d7c486c8c94343328cb296ec25118a3d60af55a492bc14d00506350a2993b23433c430f17364131240a9f51db0ff00da1550e7d8a259c68756891bad96b6f47041645fd5431f12636e1ec629c13d9fa0e3a3674601c72dcd76e1966759dc1cf8c4f7270f9039bc8f5c1eba8b3e45cd7dab9e3794d89ff0ca046ddb8e74a6e18b00c580353a18edd7fc764bc54833403a3d9d6b12c3b146f3c897283c7ebfafa9bda04e81e27de733f11378eb9e061e82785bc68fe955be2f88d066dac141350b6b86c6eb08e75efb1ff461a5d1738734e685802fe70ce0c4cd1cd0619941508ed043dcaeaf3ef6ac612c79a31270b3db21f15243bbf85ce8f50e24c5aff8b3a1b8157b1833c973729bb58e6da4c5f7b4832c98403179663c49285721b0c4cf1c31a67689aacdddb6da72c777ebf57c3a705469fa6889805b5c31d449885cb10f661454a9d6c8e003b1828bbd6693e340aa556145e516098199b307d75c7ede5dfabbf3f7fafa5de7c6e2fa95af97c7fcc6242fcca44687b8adc2166d17634a24c8bb033c936875b2ab550192bca848093c2741f3b08827ff4aaa9d45ddd064e45e07ada62ebb3bcd234d31c7958384597115a3b9624a83f59bad456ecf42d74439024afa07f946ecb5878838e0f5a5a75c7d307c3969ac4ae169f2d0492afd2e6754c3efea22b9a1b0e810f38fe1f891f8ce2d58d11083a8e2297158753b3d35f92c1e8323afd79656a26cb046d46a060d2abf686d0ff554b58bef93ad8579026f1a194bada6601933dcced5cf96b780894a27b3cac06ab572e8811c929ff11fde73eb92d0fa94f084fcef0d450b9a7732110814f7e5583e2f71a3ca4aa65940dece5149e31d181b939699ecaaad039e33f69637865d72f0fc682a0bae1b87bfd147b9a55f97a0a7c287b07535090c25ffe0b00ad603560037e9541f06ff3fa76b46cf903de0a93155eb87e9564931f33029266b607b7e7bf3511fefb37d3cf04e7fefb33fbefc67cb11204ae38043e81b5c2a97cde3a318287917272d3cc6d2cf3684579c29067c8a0dfd8ec416ec930f56ca4cf1b4d0926ebd564192daf21f5478812500cdb55e68351e0a264f49c713bb9de104712660c15a36db54f2a4ea2351a11c1fdfdf959aca4bafd3f71a87d6f7e219c19b1cbe5dbb64b5e3aae2acd851fd025cd1e69e465a7a6509508beb5d65431b1941be2ceb0b6519e7e0bab8780d72a9914b708a02634152f0f5272dd0e9f962e39af085709723dd41103d51406364b6be08a437100e34b9de5454fb4a44cd16b6fc46b504722eab916a02a747d0ff7018fdd969f8c22b47ce9096a6b863e7bc3b72723a6ba438ed41e9458a2d3647619cccb95de5bdfdd6f46abc063a6b8be60966ff014f456d3702e088ffb14446abdc70a2c491da38636db0acab4d0f3f9145951353f3e71cbc3083bcf1296dbef54ec5099debd57fd7656d5f306817a55c031689187062df0b9653d67a3f428dbfdb866b26eb2a2c5b61423de8f7db010daec178d96ced8d37a60f7f75be9908938980981d348e766b377a43c16193922a51f069e5f75e1d2eef09182f6d50a143639437792969fdfe3f17babb01fb0cad00432414959a1b6cada01102c849ae5012f5678b2b8c11a505c7685868bb5c7ccda546586b0b5b8d1def300000000000000000000000000000c0f131c2229343d",
				"publicKey": "0x01727d783cc48b50060e8d3cf86eb8f37a5fe0dd49beb6c79e77aa4243aed4acdc5bed459f9ce1aaee191558c4791a698778f22ae0b670dbc963f9dff974c5c4c7bdf86504364cd48ecbd37c990758e92abc82f9ab42eefac09b5c307064540751421eff33e436f05f59c0a43a3c1b93442fb8b75bc4ca7156310162c935c50dfea28b8f8cb3409edb3a3b8242ddc9320f97e2e9f3d50f4428d791d7969e412ba10a2b22c6229395dd86f86261104f3cf37617d370d28f484b2605828f03b017d898baf4b4631212baef96e81c017dab349d8189a70f07bfe86240d5f5a33802ca794072aef09b4171b153af2b33a8b375a113438d271cb0fe625d76e8fcca390dcbb924abf7ac9bc5e6ea6ec38cc7b4fb38ac22ded5d9280260c53f87186e8a1f44eeca54fd915015daeaa57fa3493130dbc0e3b664df05bce6cfbe8c10c1a7b7963ec5d9f6e044995050bc169b62de61e37e91eb83e0f21aa11018edd4f2587b2c907e1f99fc93a30935a9a16c828e778acb8d04e70e6a4cf248a1f23088fcde603ae156e538c1f2cc07e959f1a0d5d8771ee207284edc9e5f34785f708a9f1395cdbbd17fdfaa0792d9ffa1af4dec2907b603698bc71621df7e34c6adf001951252b97d69590d7cbf7a102734aca33b3a337ce3deec222f2b8b61c45ad189a75dd30746ec7c9700fccf361b94b23564c974bd024b89a52d3f225d0b562e4500b51e0c447caeff5eb760d781c416aabf702c079baad87fdb18c61d50cc8827e407fe088a8da4575a92e13093d24c63ff37ac70bb2a6be9631891b0dd570a7fbb73bb66d489058ac89c46db31576a38dbe2a206a31f48751b45e1bf7934fd8fc2d242273aa1261ca679a6ce693a458a5a33d47d8b7a8aa61f62060424bcf911f147206c475842c16dd801e4ac32a8223215ad3a4e59deb4df0597a612c330af5a787f05327cc5cac9e8a9d151adfb0413b5a68f124d9f1cbe753137061f5beb8ec2b9be66ea23076f2d6da6624a983f76ad92235315a3883c2a321b013586c055941514d3a6d448ff1d6cef057e4ca26b944d44086f4df7970371464c56151221cb808f0e00818cd0ffa916b78e696132ccc71a795949a39f2a5a6acff20998c085e640c901f251998d15d6cb7092dc48e69284e4836e634db47664f926697055252be841a5a79603f8a2a419650a6f1ad7c6bdb11a391bdea76f4f68be08922f5ef08bff8c0d02d5aded7907642cc6cca4fd594f0fe4700efd15827ae2f4a9c7f8f629498f1992e4cb575ed9bedb1927bd57bde751624a34c8438892ac114cbe1aac962cf4fe199d2ff2a23cb1f8c3a3e6d78a8b44b66d8f25c3702bebbfb1974698ac701d263561a32cec56574e1eb9f289fac40fa441296d79ae4f0f51c8e9a50d7acc1779b5a47a806c692a1c49e99fafb63d2149eeb175aa7ef584cbb5504211fbe6585e30ba0edbb717decc3494ee984d5f3e56089f14ce7222c6573833377881a861fd763e4fb667c9e76c860ffdee0771465f5a37aad543e3fa5f024996dba344f6a1c24b245a45adc6a18ac4dd08bb0307910724007e344ad302b534dcf7dd2ac3966bd3668486ba361ac1390155c0e1334d3a79c631f889bb26dda72449129d4441e795f2c124cde229d4daf79bc9f15c562fc0f6faa47f6b757cf4c7d0d6271c1e47f3d01ac02938eef495ca61e051617f32693a17abacf604722025f72660979716407f15d56a71b1427019b2b8897a7991f6d9bead653b537670bf4c5e7bc54b8745b533ab4bb96b588bdeb2b4f713f25477688737dde64107d82feabc00a2689f27b1b58161b6281d9edd647b8d23e9442f2123c93365f6805cf903b8a802a2de6d5622407cb9d88512fcc9ba9f18c90cfaa80e1e9f985e9849c8b91d9cdc1f862135f6583aed4f5471124408a89081c0e14789ce8f2444dee55f789387e6e48e6212fd271a1e3a55de0c1e122c8772dc32d1ca77284eb4649e86ae6e5569a4cf840166970a21d79c50a8fc9b2d1c144ee79885ffdbc22737b03a110b3522ea5c26ae99f950aec20411cd1c2466df4d90c3ffe2ed9116b6c23a63299f6d7bbcf2a37368765d170297d900ca346fa60f0e6a3fccf2a01548219982c5e49444771e64619089da4c6263df7ac2693d9037800f68607a34d7eeb489b1a93030488d7cd407f4f2ab561701d884d7eeea39f79cf2f25c4da089f34ea3f3dc15da1bc43da8e7c12d1e0c05b107f10da1ea5a684331f2ecb696734b47407dc51a15ab9c9b98f31a42cb2e771696ab39378bbcfec21021bc42ffb1488920229589505bb6fc771edddb1818a081a5b8fc90eefba70091ea3fed3fe81f95f721570662eed03cfd759fb064e2401e634072557f025cce8affff8c062381b5e0291fb016292b5403848b419037d9bb6190045eb19454c2ea2debec95eb9d7f76f9546c922f96d1a04c537594ef5d26b226821a3527cebd56ac950c54e7fa0557e017e9a5974ae7defbe1fb3ba3037f89d12ea7f85253ef885af0da7b1e60a8637d1197b795a9d663723b94f1806b2938b5da325877d7b85ec544bbf311f75cb7e17999518cb473a5cb7875ba4e59a904cc09992313ee3f44890498af5443d983a4ad2669fee3c47d592e788c56419b1e93bdaa5434ce895506adde41e75f89dce82e6fc78cf0b85850808037c172d5a44848525d1f06cc7f3610adf434ae21c1313c438eaf9b0cd4d18d4f402279a7db469080ee807630b0388046551ca3476914e3a2a2abc0b7fc211fc17a48c0b42800406738dce93b19a64dcc3cb93435ec117462ddcfd396daf99acd0bf2037a21fce0a46dbbfd974121669287f409a778b538f862eade58da183e9bd37c763a16f56b15d8d0c8ab6326189ca7116c587b87659ae82be17639362ecaa78f7ad346ae82a8f85bdf0ddc38054b9239ce975ee723ffc854ae4d028c20dae5d7cbd1b110dd749049c89878f797a20fc15ea9f6839c130253d4fa6d506fecd3605a8dfa35b13ff61e2f9d865224df588cf8d51d00341b8c607b64158903c171d76e7b303d0d1349374f6f06f080db74f55ecbbf8a038cc209bc4d86d63d9c8b7309a423b29048abdfb8849196bdea7a2a55a9b6f3c4e8019cc80bde6e6ddff2bac293c50f4f739a21331495b960a242d2d126832283f09a9d0ef145ca9cd5b513c7d72e2670717709e169e03d4d618ba6c319ac03a4c65cf7cdd050745f0ce0f7872fff4640741284ee26f1585e05978e53e1fff5a89322e9b770bc29c697e9843157f9f797f37ed45f9992e333d780fb71ea992624c195d0e8dc008877a5adaa89d8aef5b6533c2481208a946a5b32f3c95e4e518fc1c2e76bbceee2ce18703ce38e86cc09bdfda8b90c0beb6a7ce0321f9f8acd27f93800cc79dfd671825974516554e68ed1953a80d9e1a51717f06e2392612843eb73783eb74d1db18ee8c56929ac41bec655957cccf68ab3810cfb099aea1a1d7e064afe0b248d60d8aca916bc5529555ad94af922481f535f60a060ec63b887b183378355a827dc0da8a87fef209dd79ad207c482423f2d45fd4e4e8019122afe9bf5e4fac379567c13f44c35061fbdab4939f429354f4841cb1f15ec30fd69b361596e1259edb9f506a80dcd5a17786f4eb8e35fc1556fc9fbdf18d9"
			}`,
		},
		{
			Tx: &types.DynamicFeeTx{
				ChainID:    config.ChainID,
				Nonce:      5,
				GasTipCap:  big.NewInt(6),
				GasFeeCap:  big.NewInt(9),
				Gas:        7,
				To:         nil,
				Value:      big.NewInt(8),
				Data:       []byte{0, 1, 2, 3, 4},
				AccessList: types.AccessList{},
				Signature:  []byte{},
				PublicKey:  []byte{},
			},
			Want: `{
					"blockHash": null,
					"blockNumber": null,
					"from": "0x20a1a68e6818a1142f85671db01ef7226debf822",
					"gas": "0x7",
					"gasPrice": "0x9",
					"maxFeePerGas": "0x9",
					"maxPriorityFeePerGas": "0x6",
					"hash": "0xf897dd01bb279e3500cac8aea4fad94b9957dee7131378edb4633c72a3a1298e",
					"input": "0x0001020304",
					"nonce": "0x5",
					"to": null,
					"transactionIndex": null,
					"value": "0x8",
					"type": "0x2",
					"accessList": [],
					"chainId": "0x539",
					"signature": "0xe2db84ff105e59d637d708ef9fb2109c29930e3a853686987fafd7aa37d4188977d7e815033918dbeee3b5b1a8fcf4119da8798b1733365ad1f5ec5a3312d24c0bd3275714d12761ea39c04feebbcd8a2dce71ceda7db9454774533d9bd24b31a60e1672a0d0e125e661897b056def4d7d083ffacf14731732c8ed59c4c47be478278db135b4eb234ddc5a97a5048d158ddf5eb5a396051cb3f26297e5ae6112028ef6bb1182ef266a0665f4bfba3dc47789356cfdeb9c0773d9d491c399af9762687c9c7fbd49d7b7ffe5a72836ce17729642446ee7e26fd99d748d7fce123e00d608a006906325cd558b3ae189677e79f03a012ff7c60116eabaaebea5c80937aa91034b11d61ba3a36f1c5e45db3aba775357cf651c888e605aad7b46b6d0c0630af7d6db316a66e73f4ff5a6bfe07c243c9a478c38575fed747d61326cd1189e2bc8e9d59e8954bf3f14469b10c239b62acd0bd43b4e7be55f19ec64021f8409ac5e9f533b091a48224c30a209ba5cfd0cf66a140655d69bbbd113327e6dec4f1414252dfe0ab0fd16793ea4fef4069ecd2a4e56ae33495f2e58487f2e1120130cc484c12edf9d548f86ce4fe405d8a550fd83e19065c8cb3c8909da05761d99e271a90007117b0b9a40f689f107bbe0018c64e7344d9f338243e957f84f476f2a2ce75a12ebd10ebe49502e2d13dd22a29d1643f3e43aa9ae6aad671c50f54c5d3f759c7fb766511dec76bf21a0301bf8ec3d59e0e94e3d2c9f640216e3f9514d15268dbe90b0ec31a0d31c0425af72e8e12115ef50160da916195d2a0898e966791a5522653d9b00ca5a4a0bfbfad411fce515e97ca83368a2a38ee06dbb2b9d086a39a178a7f8eb04d852b3536c79d442df766a4758456721c88bee9508bf44ac3bc25506ea9c86ece4c387f89afb75b7131bf0834cb66e32845a7f4a4d1d6484fd25397d250b21518ca68020712d88e7d812500216c36a2ea5c0e16c0c2aecf645a1db96be178a7cb74e0cd1be90e98c711f5a2e68854afbce260dc154aecb22498525ae3a55d8ac93ea592d08953d82cdfdfad1de2a1f0185381f0fc8561bd42fc5a833362426404d1cbb74d96f1310f4ef49a5f35e63f039e47adaf584fc7fe1b502bc350b32058a5c15792e7c0845a5d85fddf1e82239645f5012d4aeea9c100a1c1179338f3ff1ab0a4bd9b1eeb8fc0025c3ecec9640c808779ec153426c03c727e580616d7c13f08a1f39cb856ead7338d17ee52b88548979699b156b891af258755df33c166ca21e75eb9c2a5406b25b452edcc725543f93017a3167bfae333575d9245bf2eb4ddb9823e87834a7ab37be4e96770b39222a567133f22972a4b2d311fa86d6978fd1ecd94cb4d21cc24ed4dbd6b65da0c8bc0243fbc1a3de920d9c1bcc8ffcfacdf79239a21effcfaaffc16c786412211c9a8eacd490de67df527bbffd253e4be976e0795dabac28757572f0e3c305d70fecd5fc737859035f3ea03fa6d729b76f6d0fdee9119bb8b3708fa442e1a93fb83153ed7653211ad8ccce0ed574a80f99e4fafb5ae300edeb2d0a6f5ace4426f9b61b103734e34ae211f3667d24025cfbd9b84b188414ef4f9bc1d5e860154b1192dce325a038915f82ad55b5e912ea4db4aae9a90e580331395cf831d7e1b8c4bbb9ed93caf14af8608a19e8a86e68a6c2a20fc99d26662b45ea8571b110c62f72dae25757541356f25eed14247d6fd6a948bbbfd8249936413b23e027954c9976e5adf8733d286230c0b9e15bef25e6b75a8ed89d2301dbd5613158cc6c1a2f260758aa039c891fc39deee6a3856b61d325c72ba66f5f754a3ecb886739f5a8e73aa85ab2fd082047f73c212979f8d9bcecd29d8e3293a2426d9edab5386203da5026718575f86ae5c3cb2b34c1e09d0ac614efa545d2219dd0d3e9efe1273b8493ded3ab36935d21d33b3dbfe7988eaa1bfe35ccf8eff0599686a56662bf3053ca7636b8962db178d1bd915e992a372d792457d75c27f32b26f605a64b5fadfc459f2cda09f4869c38741a768e1959051416909341efb25678d45e61192e9c6e2fb811f98522c9e760b65a9c97ee70bd0ecc554395be0029c8f09f46aa01b23fe6b739a778b8a079ddb2564c06bf854c67ea79b3d95a5c8f5a2c738546a8442a5fb3777f33f372181f3aaa25927ba5dc8b417cc128b1cc12d2ed9e3c931ef33d9a867ee3b1e7833a99a079f37c8a2b6d9aa35fb80bcdb4064cb54c2618656c8a1cda0222d7bf31b1888dc860d689a8b52843783ca74147af00b1e84117e96a7c75e0f6073d750da5a1ad620c1ee82ee4cf27cb0ca94579472287a56747ff3dbb879c487f4b5433902d27def789e12ad4c388f4cb08650beaa32404ea0d35b4b13832ee6757273d533abd9ffc46710d9263446740b33408409f3d125d0b53731cb8cf8982631287ecb6e7f87b51008ed0bd9ed96f9403b399036bd4a01a9e62ee5f81f6254262e7010045d5a9f8e89610ce4b2d13438557598aeaf57056b35ce544d7d9f4f8beb7df08f7566147328a073830329fe4f602382756f85e0dfecb908621b4da02372c5d7f9ebb9a43d75e49222002a34cc7db960b077f205f860d7dd95f3e67492bc96d1d687367ecdbb5d55776878c04b215b64db1a36094fa89db247a69f33d5c66864de5e77e1cf07a60df1c9f1ed7fbcc81c1cc513ff85fea52616e358a882ecf3f406e285436a2b0a3e44f28a214bdcaaa0d2dc1626e855687480a3110b84f48eecae59e51a094381f7adc4fbac1b37d57a97167aac1e0e63d844d2ef7ebe6e2cdf40cfc2f2ef0fef671627b1df6042258c02a73d993dca48478a65131844aaddeba8672b6c807ad18db5ff1fe44eb845e15f5a11ce4f5c3149e4855d8a3999ee8ad47a83f3f563514b4b9d75b428c75e4ae5992b001a2dd41d44e93f4996f60f8a3327d2bd58dded1f4a5c30f95f14d308ec6e1b540c444d17aa7d1f24410b9e3c5287c22a2281313acf5ab57455211196fb46750c138f5419237d757dea4518afbd41a2bc840aa88b2d33810ef255aec101807f8ad1db9018aba58c03e876bba6cc599d2f3b02fc1ac198f27b75339c375724063c7878fc96526a14aeafb9d14cd21fc7134bb823491c9a01e7c56a87d034ef958e7e94ef6398ef8250046e25895b65efcdd0c15f66af86333dde91689c182bbbf4b984181024d67650f8bf44cee98aa70d09ff321a1aeb46f807b555b7010e997c1a7b57eb826e152d6b36a087a6edba3bb293e7ec00655268f515962c1afd59b852bdbcbc89b2c08a1f7fe4cd9c2d7331a2099e452bdb8c13da73bfbd8210840c6a2257708292ef1dca613f88dee0c0857365b85f2f2c3b37fad569c4c75c72b05b6d5bee4054fb105562a58a043c1f880785395dcd791cae40da23d6e934e9f8877a6a8f9fed60c7dc1704d248a5d64873f83bc7d2aab09557d9648af19c6b313899632343c6e23474e28ea6266d8f7e461f115db6759abc8fe4562b9ab6c5aa664004740c9731159d8f764abdc6ee0ccb469a6da3732acab0aa014353e036edde9314127d83c92641a8ed15c9a05b13c299ecac90084f94766e3c8b19237b24724322629bc01b2e0f3fd4ea68158a67f5b8033188e4a69c36cefa89431b7df8aa227729015dd2fd6248883888ea637ab9aaa39c64437c7f267bc0174397b2fa6a513ef8a9f7f21a42fef327eb1739d438872e6b48740c08fde87e1a5b4ad12262ff4132d3d6db8670bb3b7c8969ea44ec27d12c36fcef3e9083fb51055aef8338412ef1e87b8794a70db4e9e0b428f022b97d33861b7f47e414ac00ac2032df86b5b732138918ca9a492a2b6ca8a4b161aa8968f897239f1528bbc167ecc5b68145398aa662a2fd9b9e33af08c7642ee314217e003d4285e909327d4d0e2ca8645e80e793dccd5f4ac9c2fe97029ccccad4f2b12729cebe21a3595e81c238523f2d51a354838c7f0e973a7e66028c5e880e220589c7be99b4fb2d9b26bc81e39fedb1378bd7a838a28e97a164a7b64c43eb75f68186b966166abf3b79a184286b817e8342eb5ded4efa037b536a91e9f5d7e87ef259d97efd4ef890d7f109b55dd25c1280284578584c60ecb70490b846d1e524a18ee61ab89d798e9a9c06589e2dcd0678194d8c87edc2b62dc4735383eb689281673a0c667b01005201bbf10620604874a1c4c3facf8004e067fd3d10b34f6e30eb59bbabefa687bc12397252d5f31a3533a1620245528fd496246ea1ab93b5aa2fc42adea69f8873d32ac8b869260570fae413325a017c3703af6ab3a30d38086eb9c9d8cd3cf8d5956e965f8a76ff59f1b3f0d3ee5b4da2d4401ebdc6db7684008ce1a470c426b45d897f0643037878275ba9175cf9b794b1c98b70c19625d3947c0bb9ff421e46cb162d9cd034e3459ab936e44482a8d7bd8e453499ffc223490d0b1f462de2220d3bbc44ec3903e3bf06e89bfceacc08a7149d7f1591c2a95aba44ee34832e1d358b4ef58289b72e6e49f0ffe09260b5666933c8d7464d2249a23eab5bce1e9da924254a3bb6c513c2f854909ab44d1b61d93b01c4fd1d1aff38af5789599f8b682753b44dfc5e8150b09d8acb26cd25f47810fef3918d2b0c6ae8b619e518e5b3b7acec5d9d82b518b96c1bd6495756ef0ec4eb358b109c45d7a5acf7098c1ac6f585a9a7cf096f262ddf0f9f572f19f76f3d9f805a69ce2b3bc7962a7209f1fc2c75733237fd76fa58f6c15cf4aaef4392f89a986e49c4b610a37190a086dfd7bb76e3fda12c888adb18ca381038722c910b6e885af11825e452e0c2fb6612b9d979f402a7839060ed78c635997e695812828509a36f93b3020b3600f7ed40fd050db7bc55127c7186e6104e6868ce89a5f5cdf24e23ae0e2e54a8b425fe4cf235636a0e7b7bceb9db337009031c466212ad4af18331a42c86d1deb373910582672d5f62df6e44b1edacad345683433057583b203a6d570ffd426633682e9602648e518f229b23ded6020bb41f800ce27dbb347b950bd7cadcc2815d7cd2af36ed987b68c0c8b930a279a674340280662c5d265c4a432264fe47acd1b2a7e68e66482c2d3f6e45ed7220a890f6facaa3470572322b73d32fdbcbb3f12b166e5d02d41346da109336d5abd107764dc80a252f037b940d68de847255ca72b976b02c47f33a9452b6385b1c910650bcc5509f1140f9c5d6bd42d8c0b2635ce42bfc887d327a5e781f3fbdf41d779061e25b94ed9464a8fc96062f5ff7812c34ffa358a8d7f462a03c7013ffc951a0bc69a86b84f73728b8996f3548ff532a4e60a3c45416c6fbdc357c8e5b937b1fcea9bb9dcf8da9abdeff7d9cca73d75127f9f634e3c5cd549a960494986da46dfbec80cf2a728c250fefaffc82d09b0184a419f6247be97192417f29b9c828deac2592fb142a9ef0da8b4486d586b2704a0f39d913d0848b612e60f39cb4439a6a912fca0b2ef55fa289164bfd1947291f3397b93237de91d9cb28959b281e6f643fc9ab1a45de823b45a42d683221bf61544bac48c56f980aa11cff50a3a3ba54c425cd08d0644646a47f571193672a78ed9f7c607cd59f536de356dad4fed962dade4d0e4ef2a73ec8c9626babdf8e7a6012742b6d639bbd9dad33a872eeb1585912b48cd96624d7612ceef5394a5ae8562bbf760d3a6691ac67a6b3a57e7174a3f8df70e62282734bfd7598c3333183f16ddc026b7c1ac86b9dcd022cea59b44e4d7f4a0988acf0afadcd9c4df854cf8ba8d35618b84582d6973fcdbb6a8ec71c25ecef62d0120deb0dc6acd6eca3c8b16629687880cb55cd19d6756591377200f3c9e324e1a040bde4c3a1fca12a6983c9f1bd9ca115ecf28a02393a748bdd1567111701784e34ee5da7c70c90633adee2dd50d05324961e07aeebd723d6821b6f2a7cad85c1fea3645c6ac0a12e1cf693f03a159e94e703111f93d4253b11300e85addb6292b8168a3387ab4f7d54b96a2a17ba12d93ddc4cd01c7e27a57316c63b029fb32de4fcff29bd6e18709a95287a62920ae454893fe83e24e1364edace77da16d97f3ab7414f10db4d83d44369296f07ebda53c2d8056ac62c39de89b60f0d0594a5ef1a3681281d87c21a4b571db996df5fef484e20dcea89cd2b786a491f0efa41a2dfa6f2ab5ca94507726847a6d45e5d5cc12db09f96fb514b5eacc17c98dc1ef5c409058ccd9026239f560c5c4b98883201a704178d3602960e51a0eb92cec9f7119de37d7e7b2a4c1347d7452fef491d37bde94aef4dbd6b290933855aef553c46524162555f901d08a853951223cac506eb3577a477e46320fd3b4fc40d76c8dd0d4c7a7fcbd844cf1759cdd32834fce07253c516a859da3afb8c603d8e019911b1f2a32898cd94552781351526b99b9d301103d787d89a7a9bae600000000000000000000000000000000000000000000000000000000000000000b0e1017191a212b",
					"publicKey": "0x01727d783cc48b50060e8d3cf86eb8f37a5fe0dd49beb6c79e77aa4243aed4acdc5bed459f9ce1aaee191558c4791a698778f22ae0b670dbc963f9dff974c5c4c7bdf86504364cd48ecbd37c990758e92abc82f9ab42eefac09b5c307064540751421eff33e436f05f59c0a43a3c1b93442fb8b75bc4ca7156310162c935c50dfea28b8f8cb3409edb3a3b8242ddc9320f97e2e9f3d50f4428d791d7969e412ba10a2b22c6229395dd86f86261104f3cf37617d370d28f484b2605828f03b017d898baf4b4631212baef96e81c017dab349d8189a70f07bfe86240d5f5a33802ca794072aef09b4171b153af2b33a8b375a113438d271cb0fe625d76e8fcca390dcbb924abf7ac9bc5e6ea6ec38cc7b4fb38ac22ded5d9280260c53f87186e8a1f44eeca54fd915015daeaa57fa3493130dbc0e3b664df05bce6cfbe8c10c1a7b7963ec5d9f6e044995050bc169b62de61e37e91eb83e0f21aa11018edd4f2587b2c907e1f99fc93a30935a9a16c828e778acb8d04e70e6a4cf248a1f23088fcde603ae156e538c1f2cc07e959f1a0d5d8771ee207284edc9e5f34785f708a9f1395cdbbd17fdfaa0792d9ffa1af4dec2907b603698bc71621df7e34c6adf001951252b97d69590d7cbf7a102734aca33b3a337ce3deec222f2b8b61c45ad189a75dd30746ec7c9700fccf361b94b23564c974bd024b89a52d3f225d0b562e4500b51e0c447caeff5eb760d781c416aabf702c079baad87fdb18c61d50cc8827e407fe088a8da4575a92e13093d24c63ff37ac70bb2a6be9631891b0dd570a7fbb73bb66d489058ac89c46db31576a38dbe2a206a31f48751b45e1bf7934fd8fc2d242273aa1261ca679a6ce693a458a5a33d47d8b7a8aa61f62060424bcf911f147206c475842c16dd801e4ac32a8223215ad3a4e59deb4df0597a612c330af5a787f05327cc5cac9e8a9d151adfb0413b5a68f124d9f1cbe753137061f5beb8ec2b9be66ea23076f2d6da6624a983f76ad92235315a3883c2a321b013586c055941514d3a6d448ff1d6cef057e4ca26b944d44086f4df7970371464c56151221cb808f0e00818cd0ffa916b78e696132ccc71a795949a39f2a5a6acff20998c085e640c901f251998d15d6cb7092dc48e69284e4836e634db47664f926697055252be841a5a79603f8a2a419650a6f1ad7c6bdb11a391bdea76f4f68be08922f5ef08bff8c0d02d5aded7907642cc6cca4fd594f0fe4700efd15827ae2f4a9c7f8f629498f1992e4cb575ed9bedb1927bd57bde751624a34c8438892ac114cbe1aac962cf4fe199d2ff2a23cb1f8c3a3e6d78a8b44b66d8f25c3702bebbfb1974698ac701d263561a32cec56574e1eb9f289fac40fa441296d79ae4f0f51c8e9a50d7acc1779b5a47a806c692a1c49e99fafb63d2149eeb175aa7ef584cbb5504211fbe6585e30ba0edbb717decc3494ee984d5f3e56089f14ce7222c6573833377881a861fd763e4fb667c9e76c860ffdee0771465f5a37aad543e3fa5f024996dba344f6a1c24b245a45adc6a18ac4dd08bb0307910724007e344ad302b534dcf7dd2ac3966bd3668486ba361ac1390155c0e1334d3a79c631f889bb26dda72449129d4441e795f2c124cde229d4daf79bc9f15c562fc0f6faa47f6b757cf4c7d0d6271c1e47f3d01ac02938eef495ca61e051617f32693a17abacf604722025f72660979716407f15d56a71b1427019b2b8897a7991f6d9bead653b537670bf4c5e7bc54b8745b533ab4bb96b588bdeb2b4f713f25477688737dde64107d82feabc00a2689f27b1b58161b6281d9edd647b8d23e9442f2123c93365f6805cf903b8a802a2de6d5622407cb9d88512fcc9ba9f18c90cfaa80e1e9f985e9849c8b91d9cdc1f862135f6583aed4f5471124408a89081c0e14789ce8f2444dee55f789387e6e48e6212fd271a1e3a55de0c1e122c8772dc32d1ca77284eb4649e86ae6e5569a4cf840166970a21d79c50a8fc9b2d1c144ee79885ffdbc22737b03a110b3522ea5c26ae99f950aec20411cd1c2466df4d90c3ffe2ed9116b6c23a63299f6d7bbcf2a37368765d170297d900ca346fa60f0e6a3fccf2a01548219982c5e49444771e64619089da4c6263df7ac2693d9037800f68607a34d7eeb489b1a93030488d7cd407f4f2ab561701d884d7eeea39f79cf2f25c4da089f34ea3f3dc15da1bc43da8e7c12d1e0c05b107f10da1ea5a684331f2ecb696734b47407dc51a15ab9c9b98f31a42cb2e771696ab39378bbcfec21021bc42ffb1488920229589505bb6fc771edddb1818a081a5b8fc90eefba70091ea3fed3fe81f95f721570662eed03cfd759fb064e2401e634072557f025cce8affff8c062381b5e0291fb016292b5403848b419037d9bb6190045eb19454c2ea2debec95eb9d7f76f9546c922f96d1a04c537594ef5d26b226821a3527cebd56ac950c54e7fa0557e017e9a5974ae7defbe1fb3ba3037f89d12ea7f85253ef885af0da7b1e60a8637d1197b795a9d663723b94f1806b2938b5da325877d7b85ec544bbf311f75cb7e17999518cb473a5cb7875ba4e59a904cc09992313ee3f44890498af5443d983a4ad2669fee3c47d592e788c56419b1e93bdaa5434ce895506adde41e75f89dce82e6fc78cf0b85850808037c172d5a44848525d1f06cc7f3610adf434ae21c1313c438eaf9b0cd4d18d4f402279a7db469080ee807630b0388046551ca3476914e3a2a2abc0b7fc211fc17a48c0b42800406738dce93b19a64dcc3cb93435ec117462ddcfd396daf99acd0bf2037a21fce0a46dbbfd974121669287f409a778b538f862eade58da183e9bd37c763a16f56b15d8d0c8ab6326189ca7116c587b87659ae82be17639362ecaa78f7ad346ae82a8f85bdf0ddc38054b9239ce975ee723ffc854ae4d028c20dae5d7cbd1b110dd749049c89878f797a20fc15ea9f6839c130253d4fa6d506fecd3605a8dfa35b13ff61e2f9d865224df588cf8d51d00341b8c607b64158903c171d76e7b303d0d1349374f6f06f080db74f55ecbbf8a038cc209bc4d86d63d9c8b7309a423b29048abdfb8849196bdea7a2a55a9b6f3c4e8019cc80bde6e6ddff2bac293c50f4f739a21331495b960a242d2d126832283f09a9d0ef145ca9cd5b513c7d72e2670717709e169e03d4d618ba6c319ac03a4c65cf7cdd050745f0ce0f7872fff4640741284ee26f1585e05978e53e1fff5a89322e9b770bc29c697e9843157f9f797f37ed45f9992e333d780fb71ea992624c195d0e8dc008877a5adaa89d8aef5b6533c2481208a946a5b32f3c95e4e518fc1c2e76bbceee2ce18703ce38e86cc09bdfda8b90c0beb6a7ce0321f9f8acd27f93800cc79dfd671825974516554e68ed1953a80d9e1a51717f06e2392612843eb73783eb74d1db18ee8c56929ac41bec655957cccf68ab3810cfb099aea1a1d7e064afe0b248d60d8aca916bc5529555ad94af922481f535f60a060ec63b887b183378355a827dc0da8a87fef209dd79ad207c482423f2d45fd4e4e8019122afe9bf5e4fac379567c13f44c35061fbdab4939f429354f4841cb1f15ec30fd69b361596e1259edb9f506a80dcd5a17786f4eb8e35fc1556fc9fbdf18d9"
				}`,
		},
	}
}

type testBackend struct {
	db      zonddb.Database
	chain   *core.BlockChain
	pending *types.Block
}

func newTestBackend(t *testing.T, n int, gspec *core.Genesis, engine consensus.Engine, generator func(i int, b *core.BlockGen)) *testBackend {
	var (
		cacheConfig = &core.CacheConfig{
			TrieCleanLimit:    256,
			TrieDirtyLimit:    256,
			TrieTimeLimit:     5 * time.Minute,
			SnapshotLimit:     0,
			TrieDirtyDisabled: true, // Archive mode
		}
	)
	// Generate blocks for testing
	db, blocks, _ := core.GenerateChainWithGenesis(gspec, engine, n, generator)
	txlookupLimit := uint64(0)
	chain, err := core.NewBlockChain(db, cacheConfig, gspec, engine, vm.Config{}, nil, &txlookupLimit)
	if err != nil {
		t.Fatalf("failed to create tester chain: %v", err)
	}
	if n, err := chain.InsertChain(blocks); err != nil {
		t.Fatalf("block %d: failed to insert into chain: %v", n, err)
	}

	backend := &testBackend{db: db, chain: chain}
	return backend
}

func (b *testBackend) setPendingBlock(block *types.Block) {
	b.pending = block
}

func (b testBackend) SyncProgress() zond.SyncProgress { return zond.SyncProgress{} }
func (b testBackend) SuggestGasTipCap(ctx context.Context) (*big.Int, error) {
	return big.NewInt(0), nil
}
func (b testBackend) FeeHistory(ctx context.Context, blockCount uint64, lastBlock rpc.BlockNumber, rewardPercentiles []float64) (*big.Int, [][]*big.Int, []*big.Int, []float64, error) {
	return nil, nil, nil, nil, nil
}
func (b testBackend) ChainDb() zonddb.Database          { return b.db }
func (b testBackend) AccountManager() *accounts.Manager { return nil }
func (b testBackend) ExtRPCEnabled() bool               { return false }
func (b testBackend) RPCGasCap() uint64                 { return 10000000 }
func (b testBackend) RPCEVMTimeout() time.Duration      { return time.Second }
func (b testBackend) RPCTxFeeCap() float64              { return 0 }
func (b testBackend) SetHead(number uint64)             {}
func (b testBackend) HeaderByNumber(ctx context.Context, number rpc.BlockNumber) (*types.Header, error) {
	if number == rpc.LatestBlockNumber {
		return b.chain.CurrentBlock(), nil
	}
	if number == rpc.PendingBlockNumber && b.pending != nil {
		return b.pending.Header(), nil
	}
	return b.chain.GetHeaderByNumber(uint64(number)), nil
}
func (b testBackend) HeaderByHash(ctx context.Context, hash common.Hash) (*types.Header, error) {
	return b.chain.GetHeaderByHash(hash), nil
}
func (b testBackend) HeaderByNumberOrHash(ctx context.Context, blockNrOrHash rpc.BlockNumberOrHash) (*types.Header, error) {
	if blockNr, ok := blockNrOrHash.Number(); ok {
		return b.HeaderByNumber(ctx, blockNr)
	}
	if blockHash, ok := blockNrOrHash.Hash(); ok {
		return b.HeaderByHash(ctx, blockHash)
	}
	panic("unknown type rpc.BlockNumberOrHash")
}
func (b testBackend) CurrentHeader() *types.Header { return b.chain.CurrentBlock() }
func (b testBackend) CurrentBlock() *types.Header  { return b.chain.CurrentBlock() }
func (b testBackend) BlockByNumber(ctx context.Context, number rpc.BlockNumber) (*types.Block, error) {
	if number == rpc.LatestBlockNumber {
		head := b.chain.CurrentBlock()
		return b.chain.GetBlock(head.Hash(), head.Number.Uint64()), nil
	}
	if number == rpc.PendingBlockNumber {
		return b.pending, nil
	}
	return b.chain.GetBlockByNumber(uint64(number)), nil
}
func (b testBackend) BlockByHash(ctx context.Context, hash common.Hash) (*types.Block, error) {
	return b.chain.GetBlockByHash(hash), nil
}
func (b testBackend) BlockByNumberOrHash(ctx context.Context, blockNrOrHash rpc.BlockNumberOrHash) (*types.Block, error) {
	if blockNr, ok := blockNrOrHash.Number(); ok {
		return b.BlockByNumber(ctx, blockNr)
	}
	if blockHash, ok := blockNrOrHash.Hash(); ok {
		return b.BlockByHash(ctx, blockHash)
	}
	panic("unknown type rpc.BlockNumberOrHash")
}
func (b testBackend) GetBody(ctx context.Context, hash common.Hash, number rpc.BlockNumber) (*types.Body, error) {
	return b.chain.GetBlock(hash, uint64(number.Int64())).Body(), nil
}
func (b testBackend) StateAndHeaderByNumber(ctx context.Context, number rpc.BlockNumber) (*state.StateDB, *types.Header, error) {
	if number == rpc.PendingBlockNumber {
		panic("pending state not implemented")
	}
	header, err := b.HeaderByNumber(ctx, number)
	if err != nil {
		return nil, nil, err
	}
	if header == nil {
		return nil, nil, errors.New("header not found")
	}
	stateDb, err := b.chain.StateAt(header.Root)
	return stateDb, header, err
}
func (b testBackend) StateAndHeaderByNumberOrHash(ctx context.Context, blockNrOrHash rpc.BlockNumberOrHash) (*state.StateDB, *types.Header, error) {
	if blockNr, ok := blockNrOrHash.Number(); ok {
		return b.StateAndHeaderByNumber(ctx, blockNr)
	}
	panic("only implemented for number")
}
func (b testBackend) Pending() (*types.Block, types.Receipts, *state.StateDB) { panic("implement me") }
func (b testBackend) GetReceipts(ctx context.Context, hash common.Hash) (types.Receipts, error) {
	header, err := b.HeaderByHash(ctx, hash)
	if header == nil || err != nil {
		return nil, err
	}
	receipts := rawdb.ReadReceipts(b.db, hash, header.Number.Uint64(), header.Time, b.chain.Config())
	return receipts, nil
}

func (b testBackend) GetEVM(ctx context.Context, msg *core.Message, state *state.StateDB, header *types.Header, vmConfig *vm.Config, blockContext *vm.BlockContext) (*vm.EVM, func() error) {
	vmError := func() error { return nil }
	if vmConfig == nil {
		vmConfig = b.chain.GetVMConfig()
	}
	txContext := core.NewEVMTxContext(msg)
	context := core.NewEVMBlockContext(header, b.chain, nil)
	if blockContext != nil {
		context = *blockContext
	}
	return vm.NewEVM(context, txContext, state, b.chain.Config(), *vmConfig), vmError
}
func (b testBackend) SubscribeChainEvent(ch chan<- core.ChainEvent) event.Subscription {
	panic("implement me")
}
func (b testBackend) SubscribeChainHeadEvent(ch chan<- core.ChainHeadEvent) event.Subscription {
	panic("implement me")
}
func (b testBackend) SubscribeChainSideEvent(ch chan<- core.ChainSideEvent) event.Subscription {
	panic("implement me")
}
func (b testBackend) SendTx(ctx context.Context, signedTx *types.Transaction) error {
	panic("implement me")
}
func (b testBackend) GetTransaction(ctx context.Context, txHash common.Hash) (*types.Transaction, common.Hash, uint64, uint64, error) {
	tx, blockHash, blockNumber, index := rawdb.ReadTransaction(b.db, txHash)
	return tx, blockHash, blockNumber, index, nil
}
func (b testBackend) GetPoolTransactions() (types.Transactions, error)         { panic("implement me") }
func (b testBackend) GetPoolTransaction(txHash common.Hash) *types.Transaction { panic("implement me") }
func (b testBackend) GetPoolNonce(ctx context.Context, addr common.Address) (uint64, error) {
	panic("implement me")
}
func (b testBackend) Stats() (pending int, queued int) { panic("implement me") }
func (b testBackend) TxPoolContent() (map[common.Address][]*types.Transaction, map[common.Address][]*types.Transaction) {
	panic("implement me")
}
func (b testBackend) TxPoolContentFrom(addr common.Address) ([]*types.Transaction, []*types.Transaction) {
	panic("implement me")
}
func (b testBackend) SubscribeNewTxsEvent(events chan<- core.NewTxsEvent) event.Subscription {
	panic("implement me")
}
func (b testBackend) ChainConfig() *params.ChainConfig { return b.chain.Config() }
func (b testBackend) Engine() consensus.Engine         { return b.chain.Engine() }
func (b testBackend) GetLogs(ctx context.Context, blockHash common.Hash, number uint64) ([][]*types.Log, error) {
	panic("implement me")
}
func (b testBackend) SubscribeRemovedLogsEvent(ch chan<- core.RemovedLogsEvent) event.Subscription {
	panic("implement me")
}
func (b testBackend) SubscribeLogsEvent(ch chan<- []*types.Log) event.Subscription {
	panic("implement me")
}
func (b testBackend) SubscribePendingLogsEvent(ch chan<- []*types.Log) event.Subscription {
	panic("implement me")
}
func (b testBackend) BloomStatus() (uint64, uint64) { panic("implement me") }
func (b testBackend) ServiceFilter(ctx context.Context, session *bloombits.MatcherSession) {
	panic("implement me")
}

func TestEstimateGas(t *testing.T) {
	t.Parallel()
	// Initialize test accounts
	var (
		accounts = newAccounts(2)
		genesis  = &core.Genesis{
			Config: params.TestChainConfig,
			Alloc: core.GenesisAlloc{
				accounts[0].addr: {Balance: big.NewInt(params.Ether)},
				accounts[1].addr: {Balance: big.NewInt(params.Ether)},
			},
		}
		genBlocks      = 10
		signer         = types.ShanghaiSigner{ChainId: big.NewInt(1)}
		randomAccounts = newAccounts(2)
	)
	api := NewBlockChainAPI(newTestBackend(t, genBlocks, genesis, beacon.NewFaker(), func(i int, b *core.BlockGen) {
		// Transfer from account[0] to account[1]
		//    value: 1000 wei
		//    fee:   0 wei
		tx, _ := types.SignTx(types.NewTx(&types.DynamicFeeTx{Nonce: uint64(i), To: &accounts[1].addr, Value: big.NewInt(1000), Gas: params.TxGas, GasFeeCap: b.BaseFee(), Data: nil}), signer, accounts[0].key)
		b.AddTx(tx)
	}))
	var testSuite = []struct {
		blockNumber rpc.BlockNumber
		call        TransactionArgs
		overrides   StateOverride
		expectErr   error
		want        uint64
	}{
		// simple transfer on latest block
		{
			blockNumber: rpc.LatestBlockNumber,
			call: TransactionArgs{
				From:  &accounts[0].addr,
				To:    &accounts[1].addr,
				Value: (*hexutil.Big)(big.NewInt(1000)),
			},
			expectErr: nil,
			want:      21000,
		},
		// simple transfer with insufficient funds on latest block
		{
			blockNumber: rpc.LatestBlockNumber,
			call: TransactionArgs{
				From:  &randomAccounts[0].addr,
				To:    &accounts[1].addr,
				Value: (*hexutil.Big)(big.NewInt(1000)),
			},
			expectErr: core.ErrInsufficientFunds,
			want:      21000,
		},
		// empty create
		{
			blockNumber: rpc.LatestBlockNumber,
			call:        TransactionArgs{},
			expectErr:   nil,
			want:        53000,
		},
		{
			blockNumber: rpc.LatestBlockNumber,
			call:        TransactionArgs{},
			overrides: StateOverride{
				randomAccounts[0].addr: OverrideAccount{Balance: newRPCBalance(new(big.Int).Mul(big.NewInt(1), big.NewInt(params.Ether)))},
			},
			expectErr: nil,
			want:      53000,
		},
		{
			blockNumber: rpc.LatestBlockNumber,
			call: TransactionArgs{
				From:  &randomAccounts[0].addr,
				To:    &randomAccounts[1].addr,
				Value: (*hexutil.Big)(big.NewInt(1000)),
			},
			overrides: StateOverride{
				randomAccounts[0].addr: OverrideAccount{Balance: newRPCBalance(big.NewInt(0))},
			},
			expectErr: core.ErrInsufficientFunds,
		},
	}
	for i, tc := range testSuite {
		result, err := api.EstimateGas(context.Background(), tc.call, &rpc.BlockNumberOrHash{BlockNumber: &tc.blockNumber}, &tc.overrides)
		if tc.expectErr != nil {
			if err == nil {
				t.Errorf("test %d: want error %v, have nothing", i, tc.expectErr)
				continue
			}
			if !errors.Is(err, tc.expectErr) {
				t.Errorf("test %d: error mismatch, want %v, have %v", i, tc.expectErr, err)
			}
			continue
		}
		if err != nil {
			t.Errorf("test %d: want no error, have %v", i, err)
			continue
		}
		if uint64(result) != tc.want {
			t.Errorf("test %d, result mismatch, have\n%v\n, want\n%v\n", i, uint64(result), tc.want)
		}
	}
}

func TestCall(t *testing.T) {
	t.Parallel()
	// Initialize test accounts
	var (
		accounts = newAccounts(3)
		genesis  = &core.Genesis{
			Config: params.TestChainConfig,
			Alloc: core.GenesisAlloc{
				accounts[0].addr: {Balance: big.NewInt(params.Ether)},
				accounts[1].addr: {Balance: big.NewInt(params.Ether)},
				accounts[2].addr: {Balance: big.NewInt(params.Ether)},
			},
		}
		genBlocks = 10
		signer    = types.ShanghaiSigner{ChainId: big.NewInt(1)}
	)
	api := NewBlockChainAPI(newTestBackend(t, genBlocks, genesis, beacon.NewFaker(), func(i int, b *core.BlockGen) {
		// Transfer from account[0] to account[1]
		//    value: 1000 wei
		//    fee:   0 wei
		tx, _ := types.SignTx(types.NewTx(&types.DynamicFeeTx{Nonce: uint64(i), To: &accounts[1].addr, Value: big.NewInt(1000), Gas: params.TxGas, GasFeeCap: b.BaseFee(), Data: nil}), signer, accounts[0].key)
		b.AddTx(tx)
	}))
	randomAccounts := newAccounts(3)
	var testSuite = []struct {
		blockNumber    rpc.BlockNumber
		overrides      StateOverride
		call           TransactionArgs
		blockOverrides BlockOverrides
		expectErr      error
		want           string
	}{
		// transfer on genesis
		{
			blockNumber: rpc.BlockNumber(0),
			call: TransactionArgs{
				From:  &accounts[0].addr,
				To:    &accounts[1].addr,
				Value: (*hexutil.Big)(big.NewInt(1000)),
			},
			expectErr: nil,
			want:      "0x",
		},
		// transfer on the head
		{
			blockNumber: rpc.BlockNumber(genBlocks),
			call: TransactionArgs{
				From:  &accounts[0].addr,
				To:    &accounts[1].addr,
				Value: (*hexutil.Big)(big.NewInt(1000)),
			},
			expectErr: nil,
			want:      "0x",
		},
		// transfer on a non-existent block, error expects
		{
			blockNumber: rpc.BlockNumber(genBlocks + 1),
			call: TransactionArgs{
				From:  &accounts[0].addr,
				To:    &accounts[1].addr,
				Value: (*hexutil.Big)(big.NewInt(1000)),
			},
			expectErr: errors.New("header not found"),
		},
		// transfer on the latest block
		{
			blockNumber: rpc.LatestBlockNumber,
			call: TransactionArgs{
				From:  &accounts[0].addr,
				To:    &accounts[1].addr,
				Value: (*hexutil.Big)(big.NewInt(1000)),
			},
			expectErr: nil,
			want:      "0x",
		},
		// Call which can only succeed if state is state overridden
		{
			blockNumber: rpc.LatestBlockNumber,
			call: TransactionArgs{
				From:  &randomAccounts[0].addr,
				To:    &randomAccounts[1].addr,
				Value: (*hexutil.Big)(big.NewInt(1000)),
			},
			overrides: StateOverride{
				randomAccounts[0].addr: OverrideAccount{Balance: newRPCBalance(new(big.Int).Mul(big.NewInt(1), big.NewInt(params.Ether)))},
			},
			want: "0x",
		},
		// Invalid call without state overriding
		{
			blockNumber: rpc.LatestBlockNumber,
			call: TransactionArgs{
				From:  &randomAccounts[0].addr,
				To:    &randomAccounts[1].addr,
				Value: (*hexutil.Big)(big.NewInt(1000)),
			},
			expectErr: core.ErrInsufficientFunds,
		},
		// Successful simple contract call
		//
		// // SPDX-License-Identifier: GPL-3.0
		//
		//  pragma solidity >=0.7.0 <0.8.0;
		//
		//  /**
		//   * @title Storage
		//   * @dev Store & retrieve value in a variable
		//   */
		//  contract Storage {
		//      uint256 public number;
		//      constructor() {
		//          number = block.number;
		//      }
		//  }
		{
			blockNumber: rpc.LatestBlockNumber,
			call: TransactionArgs{
				From: &randomAccounts[0].addr,
				To:   &randomAccounts[2].addr,
				Data: hex2Bytes("8381f58a"), // call number()
			},
			overrides: StateOverride{
				randomAccounts[2].addr: OverrideAccount{
					Code:      hex2Bytes("6080604052348015600f57600080fd5b506004361060285760003560e01c80638381f58a14602d575b600080fd5b60336049565b6040518082815260200191505060405180910390f35b6000548156fea2646970667358221220eab35ffa6ab2adfe380772a48b8ba78e82a1b820a18fcb6f59aa4efb20a5f60064736f6c63430007040033"),
					StateDiff: &map[common.Hash]common.Hash{{}: common.BigToHash(big.NewInt(123))},
				},
			},
			want: "0x000000000000000000000000000000000000000000000000000000000000007b",
		},
		// Block overrides should work
		{
			blockNumber: rpc.LatestBlockNumber,
			call: TransactionArgs{
				From: &accounts[1].addr,
				Input: &hexutil.Bytes{
					0x43,             // NUMBER
					0x60, 0x00, 0x52, // MSTORE offset 0
					0x60, 0x20, 0x60, 0x00, 0xf3,
				},
			},
			blockOverrides: BlockOverrides{Number: (*hexutil.Big)(big.NewInt(11))},
			want:           "0x000000000000000000000000000000000000000000000000000000000000000b",
		},
	}
	for i, tc := range testSuite {
		result, err := api.Call(context.Background(), tc.call, rpc.BlockNumberOrHash{BlockNumber: &tc.blockNumber}, &tc.overrides, &tc.blockOverrides)
		if tc.expectErr != nil {
			if err == nil {
				t.Errorf("test %d: want error %v, have nothing", i, tc.expectErr)
				continue
			}
			if !errors.Is(err, tc.expectErr) {
				// Second try
				if !reflect.DeepEqual(err, tc.expectErr) {
					t.Errorf("test %d: error mismatch, want %v, have %v", i, tc.expectErr, err)
				}
			}
			continue
		}
		if err != nil {
			t.Errorf("test %d: want no error, have %v", i, err)
			continue
		}
		if !reflect.DeepEqual(result.String(), tc.want) {
			t.Errorf("test %d, result mismatch, have\n%v\n, want\n%v\n", i, result.String(), tc.want)
		}
	}
}

type Account struct {
	key  *dilithium.Dilithium
	addr common.Address
}

func newAccounts(n int) (accounts []Account) {
	for i := 0; i < n; i++ {
		key, _ := crypto.GenerateDilithiumKey()
		addr := key.GetAddress()
		accounts = append(accounts, Account{key: key, addr: addr})
	}
	slices.SortFunc(accounts, func(a, b Account) int { return a.addr.Cmp(b.addr) })
	return accounts
}

func newRPCBalance(balance *big.Int) **hexutil.Big {
	rpcBalance := (*hexutil.Big)(balance)
	return &rpcBalance
}

func hex2Bytes(str string) *hexutil.Bytes {
	rpcBytes := hexutil.Bytes(common.Hex2Bytes(str))
	return &rpcBytes
}

func TestRPCMarshalBlock(t *testing.T) {
	t.Parallel()
	var (
		txs []*types.Transaction
		to  = common.BytesToAddress([]byte{0x11})
	)
	for i := uint64(1); i <= 4; i++ {
		var tx *types.Transaction
		if i%2 == 0 {
			tx = types.NewTx(&types.DynamicFeeTx{
				Nonce:     i,
				GasFeeCap: big.NewInt(11111),
				Gas:       1111,
				To:        &to,
				Value:     big.NewInt(111),
				Data:      []byte{0x11, 0x11, 0x11},
			})
			// TODO(rgeraldes24): legacy tx
			/*
				tx = types.NewTx(&types.LegacyTx{
					Nonce:    i,
					GasPrice: big.NewInt(11111),
					Gas:      1111,
					To:       &to,
					Value:    big.NewInt(111),
					Data:     []byte{0x11, 0x11, 0x11},
				})
			*/
		} else {
			// TODO(rgeraldes24)
			/*
				tx = types.NewTx(&types.AccessListTx{
					ChainID:  big.NewInt(1337),
					Nonce:    i,
					GasPrice: big.NewInt(11111),
					Gas:      1111,
					To:       &to,
					Value:    big.NewInt(111),
					Data:     []byte{0x11, 0x11, 0x11},
				})
			*/
		}
		txs = append(txs, tx)
	}
	// block := types.NewBlock(&types.Header{Number: big.NewInt(100)}, txs, nil, blocktest.NewHasher())
	block := &types.Block{}

	var testSuite = []struct {
		inclTx bool
		fullTx bool
		want   string
	}{
		// TODO(rgeraldes24): fix
		/*
			// without txs
			{
				inclTx: false,
				fullTx: false,
				want: `{
					"extraData": "0x",
					"gasLimit": "0x0",
					"gasUsed": "0x0",
					"hash": "0xde4b1d5f0dc759618ba19fa2a7f38bb232d35d54b15b26db4b1ed2b1381e75d5",
					"logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
					"miner": "0x0000000000000000000000000000000000000000",
					"number": "0x64",
					"parentHash": "0x0000000000000000000000000000000000000000000000000000000000000000",
					"prevRandao": "0x0000000000000000000000000000000000000000000000000000000000000000",
					"receiptsRoot": "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
					"size": "0x72dd",
					"stateRoot": "0x0000000000000000000000000000000000000000000000000000000000000000",
					"timestamp": "0x0",
					"transactionsRoot": "0x271e3954e667d43c0f3d8605faca9051a470765eddd967425590e38383d77973"
				}`,
			},
			// only tx hashes
			{
				inclTx: true,
				fullTx: false,
				want: `{
						"extraData": "0x",
						"gasLimit": "0x0",
						"gasUsed": "0x0",
						"hash": "0xde4b1d5f0dc759618ba19fa2a7f38bb232d35d54b15b26db4b1ed2b1381e75d5",
						"logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
						"miner": "0x0000000000000000000000000000000000000000",
						"number": "0x64",
						"parentHash": "0x0000000000000000000000000000000000000000000000000000000000000000",
						"prevRandao": "0x0000000000000000000000000000000000000000000000000000000000000000",
						"receiptsRoot": "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
						"size": "0x72dd",
						"stateRoot": "0x0000000000000000000000000000000000000000000000000000000000000000",
						"timestamp": "0x0",
						"transactions": [
							"0x1fb5fb2f16942fa335b33611b642f71c3de6f4f1c37dcdab0c76fcc9a1fe1b5a",
							"0x2a181750debd4311025178efe71cac30116c055bdec2d1feb0750d69bf93e684",
							"0xbc8662f8cd68ce488325b0d94d8d9c250b9a5570281b69e7ecb8204b5209ecb3",
							"0x9733fac71942cf3e96c4b519a884cb87437711fa94e35af7de48d99ef096f134"
						],
						"transactionsRoot": "0x271e3954e667d43c0f3d8605faca9051a470765eddd967425590e38383d77973"
					}`,
			},
			// full tx details
			{
				inclTx: true,
				fullTx: true,
				want: `{
						"extraData": "0x",
						"gasLimit": "0x0",
						"gasUsed": "0x0",
						"hash": "0xde4b1d5f0dc759618ba19fa2a7f38bb232d35d54b15b26db4b1ed2b1381e75d5",
						"logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
						"miner": "0x0000000000000000000000000000000000000000",
						"number": "0x64",
						"parentHash": "0x0000000000000000000000000000000000000000000000000000000000000000",
						"prevRandao": "0x0000000000000000000000000000000000000000000000000000000000000000",
						"receiptsRoot": "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
						"size": "0x72dd",
						"stateRoot": "0x0000000000000000000000000000000000000000000000000000000000000000",
						"timestamp": "0x0",
						"transactions": [
							{
								"blockHash": "0xde4b1d5f0dc759618ba19fa2a7f38bb232d35d54b15b26db4b1ed2b1381e75d5",
								"blockNumber": "0x64",
								"from": "0x0000000000000000000000000000000000000000",
								"gas": "0x457",
								"gasPrice": "0x2b67",
								"hash": "0x1fb5fb2f16942fa335b33611b642f71c3de6f4f1c37dcdab0c76fcc9a1fe1b5a",
								"input": "0x111111",
								"nonce": "0x1",
								"to": "0x0000000000000000000000000000000000000011",
								"transactionIndex": "0x0",
								"value": "0x6f",
								"type": "0x1",
								"accessList": [],
								"chainId": "0x539",
								"publicKey": "0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
								"signature": "0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"

							},
							{
								"accessList": [],
								"blockHash": "0xde4b1d5f0dc759618ba19fa2a7f38bb232d35d54b15b26db4b1ed2b1381e75d5",
								"blockNumber": "0x64",
								"from": "0x0000000000000000000000000000000000000000",
								"gas": "0x457",
								"gasPrice": "0x2b67",
								"hash": "0x2a181750debd4311025178efe71cac30116c055bdec2d1feb0750d69bf93e684",
								"input": "0x111111",
								"maxFeePerGas": "0x2b67",
								"maxPriorityFeePerGas": "0x0",
								"nonce": "0x2",
								"to": "0x0000000000000000000000000000000000000011",
								"transactionIndex": "0x1",
								"value": "0x6f",
								"type": "0x2",
								"chainId": "0x0",
								"publicKey": "0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
								"signature": "0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
							},
							{
								"blockHash": "0xde4b1d5f0dc759618ba19fa2a7f38bb232d35d54b15b26db4b1ed2b1381e75d5",
								"blockNumber": "0x64",
								"from": "0x0000000000000000000000000000000000000000",
								"gas": "0x457",
								"gasPrice": "0x2b67",
								"hash": "0xbc8662f8cd68ce488325b0d94d8d9c250b9a5570281b69e7ecb8204b5209ecb3",
								"input": "0x111111",
								"nonce": "0x3",
								"to": "0x0000000000000000000000000000000000000011",
								"transactionIndex": "0x2",
								"value": "0x6f",
								"type": "0x1",
								"accessList": [],
								"chainId": "0x539",
								"publicKey": "0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
								"signature": "0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
							},
							{
								"accessList": [],
								"blockHash": "0xde4b1d5f0dc759618ba19fa2a7f38bb232d35d54b15b26db4b1ed2b1381e75d5",
								"blockNumber": "0x64",
								"from": "0x0000000000000000000000000000000000000000",
								"gas": "0x457",
								"gasPrice": "0x2b67",
								"hash": "0x9733fac71942cf3e96c4b519a884cb87437711fa94e35af7de48d99ef096f134",
								"input": "0x111111",
								"maxFeePerGas": "0x2b67",
								"maxPriorityFeePerGas": "0x0",
								"nonce": "0x4",
								"to": "0x0000000000000000000000000000000000000011",
								"transactionIndex": "0x3",
								"value": "0x6f",
								"type": "0x2",
								"chainId": "0x0",
								"publicKey": "0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
								"signature": "0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
							}
						],
						"transactionsRoot": "0x271e3954e667d43c0f3d8605faca9051a470765eddd967425590e38383d77973"
					}`,
			},
		*/
	}

	for i, tc := range testSuite {
		resp := RPCMarshalBlock(block, tc.inclTx, tc.fullTx, params.MainnetChainConfig)
		out, err := json.Marshal(resp)
		if err != nil {
			t.Errorf("test %d: json marshal error: %v", i, err)
			continue
		}
		require.JSONEqf(t, tc.want, string(out), "test %d", i)
	}
}

func TestRPCGetBlockOrHeader(t *testing.T) {
	t.Parallel()

	// Initialize test accounts
	var (
		acc1Key, _                = pqcrypto.HexToDilithium("8a1f9a8f95be41cd7ccb6168179afb4504aefe388d1e14474d32c45c72ce7b7a")
		acc2Key, _                = pqcrypto.HexToDilithium("49a7b37aa6f6645917e7b807e9d1c00d4fa71f18343b0d4122a4d2df64dd6fee")
		acc1Addr                  = acc1Key.GetAddress()
		acc2Addr   common.Address = acc2Key.GetAddress()
		genesis                   = &core.Genesis{
			Config: params.TestChainConfig,
			Alloc: core.GenesisAlloc{
				acc1Addr: {Balance: big.NewInt(params.Ether)},
				acc2Addr: {Balance: big.NewInt(params.Ether)},
			},
		}
		genBlocks = 10
		signer    = types.ShanghaiSigner{ChainId: big.NewInt(1)}
		tx        = types.NewTx(&types.DynamicFeeTx{
			Nonce:     11,
			GasFeeCap: big.NewInt(0),
			Gas:       1111,
			To:        &acc2Addr,
			Value:     big.NewInt(111),
			Data:      []byte{0x11, 0x11, 0x11},
		})
		withdrawal = &types.Withdrawal{
			Index:     0,
			Validator: 1,
			Address:   common.Address{0x12, 0x34},
			Amount:    10,
		}
		pending = types.NewBlockWithWithdrawals(&types.Header{Number: big.NewInt(11), Time: 42}, []*types.Transaction{tx}, nil, []*types.Withdrawal{withdrawal}, blocktest.NewHasher())
	)
	backend := newTestBackend(t, genBlocks, genesis, beacon.NewFaker(), func(i int, b *core.BlockGen) {
		// Transfer from account[0] to account[1]
		//    value: 1000 wei
		//    fee:   0 wei
		tx, _ := types.SignTx(types.NewTx(&types.DynamicFeeTx{Nonce: uint64(i), To: &acc2Addr, Value: big.NewInt(1000), Gas: params.TxGas, GasFeeCap: b.BaseFee(), Data: nil}), signer, acc1Key)
		b.AddTx(tx)
	})
	backend.setPendingBlock(pending)
	api := NewBlockChainAPI(backend)
	blockHashes := make([]common.Hash, genBlocks+1)
	ctx := context.Background()
	for i := 0; i <= genBlocks; i++ {
		header, err := backend.HeaderByNumber(ctx, rpc.BlockNumber(i))
		if err != nil {
			t.Errorf("failed to get block: %d err: %v", i, err)
		}
		blockHashes[i] = header.Hash()
	}
	pendingHash := pending.Hash()

	var testSuite = []struct {
		blockNumber rpc.BlockNumber
		blockHash   *common.Hash
		fullTx      bool
		reqHeader   bool
		file        string
		expectErr   error
	}{
		// 0. latest header
		{
			blockNumber: rpc.LatestBlockNumber,
			reqHeader:   true,
			file:        "tag-latest",
		},
		// 1. genesis header
		{
			blockNumber: rpc.BlockNumber(0),
			reqHeader:   true,
			file:        "number-0",
		},
		// 2. #1 header
		{
			blockNumber: rpc.BlockNumber(1),
			reqHeader:   true,
			file:        "number-1",
		},
		// 3. latest-1 header
		{
			blockNumber: rpc.BlockNumber(9),
			reqHeader:   true,
			file:        "number-latest-1",
		},
		// 4. latest+1 header
		{
			blockNumber: rpc.BlockNumber(11),
			reqHeader:   true,
			file:        "number-latest+1",
		},
		// 5. pending header
		{
			blockNumber: rpc.PendingBlockNumber,
			reqHeader:   true,
			file:        "tag-pending",
		},
		// TODO(rgeraldes24): removed the blob tx from the receipts backend for the block number 5
		// hence why this test fails
		/*
			// 6. latest block
			{
				blockNumber: rpc.LatestBlockNumber,
				file:        "tag-latest",
			},
		*/
		// 7. genesis block
		{
			blockNumber: rpc.BlockNumber(0),
			file:        "number-0",
		},
		// 8. #1 block
		{
			blockNumber: rpc.BlockNumber(1),
			file:        "number-1",
		},
		// 9. latest-1 block
		{
			blockNumber: rpc.BlockNumber(9),
			fullTx:      true,
			file:        "number-latest-1",
		},
		// 10. latest+1 block
		{
			blockNumber: rpc.BlockNumber(11),
			fullTx:      true,
			file:        "number-latest+1",
		},
		// 11. pending block
		{
			blockNumber: rpc.PendingBlockNumber,
			file:        "tag-pending",
		},
		// 12. pending block + fullTx
		{
			blockNumber: rpc.PendingBlockNumber,
			fullTx:      true,
			file:        "tag-pending-fullTx",
		},
		// 13. latest header by hash
		{
			blockHash: &blockHashes[len(blockHashes)-1],
			reqHeader: true,
			file:      "hash-latest",
		},
		// 14. genesis header by hash
		{
			blockHash: &blockHashes[0],
			reqHeader: true,
			file:      "hash-0",
		},
		// 15. #1 header
		{
			blockHash: &blockHashes[1],
			reqHeader: true,
			file:      "hash-1",
		},
		// 16. latest-1 header
		{
			blockHash: &blockHashes[len(blockHashes)-2],
			reqHeader: true,
			file:      "hash-latest-1",
		},
		// 17. empty hash
		{
			blockHash: &common.Hash{},
			reqHeader: true,
			file:      "hash-empty",
		},
		// 18. pending hash
		{
			blockHash: &pendingHash,
			reqHeader: true,
			file:      `hash-pending`,
		},
		// 19. latest block
		{
			blockHash: &blockHashes[len(blockHashes)-1],
			file:      "hash-latest",
		},
		// 20. genesis block
		{
			blockHash: &blockHashes[0],
			file:      "hash-genesis",
		},
		// 21. #1 block
		{
			blockHash: &blockHashes[1],
			file:      "hash-1",
		},
		// 22. latest-1 block
		{
			blockHash: &blockHashes[len(blockHashes)-2],
			fullTx:    true,
			file:      "hash-latest-1-fullTx",
		},
		// 23. empty hash + body
		{
			blockHash: &common.Hash{},
			fullTx:    true,
			file:      "hash-empty-fullTx",
		},
		// 24. pending block
		{
			blockHash: &pendingHash,
			file:      `hash-pending`,
		},
		// 25. pending block + fullTx
		{
			blockHash: &pendingHash,
			fullTx:    true,
			file:      "hash-pending-fullTx",
		},
	}

	for i, tt := range testSuite {
		var (
			result map[string]interface{}
			err    error
			rpc    string
		)
		if tt.blockHash != nil {
			if tt.reqHeader {
				result = api.GetHeaderByHash(context.Background(), *tt.blockHash)
				rpc = "zond_getHeaderByHash"
			} else {
				result, err = api.GetBlockByHash(context.Background(), *tt.blockHash, tt.fullTx)
				rpc = "zond_getBlockByHash"
			}
		} else {
			if tt.reqHeader {
				result, err = api.GetHeaderByNumber(context.Background(), tt.blockNumber)
				rpc = "zond_getHeaderByNumber"
			} else {
				result, err = api.GetBlockByNumber(context.Background(), tt.blockNumber, tt.fullTx)
				rpc = "zond_getBlockByNumber"
			}
		}
		if tt.expectErr != nil {
			if err == nil {
				t.Errorf("test %d: want error %v, have nothing", i, tt.expectErr)
				continue
			}
			if !errors.Is(err, tt.expectErr) {
				t.Errorf("test %d: error mismatch, want %v, have %v", i, tt.expectErr, err)
			}
			continue
		}
		if err != nil {
			t.Errorf("test %d: want no error, have %v", i, err)
			continue
		}

		testRPCResponseWithFile(t, i, result, rpc, tt.file)
	}
}

func setupReceiptBackend(t *testing.T, genBlocks int) (*testBackend, []common.Hash) {
	config := *params.TestChainConfig
	var (
		acc1Key, _                = pqcrypto.HexToDilithium("8a1f9a8f95be41cd7ccb6168179afb4504aefe388d1e14474d32c45c72ce7b7a")
		acc2Key, _                = pqcrypto.HexToDilithium("49a7b37aa6f6645917e7b807e9d1c00d4fa71f18343b0d4122a4d2df64dd6fee")
		acc1Addr                  = acc1Key.GetAddress()
		acc2Addr   common.Address = acc2Key.GetAddress()
		contract                  = common.HexToAddress("0000000000000000000000000000000000031ec7")
		genesis                   = &core.Genesis{
			Config: &config,
			Alloc: core.GenesisAlloc{
				acc1Addr: {Balance: big.NewInt(params.Ether)},
				acc2Addr: {Balance: big.NewInt(params.Ether)},
				// // SPDX-License-Identifier: GPL-3.0
				// pragma solidity >=0.7.0 <0.9.0;
				//
				// contract Token {
				//     event Transfer(address indexed from, address indexed to, uint256 value);
				//     function transfer(address to, uint256 value) public returns (bool) {
				//         emit Transfer(msg.sender, to, value);
				//         return true;
				//     }
				// }
				contract: {Balance: big.NewInt(params.Ether), Code: common.FromHex("0x608060405234801561001057600080fd5b506004361061002b5760003560e01c8063a9059cbb14610030575b600080fd5b61004a6004803603810190610045919061016a565b610060565b60405161005791906101c5565b60405180910390f35b60008273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef846040516100bf91906101ef565b60405180910390a36001905092915050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000610101826100d6565b9050919050565b610111816100f6565b811461011c57600080fd5b50565b60008135905061012e81610108565b92915050565b6000819050919050565b61014781610134565b811461015257600080fd5b50565b6000813590506101648161013e565b92915050565b60008060408385031215610181576101806100d1565b5b600061018f8582860161011f565b92505060206101a085828601610155565b9150509250929050565b60008115159050919050565b6101bf816101aa565b82525050565b60006020820190506101da60008301846101b6565b92915050565b6101e981610134565b82525050565b600060208201905061020460008301846101e0565b9291505056fea2646970667358221220b469033f4b77b9565ee84e0a2f04d496b18160d26034d54f9487e57788fd36d564736f6c63430008120033")},
			},
		}
		signer   = types.LatestSignerForChainID(params.TestChainConfig.ChainID)
		txHashes = make([]common.Hash, genBlocks)
	)

	backend := newTestBackend(t, genBlocks, genesis, beacon.New(), func(i int, b *core.BlockGen) {
		var (
			tx  *types.Transaction
			err error
		)
		switch i {
		case 0:
			// transfer 1000wei
			tx, err = types.SignTx(types.NewTx(&types.DynamicFeeTx{Nonce: uint64(i), To: &acc2Addr, Value: big.NewInt(1000), Gas: params.TxGas, GasFeeCap: b.BaseFee(), Data: nil}), types.ShanghaiSigner{ChainId: big.NewInt(1)}, acc1Key)
		case 1:
			// create contract
			tx, err = types.SignTx(types.NewTx(&types.DynamicFeeTx{Nonce: uint64(i), To: nil, Gas: 53100, GasFeeCap: b.BaseFee(), Data: common.FromHex("0x60806040")}), signer, acc1Key)
		case 2:
			// with logs
			// transfer(address to, uint256 value)
			data := fmt.Sprintf("0xa9059cbb%s%s", common.HexToHash(common.BigToAddress(big.NewInt(int64(i + 1))).Hex()).String()[2:], common.BytesToHash([]byte{byte(i + 11)}).String()[2:])
			tx, err = types.SignTx(types.NewTx(&types.DynamicFeeTx{Nonce: uint64(i), To: &contract, Gas: 60000, GasFeeCap: b.BaseFee(), Data: common.FromHex(data)}), signer, acc1Key)
		case 3:
			// dynamic fee with logs
			// transfer(address to, uint256 value)
			data := fmt.Sprintf("0xa9059cbb%s%s", common.HexToHash(common.BigToAddress(big.NewInt(int64(i + 1))).Hex()).String()[2:], common.BytesToHash([]byte{byte(i + 11)}).String()[2:])
			fee := big.NewInt(500)
			fee.Add(fee, b.BaseFee())
			tx, err = types.SignTx(types.NewTx(&types.DynamicFeeTx{Nonce: uint64(i), To: &contract, Gas: 60000, Value: big.NewInt(1), GasTipCap: big.NewInt(500), GasFeeCap: fee, Data: common.FromHex(data)}), signer, acc1Key)
		case 4:
			// TODO(rgeraldes24)
			// access list with contract create
			// accessList := types.AccessList{{
			// 	Address:     contract,
			// 	StorageKeys: []common.Hash{{0}},
			// }}
			// tx, err = types.SignTx(types.NewTx(&types.AccessListTx{Nonce: uint64(i), To: nil, Gas: 58100, GasPrice: b.BaseFee(), Data: common.FromHex("0x60806040"), AccessList: accessList}), signer, acc1Key)
		}
		if err != nil {
			t.Errorf("failed to sign tx: %v", err)
		}
		if tx != nil {
			b.AddTx(tx)
			txHashes[i] = tx.Hash()
		}
	})
	return backend, txHashes
}

/*
func TestRPCGetTransactionReceipt(t *testing.T) {
	t.Parallel()

	var (
		backend, txHashes = setupReceiptBackend(t, 6)
		api               = NewTransactionAPI(backend, new(AddrLocker))
	)

	var testSuite = []struct {
		txHash common.Hash
		file   string
	}{
		// 0. normal success
		{
			txHash: txHashes[0],
			file:   "normal-transfer-tx",
		},
		// 1. create contract
		{
			txHash: txHashes[1],
			file:   "create-contract-tx",
		},
		// 2. with logs success
		{
			txHash: txHashes[2],
			file:   "with-logs",
		},
		// 3. dynamic tx with logs success
		{
			txHash: txHashes[3],
			file:   `dynamic-tx-with-logs`,
		},
		// 4. access list tx with create contract
		{
			txHash: txHashes[4],
			file:   "create-contract-with-access-list",
		},
		// 5. txhash empty
		{
			txHash: common.Hash{},
			file:   "txhash-empty",
		},
		// 6. txhash not found
		{
			txHash: common.HexToHash("deadbeef"),
			file:   "txhash-notfound",
		},
	}

	for i, tt := range testSuite {
		var (
			result interface{}
			err    error
		)
		result, err = api.GetTransactionReceipt(context.Background(), tt.txHash)
		if err != nil {
			t.Errorf("test %d: want no error, have %v", i, err)
			continue
		}
		testRPCResponseWithFile(t, i, result, "zond_getTransactionReceipt", tt.file)
	}
}
*/

// TODO(rgeraldes24): legacy txs
func TestRPCGetBlockReceipts(t *testing.T) {
	t.Parallel()

	var (
		genBlocks  = 6
		backend, _ = setupReceiptBackend(t, genBlocks)
		api        = NewBlockChainAPI(backend)
	)
	blockHashes := make([]common.Hash, genBlocks+1)
	ctx := context.Background()
	for i := 0; i <= genBlocks; i++ {
		header, err := backend.HeaderByNumber(ctx, rpc.BlockNumber(i))
		if err != nil {
			t.Errorf("failed to get block: %d err: %v", i, err)
		}
		blockHashes[i] = header.Hash()
	}

	var testSuite = []struct {
		test rpc.BlockNumberOrHash
		file string
	}{
		// 0. block without any txs(hash)
		{
			test: rpc.BlockNumberOrHashWithHash(blockHashes[0], false),
			file: "number-0",
		},
		// 1. block without any txs(number)
		{
			test: rpc.BlockNumberOrHashWithNumber(0),
			file: "number-1",
		},
		// 2. earliest tag
		{
			test: rpc.BlockNumberOrHashWithNumber(rpc.EarliestBlockNumber),
			file: "tag-earliest",
		},
		// TODO(rgeraldes24): removed the blob tx from the receipts backend for the block number 5
		// hence why this test fails
		/*
			// 3. latest tag
			{
				test: rpc.BlockNumberOrHashWithNumber(rpc.LatestBlockNumber),
				file: "tag-latest",
			},
		*/
		// 4. block with legacy transfer tx(hash)
		{
			test: rpc.BlockNumberOrHashWithHash(blockHashes[1], false),
			file: "block-with-legacy-transfer-tx",
		},
		// 5. block with contract create tx(number)
		{
			test: rpc.BlockNumberOrHashWithNumber(rpc.BlockNumber(2)),
			file: "block-with-contract-create-tx",
		},

		// 6. block with legacy contract call tx(hash)
		{
			test: rpc.BlockNumberOrHashWithHash(blockHashes[3], false),
			file: "block-with-legacy-contract-call-tx",
		},
		// 7. block with dynamic fee tx(number)
		{
			test: rpc.BlockNumberOrHashWithNumber(rpc.BlockNumber(4)),
			file: "block-with-dynamic-fee-tx",
		},
		// 8. block is empty
		{
			test: rpc.BlockNumberOrHashWithHash(common.Hash{}, false),
			file: "hash-empty",
		},
		// 9. block is not found
		{
			test: rpc.BlockNumberOrHashWithHash(common.HexToHash("deadbeef"), false),
			file: "hash-notfound",
		},
		// 10. block is not found
		{
			test: rpc.BlockNumberOrHashWithNumber(rpc.BlockNumber(genBlocks + 1)),
			file: "block-notfound",
		},
	}

	for i, tt := range testSuite {
		var (
			result interface{}
			err    error
		)
		result, err = api.GetBlockReceipts(context.Background(), tt.test)
		if err != nil {
			t.Errorf("test %d: want no error, have %v", i, err)
			continue
		}
		testRPCResponseWithFile(t, i, result, "zond_getBlockReceipts", tt.file)
	}
}

func testRPCResponseWithFile(t *testing.T, testid int, result interface{}, rpc string, file string) {
	data, err := json.MarshalIndent(result, "", "  ")
	if err != nil {
		t.Errorf("test %d: json marshal error", testid)
		return
	}
	outputFile := filepath.Join("testdata", fmt.Sprintf("%s-%s.json", rpc, file))
	if os.Getenv("WRITE_TEST_FILES") != "" {
		os.WriteFile(outputFile, data, 0644)
	}
	want, err := os.ReadFile(outputFile)
	if err != nil {
		t.Fatalf("error reading expected test file: %s output: %v", outputFile, err)
	}
	require.JSONEqf(t, string(want), string(data), "test %d: json not match, want: %s, have: %s", testid, string(want), string(data))
}
